# Introduction to Genomics {#sec-genomics-intro}

<div class="learning-objectives">
### Learning Objectives {.unnumbered}

By the end of this chapter, you will be able to:

1. Explain what a SNP is and why SNPs are useful genetic markers
2. Describe SNP chips (arrays) and their use in livestock breeding
3. Understand the basics of genotype quality control
4. Distinguish SNP chips from whole genome sequencing
5. Identify applications of genomics in animal breeding

</div>

```{r}
#| echo: false
#| message: false
#| warning: false

# Load required packages
library(tidyverse)
library(knitr)

# Set default theme for plots
theme_set(theme_minimal(base_size = 12))
```

## Introduction

[Content to be developed: Genomics has revolutionized animal breeding. By using DNA information, we can predict breeding values more accurately and at earlier ages.]

## What is Genomics in Breeding?

[Content to be developed: Using DNA markers (genotypes) to improve genetic predictions and make better selection decisions.]

### Before Genomics

[Content to be developed: Relied on pedigrees, phenotypes, and progeny testing. Slow (especially for low-heritability traits) and expensive.]

### After Genomics

[Content to be developed: Use DNA markers to predict breeding values at birth. Faster, cheaper, and more accurate for young animals.]

### Timeline of Genomics in Livestock

[Content to be developed:]

- **2001**: Human genome sequenced
- **2004-2009**: Livestock genome assemblies (cattle, chicken, pig, sheep, horse)
- **2008-2010**: First genomic selection implementations (dairy cattle, broilers)
- **2010s**: Widespread adoption across species
- **2020s**: Whole genome sequencing becomes more accessible

## DNA Markers: Single Nucleotide Polymorphisms (SNPs)

[Content to be developed: SNPs are the most common type of genetic variation.]

### What is a SNP?

[Content to be developed:]

- **Single Nucleotide Polymorphism**: One base pair difference in DNA sequence
- Example: One animal has "A" at a position, another has "G"
- Millions of SNPs exist across the genome

### SNP Genotypes

[Content to be developed:]

Each animal has two copies of each chromosome (one from sire, one from dam).

**Genotype notation**:

- **0** = Homozygous for allele 1 (e.g., AA)
- **1** = Heterozygous (e.g., AG)
- **2** = Homozygous for allele 2 (e.g., GG)

### Allele Frequency

[Content to be developed:]

$$
p = \frac{2 \times n_{AA} + n_{AG}}{2 \times n_{total}}
$$

Where p is the frequency of the A allele.

### Why SNPs are Useful

[Content to be developed:]

- Common across the genome (millions available)
- Stable (don't change within an individual)
- Easy to genotype with modern technology
- In linkage disequilibrium (LD) with causal mutations
- Can predict breeding values

## SNP Chips (Arrays)

[Content to be developed: Platforms for genotyping many SNPs simultaneously.]

### What is a SNP Chip?

[Content to be developed: A microarray that genotypes thousands to hundreds of thousands of SNPs in a single assay.]

### Common SNP Chips in Livestock

[Content to be developed:]

| Species | SNP Chip | Number of SNPs | Cost (approx) |
|---------|----------|----------------|---------------|
| Cattle  | BovineHD | 777,000 | $150 |
| Cattle  | GGP-F250 | 250,000 | $40-60 |
| Swine   | PorcineSNP60 | 60,000 | $50-80 |
| Poultry | Axiom (custom) | 600,000 | Proprietary |
| Sheep   | OvineSNP50 | 50,000 | $50-80 |
| Horse   | EquineSNP70 | 70,000 | $70-100 |

### How SNP Chips Work (Simplified)

[Content to be developed:]

1. Extract DNA from tissue sample (blood, hair, tissue)
2. DNA binds to chip at SNP locations
3. Fluorescent probes detect which alleles are present
4. Software "calls" genotypes (0, 1, 2)

### Decreasing Costs

[Content to be developed: SNP chip costs have dropped dramatically. Enabled widespread adoption in breeding programs.]

## Bioinformatics Basics

[Content to be developed: Processing genotype data requires quality control.]

### Genotype Quality Control

[Content to be developed: Remove low-quality SNPs and samples.]

#### Call Rate

[Content to be developed: Proportion of SNPs successfully genotyped per animal, and proportion of animals successfully genotyped per SNP.]

- **Animal call rate**: % of SNPs called for an animal (threshold: > 90%)
- **SNP call rate**: % of animals with genotype for a SNP (threshold: > 95%)

#### Minor Allele Frequency (MAF)

[Content to be developed: Remove SNPs with very low MAF (e.g., < 0.01 or 0.05) as they provide little information and may be genotyping errors.]

#### Hardy-Weinberg Equilibrium (HWE)

[Content to be developed: Test if genotype frequencies match expected under HWE. Large deviations may indicate genotyping errors.]

### Imputation

[Content to be developed: Predicting missing or low-density genotypes using a high-density reference panel.]

#### Why Imputation?

[Content to be developed:]

- Genotype selection candidates with low-density (cheap) chips
- Impute to high-density using reference panel (animals genotyped with high-density chips)
- Saves money while retaining most information

#### Accuracy of Imputation

[Content to be developed: Depends on relationship to reference panel and SNP density. Typically > 95% accurate for common SNPs.]

## Whole Genome Sequencing (WGS)

[Content to be developed: The ultimate resolution - sequence every base pair.]

### What is WGS?

[Content to be developed: Determining the complete DNA sequence of an organism's genome (~3 billion base pairs in mammals).]

### WGS vs. SNP Chips

[Content to be developed:]

| Feature | SNP Chip | Whole Genome Sequencing |
|---------|----------|-------------------------|
| SNPs genotyped | 50K-800K (fixed panel) | Millions (all variants) |
| Cost per animal | $40-150 | $500-2000 |
| Coverage | Selected SNPs | Entire genome |
| Causal mutations | Likely in LD with SNPs | Can identify directly |

### Uses of WGS

[Content to be developed:]

- Identify causal mutations (QTN - Quantitative Trait Nucleotides)
- Build high-density reference panels for imputation
- Discover structural variants (insertions, deletions, copy number)
- Research on gene function and regulation

### WGS in Livestock Breeding

[Content to be developed: Key animals (elite sires, dams) are sequenced to create reference panels. Most selection candidates genotyped with SNP chips and imputed to sequence.]

## Applications of Genomics in Breeding

[Content to be developed: Genomics has many uses beyond genomic selection.]

### Genomic Selection (Chapter 13)

[Content to be developed: Predict breeding values using genome-wide SNPs. Increases accuracy and reduces generation interval.]

### Parentage Verification

[Content to be developed: Use SNPs to verify or correct pedigrees. Errors are common in recorded pedigrees.]

### Genome-Wide Association Studies (GWAS)

[Content to be developed: Identify SNPs (or regions) associated with traits. Helps discover causal genes.]

### Genomic Management of Inbreeding

[Content to be developed: Genomic relationships reveal realized inbreeding (Mendelian sampling). More accurate than pedigree-based relationships.]

### Identification of Genetic Defects

[Content to be developed: Find causal mutations for genetic diseases. Test animals and avoid producing affected offspring.]

## R Demonstration: Working with Genotype Data

[Content to be developed:]

```{r}
#| echo: true
#| eval: false

# Simulate SNP genotype data
set.seed(123)
n_animals <- 100
n_snps <- 1000

# Genotypes: 0, 1, 2
genotypes <- matrix(sample(0:2, n_animals * n_snps, replace = TRUE, prob = c(0.25, 0.5, 0.25)),
                    nrow = n_animals, ncol = n_snps)

# Calculate allele frequencies
allele_freq <- colMeans(genotypes) / 2
hist(allele_freq, breaks = 20, main = "Allele Frequency Distribution",
     xlab = "Allele Frequency", col = "lightblue")

# Quality control: Call rate
animal_call_rate <- rowMeans(!is.na(genotypes))
snp_call_rate <- colMeans(!is.na(genotypes))

cat("Mean animal call rate:", round(mean(animal_call_rate), 3), "\n")
cat("Mean SNP call rate:", round(mean(snp_call_rate), 3), "\n")

# Filter SNPs by MAF
maf_threshold <- 0.05
snps_pass <- allele_freq >= maf_threshold & allele_freq <= (1 - maf_threshold)
cat("SNPs passing MAF filter:", sum(snps_pass), "/", n_snps, "\n")
```

## Summary

[Content to be developed.]

### Key Points

- SNPs (Single Nucleotide Polymorphisms) are common genetic markers
- SNP chips genotype thousands to millions of SNPs per animal
- Genotype quality control is essential (call rate, MAF, HWE)
- Imputation predicts missing genotypes using reference panels
- Whole genome sequencing provides ultimate resolution but is more expensive
- Genomics enables genomic selection, parentage testing, GWAS, and more

## Practice Problems

[Problems to be developed]

1. What is a SNP? Explain how SNPs are used in genomic selection.

2. A SNP chip costs $50 per animal and genotypes 50,000 SNPs. Whole genome sequencing costs $1000 per animal. For a breeding program with 10,000 selection candidates, compare the total costs and benefits of each approach.

3. Explain what imputation is and why it is useful in genomic selection.

## Further Reading

[References to be added]

- Hayes and Goddard: Genomic selection
- SNP chip papers for each species
- Whole genome sequencing in livestock
