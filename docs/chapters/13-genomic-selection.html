<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.24">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>13&nbsp; Genomic Selection – Fundamentals of Animal Breeding: Principles and Practice</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../chapters/14-practical-skills.html" rel="next">
<link href="../chapters/12-genomics-intro.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dd8fe44f7e8d2a1c1a36222b42c75f52.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-f29d4b558c027fdd1c8e949aa5364f62.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><style>html{ scroll-behavior: smooth; }</style>
<link href="../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="../site_libs/pagedtable-1.1/js/pagedtable.js"></script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script><link rel="stylesheet" href="../styles.css">
</head>
<body class="nav-sidebar docked quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/12-genomics-intro.html">PART 4: GENOMICS</a></li><li class="breadcrumb-item"><a href="../chapters/13-genomic-selection.html"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Genomic Selection</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../index.html" class="sidebar-logo-link">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Fundamentals of Animal Breeding: Principles and Practice</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">PART 1: FUNDAMENTALS</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/01-introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">The Role and Tools of the Modern Animal Breeder</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/02-selection-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Selection Basics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/03-genetic-model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">The Basic Genetic Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/04-quantitative-traits.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Quantitative vs.&nbsp;Simply Inherited Traits</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/05-heritability-repeatability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Heritability and Repeatability</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">PART 2: SELECTION AND BREEDING STRATEGIES</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/06-breeders-equation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">The Breeder’s Equation and Selection Response</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/07-breeding-values.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Estimating Breeding Values</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/08-genetic-correlations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Genetic Correlations and Correlated Response</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/09-selection-index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Multiple Trait Selection and Selection Index</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">PART 3: INBREEDING, MATING, AND CROSSBREEDING</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/10-mating-strategies.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Mating Strategies and Optimum Contribution Selection</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/11-crossbreeding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Crossbreeding and Hybrid Vigor</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">PART 4: GENOMICS</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/12-genomics-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Introduction to Genomics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/13-genomic-selection.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Genomic Selection</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">PART 5: PRACTICAL SKILLS</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/14-practical-skills.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Practical Animal Breeding and Data Skills</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">PART 6: SPECIES-SPECIFIC BREEDING</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/15-swine-breeding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Swine Breeding</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/16-poultry-breeding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Poultry Breeding</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/17-dairy-cattle-breeding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Dairy Cattle Breeding</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/18-beef-cattle-breeding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Beef Cattle Breeding</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/19-sheep-breeding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Sheep Breeding</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/20-camelidae-breeding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Camelidae Breeding</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/21-aquaculture-breeding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Aquaculture Breeding</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/22-companion-animal-breeding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Companion Animal Breeding</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">PART 7: PRECISION LIVESTOCK FARMING</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/23-plf-introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Introduction to Precision Livestock Farming</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/24-wearable-technologies.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Wearable Technologies in Livestock</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/25-computer-vision.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Computer Vision and Camera Technologies</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendices/datasets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datasets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendices/r-resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R Resources for Animal Breeding</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendices/glossary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Glossary of Genetic Terms</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Contents</h2>
   
  <ul>
<li><a href="#learning-objectives" id="toc-learning-objectives" class="nav-link active" data-scroll-target="#learning-objectives">Learning Objectives</a></li>
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction"><span class="header-section-number">13.1</span> Introduction</a></li>
  <li>
<a href="#what-is-genomic-selection" id="toc-what-is-genomic-selection" class="nav-link" data-scroll-target="#what-is-genomic-selection"><span class="header-section-number">13.2</span> What is Genomic Selection?</a>
  <ul class="collapse">
<li><a href="#traditional-selection-pre-genomics" id="toc-traditional-selection-pre-genomics" class="nav-link" data-scroll-target="#traditional-selection-pre-genomics"><span class="header-section-number">13.2.1</span> Traditional Selection (Pre-Genomics)</a></li>
  <li><a href="#genomic-selection" id="toc-genomic-selection" class="nav-link" data-scroll-target="#genomic-selection"><span class="header-section-number">13.2.2</span> Genomic Selection</a></li>
  </ul>
</li>
  <li>
<a href="#why-genomic-selection-works" id="toc-why-genomic-selection-works" class="nav-link" data-scroll-target="#why-genomic-selection-works"><span class="header-section-number">13.3</span> Why Genomic Selection Works</a>
  <ul class="collapse">
<li><a href="#linkage-disequilibrium-ld" id="toc-linkage-disequilibrium-ld" class="nav-link" data-scroll-target="#linkage-disequilibrium-ld"><span class="header-section-number">13.3.1</span> Linkage Disequilibrium (LD)</a></li>
  <li><a href="#capturing-additive-genetic-variance" id="toc-capturing-additive-genetic-variance" class="nav-link" data-scroll-target="#capturing-additive-genetic-variance"><span class="header-section-number">13.3.2</span> Capturing Additive Genetic Variance</a></li>
  <li><a href="#training-population" id="toc-training-population" class="nav-link" data-scroll-target="#training-population"><span class="header-section-number">13.3.3</span> Training Population</a></li>
  </ul>
</li>
  <li>
<a href="#two-main-approaches-to-genomic-prediction" id="toc-two-main-approaches-to-genomic-prediction" class="nav-link" data-scroll-target="#two-main-approaches-to-genomic-prediction"><span class="header-section-number">13.4</span> Two Main Approaches to Genomic Prediction</a>
  <ul class="collapse">
<li><a href="#animal-model-approach-gblup" id="toc-animal-model-approach-gblup" class="nav-link" data-scroll-target="#animal-model-approach-gblup"><span class="header-section-number">13.4.1</span> Animal Model Approach (GBLUP)</a></li>
  <li><a href="#marker-effects-model-approach" id="toc-marker-effects-model-approach" class="nav-link" data-scroll-target="#marker-effects-model-approach"><span class="header-section-number">13.4.2</span> Marker Effects Model Approach</a></li>
  <li><a href="#equivalence-of-gblup-and-snp-blup" id="toc-equivalence-of-gblup-and-snp-blup" class="nav-link" data-scroll-target="#equivalence-of-gblup-and-snp-blup"><span class="header-section-number">13.4.3</span> Equivalence of GBLUP and SNP-BLUP</a></li>
  <li><a href="#practical-differences" id="toc-practical-differences" class="nav-link" data-scroll-target="#practical-differences"><span class="header-section-number">13.4.4</span> Practical Differences</a></li>
  </ul>
</li>
  <li>
<a href="#gblup-genomic-blup" id="toc-gblup-genomic-blup" class="nav-link" data-scroll-target="#gblup-genomic-blup"><span class="header-section-number">13.5</span> GBLUP (Genomic BLUP)</a>
  <ul class="collapse">
<li><a href="#genomic-relationship-matrix-g" id="toc-genomic-relationship-matrix-g" class="nav-link" data-scroll-target="#genomic-relationship-matrix-g"><span class="header-section-number">13.5.1</span> Genomic Relationship Matrix (G)</a></li>
  <li><a href="#calculating-g-vanradens-method" id="toc-calculating-g-vanradens-method" class="nav-link" data-scroll-target="#calculating-g-vanradens-method"><span class="header-section-number">13.5.2</span> Calculating G: VanRaden’s Method</a></li>
  <li><a href="#gblup-model" id="toc-gblup-model" class="nav-link" data-scroll-target="#gblup-model"><span class="header-section-number">13.5.3</span> GBLUP Model</a></li>
  <li><a href="#advantages-of-gblup" id="toc-advantages-of-gblup" class="nav-link" data-scroll-target="#advantages-of-gblup"><span class="header-section-number">13.5.4</span> Advantages of GBLUP</a></li>
  <li><a href="#numerical-example-calculating-g" id="toc-numerical-example-calculating-g" class="nav-link" data-scroll-target="#numerical-example-calculating-g"><span class="header-section-number">13.5.5</span> Numerical Example: Calculating G</a></li>
  <li><a href="#r-demonstration-computing-and-visualizing-g" id="toc-r-demonstration-computing-and-visualizing-g" class="nav-link" data-scroll-target="#r-demonstration-computing-and-visualizing-g"><span class="header-section-number">13.5.6</span> R Demonstration: Computing and Visualizing G</a></li>
  </ul>
</li>
  <li>
<a href="#snp-blup-and-marker-effects-models" id="toc-snp-blup-and-marker-effects-models" class="nav-link" data-scroll-target="#snp-blup-and-marker-effects-models"><span class="header-section-number">13.6</span> SNP-BLUP and Marker Effects Models</a>
  <ul class="collapse">
<li><a href="#snp-blup" id="toc-snp-blup" class="nav-link" data-scroll-target="#snp-blup"><span class="header-section-number">13.6.1</span> SNP-BLUP</a></li>
  <li><a href="#equivalence-of-gblup-and-snp-blup-1" id="toc-equivalence-of-gblup-and-snp-blup-1" class="nav-link" data-scroll-target="#equivalence-of-gblup-and-snp-blup-1"><span class="header-section-number">13.6.2</span> Equivalence of GBLUP and SNP-BLUP</a></li>
  <li><a href="#when-to-use-snp-blup-vs.-gblup" id="toc-when-to-use-snp-blup-vs.-gblup" class="nav-link" data-scroll-target="#when-to-use-snp-blup-vs.-gblup"><span class="header-section-number">13.6.3</span> When to Use SNP-BLUP vs.&nbsp;GBLUP</a></li>
  </ul>
</li>
  <li>
<a href="#bayesian-methods" id="toc-bayesian-methods" class="nav-link" data-scroll-target="#bayesian-methods"><span class="header-section-number">13.7</span> Bayesian Methods</a>
  <ul class="collapse">
<li><a href="#motivation" id="toc-motivation" class="nav-link" data-scroll-target="#motivation"><span class="header-section-number">13.7.1</span> Motivation</a></li>
  <li><a href="#the-bayesian-framework" id="toc-the-bayesian-framework" class="nav-link" data-scroll-target="#the-bayesian-framework"><span class="header-section-number">13.7.2</span> The Bayesian Framework</a></li>
  <li><a href="#bayesa" id="toc-bayesa" class="nav-link" data-scroll-target="#bayesa"><span class="header-section-number">13.7.3</span> BayesA</a></li>
  <li><a href="#bayesb" id="toc-bayesb" class="nav-link" data-scroll-target="#bayesb"><span class="header-section-number">13.7.4</span> BayesB</a></li>
  <li><a href="#bayesc-and-bayesc%CF%80" id="toc-bayesc-and-bayescπ" class="nav-link" data-scroll-target="#bayesc-and-bayesc%CF%80"><span class="header-section-number">13.7.5</span> BayesC and BayesCπ</a></li>
  <li><a href="#bayesian-lasso" id="toc-bayesian-lasso" class="nav-link" data-scroll-target="#bayesian-lasso"><span class="header-section-number">13.7.6</span> Bayesian Lasso</a></li>
  <li><a href="#comparing-bayesian-methods" id="toc-comparing-bayesian-methods" class="nav-link" data-scroll-target="#comparing-bayesian-methods"><span class="header-section-number">13.7.7</span> Comparing Bayesian Methods</a></li>
  <li><a href="#when-bayesian-methods-help" id="toc-when-bayesian-methods-help" class="nav-link" data-scroll-target="#when-bayesian-methods-help"><span class="header-section-number">13.7.8</span> When Bayesian Methods Help</a></li>
  <li><a href="#software-for-bayesian-genomic-prediction" id="toc-software-for-bayesian-genomic-prediction" class="nav-link" data-scroll-target="#software-for-bayesian-genomic-prediction"><span class="header-section-number">13.7.9</span> Software for Bayesian Genomic Prediction</a></li>
  <li><a href="#summary-bayesian-vs.-gblup" id="toc-summary-bayesian-vs.-gblup" class="nav-link" data-scroll-target="#summary-bayesian-vs.-gblup"><span class="header-section-number">13.7.10</span> Summary: Bayesian vs.&nbsp;GBLUP</a></li>
  </ul>
</li>
  <li>
<a href="#single-step-genomic-blup-ssgblup" id="toc-single-step-genomic-blup-ssgblup" class="nav-link" data-scroll-target="#single-step-genomic-blup-ssgblup"><span class="header-section-number">13.8</span> Single-Step Genomic BLUP (ssGBLUP)</a>
  <ul class="collapse">
<li><a href="#the-problem-with-multi-step-approaches" id="toc-the-problem-with-multi-step-approaches" class="nav-link" data-scroll-target="#the-problem-with-multi-step-approaches"><span class="header-section-number">13.8.1</span> The Problem with Multi-Step Approaches</a></li>
  <li><a href="#the-single-step-solution" id="toc-the-single-step-solution" class="nav-link" data-scroll-target="#the-single-step-solution"><span class="header-section-number">13.8.2</span> The Single-Step Solution</a></li>
  <li><a href="#the-h-matrix" id="toc-the-h-matrix" class="nav-link" data-scroll-target="#the-h-matrix"><span class="header-section-number">13.8.3</span> The H Matrix</a></li>
  <li><a href="#how-ssgblup-works-a-conceptual-example" id="toc-how-ssgblup-works-a-conceptual-example" class="nav-link" data-scroll-target="#how-ssgblup-works-a-conceptual-example"><span class="header-section-number">13.8.4</span> How ssGBLUP Works: A Conceptual Example</a></li>
  <li><a href="#advantages-of-ssgblup" id="toc-advantages-of-ssgblup" class="nav-link" data-scroll-target="#advantages-of-ssgblup"><span class="header-section-number">13.8.5</span> Advantages of ssGBLUP</a></li>
  <li><a href="#adoption-of-ssgblup" id="toc-adoption-of-ssgblup" class="nav-link" data-scroll-target="#adoption-of-ssgblup"><span class="header-section-number">13.8.6</span> Adoption of ssGBLUP</a></li>
  <li><a href="#software-for-ssgblup" id="toc-software-for-ssgblup" class="nav-link" data-scroll-target="#software-for-ssgblup"><span class="header-section-number">13.8.7</span> Software for ssGBLUP</a></li>
  <li><a href="#ssgblup-vs.-multi-step-summary" id="toc-ssgblup-vs.-multi-step-summary" class="nav-link" data-scroll-target="#ssgblup-vs.-multi-step-summary"><span class="header-section-number">13.8.8</span> ssGBLUP vs.&nbsp;Multi-Step: Summary</a></li>
  </ul>
</li>
  <li>
<a href="#accuracy-of-genomic-predictions" id="toc-accuracy-of-genomic-predictions" class="nav-link" data-scroll-target="#accuracy-of-genomic-predictions"><span class="header-section-number">13.9</span> Accuracy of Genomic Predictions</a>
  <ul class="collapse">
<li><a href="#factors-influencing-accuracy" id="toc-factors-influencing-accuracy" class="nav-link" data-scroll-target="#factors-influencing-accuracy"><span class="header-section-number">13.9.1</span> Factors Influencing Accuracy</a></li>
  <li><a href="#typical-accuracies" id="toc-typical-accuracies" class="nav-link" data-scroll-target="#typical-accuracies"><span class="header-section-number">13.9.2</span> Typical Accuracies</a></li>
  <li><a href="#deterministic-prediction-of-accuracy" id="toc-deterministic-prediction-of-accuracy" class="nav-link" data-scroll-target="#deterministic-prediction-of-accuracy"><span class="header-section-number">13.9.3</span> Deterministic Prediction of Accuracy</a></li>
  <li><a href="#increasing-accuracy-over-time" id="toc-increasing-accuracy-over-time" class="nav-link" data-scroll-target="#increasing-accuracy-over-time"><span class="header-section-number">13.9.4</span> Increasing Accuracy Over Time</a></li>
  <li><a href="#r-demonstration-simulating-genomic-prediction-accuracy" id="toc-r-demonstration-simulating-genomic-prediction-accuracy" class="nav-link" data-scroll-target="#r-demonstration-simulating-genomic-prediction-accuracy"><span class="header-section-number">13.9.5</span> R Demonstration: Simulating Genomic Prediction Accuracy</a></li>
  </ul>
</li>
  <li>
<a href="#comparing-pedigree-a-and-genomic-g-relationship-matrices" id="toc-comparing-pedigree-a-and-genomic-g-relationship-matrices" class="nav-link" data-scroll-target="#comparing-pedigree-a-and-genomic-g-relationship-matrices"><span class="header-section-number">13.10</span> Comparing Pedigree (A) and Genomic (G) Relationship Matrices</a>
  <ul class="collapse">
<li><a href="#why-a-and-g-differ" id="toc-why-a-and-g-differ" class="nav-link" data-scroll-target="#why-a-and-g-differ"><span class="header-section-number">13.10.1</span> Why A and G Differ</a></li>
  <li><a href="#numerical-example-full-siblings" id="toc-numerical-example-full-siblings" class="nav-link" data-scroll-target="#numerical-example-full-siblings"><span class="header-section-number">13.10.2</span> Numerical Example: Full-Siblings</a></li>
  <li><a href="#r-demonstration-comparing-a-and-g-matrices" id="toc-r-demonstration-comparing-a-and-g-matrices" class="nav-link" data-scroll-target="#r-demonstration-comparing-a-and-g-matrices"><span class="header-section-number">13.10.3</span> R Demonstration: Comparing A and G Matrices</a></li>
  </ul>
</li>
  <li>
<a href="#impact-of-genomic-selection-on-livestock-breeding" id="toc-impact-of-genomic-selection-on-livestock-breeding" class="nav-link" data-scroll-target="#impact-of-genomic-selection-on-livestock-breeding"><span class="header-section-number">13.11</span> Impact of Genomic Selection on Livestock Breeding</a>
  <ul class="collapse">
<li><a href="#dairy-cattle-the-genomic-revolution" id="toc-dairy-cattle-the-genomic-revolution" class="nav-link" data-scroll-target="#dairy-cattle-the-genomic-revolution"><span class="header-section-number">13.11.1</span> Dairy Cattle: The Genomic Revolution</a></li>
  <li><a href="#swine-precision-breeding-at-scale" id="toc-swine-precision-breeding-at-scale" class="nav-link" data-scroll-target="#swine-precision-breeding-at-scale"><span class="header-section-number">13.11.2</span> Swine: Precision Breeding at Scale</a></li>
  <li><a href="#poultry-extreme-selection-intensity" id="toc-poultry-extreme-selection-intensity" class="nav-link" data-scroll-target="#poultry-extreme-selection-intensity"><span class="header-section-number">13.11.3</span> Poultry: Extreme Selection Intensity</a></li>
  <li><a href="#beef-cattle-decentralized-adoption" id="toc-beef-cattle-decentralized-adoption" class="nav-link" data-scroll-target="#beef-cattle-decentralized-adoption"><span class="header-section-number">13.11.4</span> Beef Cattle: Decentralized Adoption</a></li>
  <li><a href="#sheep-emerging-adoption" id="toc-sheep-emerging-adoption" class="nav-link" data-scroll-target="#sheep-emerging-adoption"><span class="header-section-number">13.11.5</span> Sheep: Emerging Adoption</a></li>
  <li><a href="#summary-of-industry-impact" id="toc-summary-of-industry-impact" class="nav-link" data-scroll-target="#summary-of-industry-impact"><span class="header-section-number">13.11.6</span> Summary of Industry Impact</a></li>
  </ul>
</li>
  <li>
<a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">13.12</span> Summary</a>
  <ul class="collapse">
<li><a href="#key-concepts" id="toc-key-concepts" class="nav-link" data-scroll-target="#key-concepts"><span class="header-section-number">13.12.1</span> Key Concepts</a></li>
  <li><a href="#the-big-picture" id="toc-the-big-picture" class="nav-link" data-scroll-target="#the-big-picture"><span class="header-section-number">13.12.2</span> The Big Picture</a></li>
  </ul>
</li>
  <li><a href="#practice-problems" id="toc-practice-problems" class="nav-link" data-scroll-target="#practice-problems"><span class="header-section-number">13.13</span> Practice Problems</a></li>
  <li>
<a href="#further-reading" id="toc-further-reading" class="nav-link" data-scroll-target="#further-reading"><span class="header-section-number">13.14</span> Further Reading</a>
  <ul class="collapse">
<li><a href="#foundational-papers" id="toc-foundational-papers" class="nav-link" data-scroll-target="#foundational-papers"><span class="header-section-number">13.14.1</span> Foundational Papers</a></li>
  <li><a href="#bayesian-methods-1" id="toc-bayesian-methods-1" class="nav-link" data-scroll-target="#bayesian-methods-1"><span class="header-section-number">13.14.2</span> Bayesian Methods</a></li>
  <li><a href="#single-step-gblup" id="toc-single-step-gblup" class="nav-link" data-scroll-target="#single-step-gblup"><span class="header-section-number">13.14.3</span> Single-Step GBLUP</a></li>
  <li><a href="#accuracy-and-prediction" id="toc-accuracy-and-prediction" class="nav-link" data-scroll-target="#accuracy-and-prediction"><span class="header-section-number">13.14.4</span> Accuracy and Prediction</a></li>
  <li><a href="#reviews-by-species" id="toc-reviews-by-species" class="nav-link" data-scroll-target="#reviews-by-species"><span class="header-section-number">13.14.5</span> Reviews by Species</a></li>
  <li><a href="#textbooks" id="toc-textbooks" class="nav-link" data-scroll-target="#textbooks"><span class="header-section-number">13.14.6</span> Textbooks</a></li>
  <li><a href="#online-resources" id="toc-online-resources" class="nav-link" data-scroll-target="#online-resources"><span class="header-section-number">13.14.7</span> Online Resources</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/12-genomics-intro.html">PART 4: GENOMICS</a></li><li class="breadcrumb-item"><a href="../chapters/13-genomic-selection.html"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Genomic Selection</span></a></li></ol></nav><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="sec-genomic-selection" class="quarto-section-identifier"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Genomic Selection</span></span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="learning-objectives" class="level3 unnumbered learning-objectives"><h3 class="unnumbered anchored" data-anchor-id="learning-objectives">Learning Objectives</h3>
<p>By the end of this chapter, you will be able to:</p>
<ol type="1">
<li>Explain the principles and advantages of genomic selection</li>
<li>Distinguish GBLUP, SNP-BLUP, and Bayesian genomic prediction methods</li>
<li>Understand single-step genomic BLUP and its practical importance</li>
<li>Describe how genomic selection has impacted livestock breeding</li>
<li>Calculate expected accuracy of genomic predictions</li>
</ol></section><section id="introduction" class="level2" data-number="13.1"><h2 data-number="13.1" class="anchored" data-anchor-id="introduction">
<span class="header-section-number">13.1</span> Introduction</h2>
<p>In 2001, Theo Meuwissen, Ben Hayes, and Mike Goddard published a paper that would fundamentally change animal breeding. Titled “Prediction of Total Genetic Value Using Genome-Wide Dense Marker Maps,” this landmark paper proposed something revolutionary: What if we could predict an animal’s breeding value directly from its DNA, without waiting for performance records or progeny data?</p>
<p>At the time, this seemed almost too good to be true. Traditional animal breeding relied heavily on performance testing and progeny trials, which took years to complete. A dairy bull, for example, needed 5-6 years of progeny testing before breeders could confidently estimate his genetic merit for milk production. By the time his breeding value was known, he might be past his prime reproductive years. The same challenges existed across all livestock species—genetic evaluation was accurate but slow.</p>
<p>Meuwissen and colleagues proposed using thousands of DNA markers (SNPs) spread across the entire genome to capture the effects of all genes affecting a trait. Because these markers are in linkage disequilibrium with the actual causal mutations, they could “tag” the genetic variation responsible for differences in performance. With a large enough <strong>training population</strong> of animals with both genotypes and phenotypes, one could estimate the relationship between SNP patterns and breeding values. These estimated relationships could then be applied to young animals with only genotype data, providing accurate predictions at birth—or even as embryos.</p>
<p>The impact of this idea has been nothing short of transformative. Dairy cattle breeding adopted genomic selection in 2009, and the rate of genetic improvement immediately doubled. Similar revolutions followed in swine (2011-2014), poultry (2010-2015), and beef cattle (2012-2017). Today, genomic selection is the standard approach in nearly all major breeding programs worldwide.</p>
<p>This chapter explains <strong>how</strong> genomic selection works. In Chapter 12, we learned about SNPs, genotyping technologies, and data quality control—the raw materials of genomic selection. Now we’ll explore the statistical methods that turn genotype data into genomic predictions. We’ll cover three major approaches:</p>
<ol type="1">
<li>
<strong>GBLUP (Genomic BLUP)</strong>: Uses a genomic relationship matrix to predict breeding values</li>
<li>
<strong>Bayesian methods</strong>: Allows different SNPs to have different effect sizes</li>
<li>
<strong>Single-step GBLUP</strong>: Combines pedigree and genomic information in one unified analysis</li>
</ol>
<p>By the end of this chapter, you’ll understand why genomic selection has revolutionized animal breeding, and how breeding companies use these methods to accelerate genetic progress.</p>
</section><section id="what-is-genomic-selection" class="level2" data-number="13.2"><h2 data-number="13.2" class="anchored" data-anchor-id="what-is-genomic-selection">
<span class="header-section-number">13.2</span> What is Genomic Selection?</h2>
<p><strong>Genomic selection</strong> is a method of predicting an animal’s breeding value using genome-wide SNP genotype data. The predicted value is called a <strong>GEBV</strong> (Genomic Estimated Breeding Value), which represents our best estimate of an animal’s true breeding value based on its DNA sequence.</p>
<p>The fundamental idea is elegantly simple:</p>
<ol type="1">
<li>
<strong>Build a training population</strong>: Collect genotype and phenotype data (or conventional EBVs) on thousands of animals</li>
<li>
<strong>Estimate the relationship</strong>: Use statistical models to learn how SNP patterns relate to breeding values</li>
<li>
<strong>Predict for selection candidates</strong>: Apply the learned relationships to young, genotyped animals who don’t yet have their own performance records</li>
<li>
<strong>Select the best</strong>: Choose parents based on GEBVs instead of waiting for performance or progeny data</li>
</ol>
<p>This approach breaks the traditional trade-off between accuracy and generation interval that constrained animal breeding for decades.</p>
<section id="traditional-selection-pre-genomics" class="level3" data-number="13.2.1"><h3 data-number="13.2.1" class="anchored" data-anchor-id="traditional-selection-pre-genomics">
<span class="header-section-number">13.2.1</span> Traditional Selection (Pre-Genomics)</h3>
<p>Before genomics, breeders faced a fundamental challenge: <strong>accurate genetic evaluation required time</strong>.</p>
<p>For a young dairy bull with no daughters yet, the only information available was his pedigree. His estimated breeding value was essentially the average of his parents’ EBVs—what we call the <strong>parent average</strong> or <strong>pedigree index</strong>. The accuracy of this prediction was modest at best:</p>
<ul>
<li>
<strong>Accuracy for young animals</strong>: r ≈ 0.30-0.40 (based on parent average only)</li>
<li>
<strong>Selection intensity</strong>: Limited, because predictions were imprecise</li>
</ul>
<p>To improve accuracy, breeders used <strong>progeny testing</strong>: mate the young bull to many cows, wait for daughters to lactate, measure their milk production, and calculate the bull’s EBV based on daughter performance. This worked well for accuracy:</p>
<ul>
<li>
<strong>Accuracy with progeny data</strong>: r ≈ 0.85-0.90 (after 50-100 daughters with records)</li>
</ul>
<p>But progeny testing came at a steep cost:</p>
<ul>
<li>
<strong>Generation interval</strong>: 5-7 years (birth → mating → daughters born → daughters mature → milk records collected → EBV computed)</li>
<li>
<strong>Expense</strong>: $25,000-$50,000 per bull (semen storage, matings, data collection)</li>
<li>
<strong>Opportunity cost</strong>: By the time a bull’s genetic merit was known, newer genetics might already be available</li>
</ul>
<p>This same pattern held across species. In swine, boars needed progeny in multiple litters before feed efficiency could be accurately evaluated. In beef cattle, carcass merit could only be assessed after offspring were slaughtered. The fundamental constraint was always the same: <strong>accuracy required waiting for phenotypes</strong>, which meant long generation intervals and slow genetic progress.</p>
</section><section id="genomic-selection" class="level3" data-number="13.2.2"><h3 data-number="13.2.2" class="anchored" data-anchor-id="genomic-selection">
<span class="header-section-number">13.2.2</span> Genomic Selection</h3>
<p>Genomic selection changes everything by providing <strong>moderate to high accuracy at birth</strong>, without waiting for performance or progeny records.</p>
<p>Here’s what genomic selection uses:</p>
<ul>
<li>
<strong>Training population</strong>: Animals with both genotypes and phenotypes (or traditional EBVs)
<ul>
<li>Dairy: Thousands of progeny-tested bulls with daughter records</li>
<li>Swine: Thousands of pigs with growth, carcass, and reproduction records</li>
<li>Poultry: Tens of thousands of birds with production records</li>
</ul>
</li>
<li>
<strong>Genomic prediction model</strong>: Statistical method that learns how SNP patterns correlate with breeding values (more on this below)</li>
<li>
<strong>Selection candidates</strong>: Young animals with genotypes but no performance records</li>
</ul>
<p>The result:</p>
<ul>
<li>
<strong>Accuracy for young animals</strong>: r ≈ 0.50-0.70 (depending on training population size, heritability, and relationships)</li>
<li>
<strong>At birth</strong> (or even as embryos): No need to wait for maturity or progeny</li>
<li>
<strong>Generation interval</strong>: Cut in half or more
<ul>
<li>Dairy: From 6-7 years → 2.5-3 years</li>
<li>Swine: From 1.8 years → 1.0-1.2 years</li>
</ul>
</li>
</ul>
<p>The key advantage is not just accuracy—it’s <strong>high accuracy with short generation interval</strong>. Recall the breeder’s equation from Chapter 6:</p>
<p><span class="math display">\[R = \frac{i \times r \times \sigma_A}{L}\]</span></p>
<p>Genomic selection improves both numerator (r increases for young animals) and denominator (L decreases because we don’t need to wait for progeny). The combined effect on genetic progress is dramatic: in U.S. dairy cattle, annual genetic gain for milk yield doubled from ~120 kg/year to ~250 kg/year after genomic selection was adopted in 2009.</p>
</section></section><section id="why-genomic-selection-works" class="level2" data-number="13.3"><h2 data-number="13.3" class="anchored" data-anchor-id="why-genomic-selection-works">
<span class="header-section-number">13.3</span> Why Genomic Selection Works</h2>
<p>To understand why genomic selection works, we need to recall a fundamental principle from Chapter 12: <strong>SNPs are not usually the causal mutations</strong> that directly affect traits. Instead, they serve as <strong>markers</strong> that are statistically associated with nearby causal mutations. This association, called linkage disequilibrium, is the genetic foundation of genomic prediction.</p>
<section id="linkage-disequilibrium-ld" class="level3" data-number="13.3.1"><h3 data-number="13.3.1" class="anchored" data-anchor-id="linkage-disequilibrium-ld">
<span class="header-section-number">13.3.1</span> Linkage Disequilibrium (LD)</h3>
<p><strong>Linkage disequilibrium (LD)</strong> is the non-random association of alleles at different loci. When two loci are in LD, knowing the allele at one locus tells you something about the likely allele at the other locus.</p>
<p>LD exists for several reasons:</p>
<ol type="1">
<li>
<strong>Physical proximity</strong>: Loci close together on the same chromosome are less likely to be separated by recombination</li>
<li>
<strong>Recent mutation</strong>: Newly arisen mutations haven’t had time to recombine onto different genetic backgrounds</li>
<li>
<strong>Population history</strong>: Genetic drift, population bottlenecks, and selection create LD patterns</li>
<li>
<strong>Limited recombination</strong>: Even over many generations, recombination is a relatively slow process</li>
</ol>
<p>Here’s the key insight: If a SNP is in LD with a causal mutation (sometimes called a QTN—Quantitative Trait Nucleotide), then animals with a particular SNP allele will tend to have a particular QTN allele. The SNP <strong>“tags”</strong> the causal variant.</p>
<p>For example, imagine a causal mutation that increases milk production by 50 kg per lactation. A nearby SNP might be in strong LD with this mutation. Even though the SNP itself doesn’t affect milk yield, animals with the “A” allele at the SNP position will tend to carry the beneficial allele at the causal mutation. By tracking the SNP allele, we indirectly track the causal allele.</p>
<p>The strength of LD decays with physical distance. In cattle, SNPs separated by 50,000 base pairs (50 kb) might have moderate LD, while SNPs 1 million base pairs apart typically have little LD. This is why dense SNP panels (50K or 600K+ SNPs) are necessary—we need enough markers to ensure that most causal mutations are in LD with at least one SNP on the array.</p>
</section><section id="capturing-additive-genetic-variance" class="level3" data-number="13.3.2"><h3 data-number="13.3.2" class="anchored" data-anchor-id="capturing-additive-genetic-variance">
<span class="header-section-number">13.3.2</span> Capturing Additive Genetic Variance</h3>
<p>Quantitative traits like milk production, growth rate, and litter size are affected by hundreds to thousands of genes scattered across the genome. Each gene contributes a small amount to the total genetic variance. Genomic selection doesn’t require identifying every causal gene—it just needs enough SNPs in LD with enough causal loci to capture most of the additive genetic variance.</p>
<p>With a 50K SNP panel (one SNP every ~50,000 base pairs on average), we have excellent genome coverage in most livestock species. Even if we don’t know which SNPs are causal, the combination of all SNP effects will track the sum of nearby causal effects. This “polygenic” approach works remarkably well for complex traits.</p>
<p>The proportion of additive genetic variance captured depends on:</p>
<ul>
<li>
<strong>SNP density</strong>: More SNPs = better LD coverage</li>
<li>
<strong>Effective population size (N_e)</strong>: Smaller N_e = longer LD = fewer SNPs needed
<ul>
<li>Dairy cattle: N_e ≈ 100-150, medium LD</li>
<li>Swine: N_e ≈ 100-300, medium LD</li>
<li>Poultry: N_e ≈ 50-100, longer LD (easier to capture variance)</li>
</ul>
</li>
<li>
<strong>Recombination rate</strong>: Varies across chromosomes and species</li>
</ul>
<p>In practice, 50K SNP arrays capture 70-90% of additive genetic variance for most traits in dairy cattle. Higher-density arrays (600K+) capture slightly more, but the gain is modest. This is good news: we don’t need perfect genome coverage, just good coverage.</p>
</section><section id="training-population" class="level3" data-number="13.3.3"><h3 data-number="13.3.3" class="anchored" data-anchor-id="training-population">
<span class="header-section-number">13.3.3</span> Training Population</h3>
<p>The <strong>training population</strong> (also called the <strong>reference population</strong>) is the cornerstone of genomic selection. These are animals with:</p>
<ol type="1">
<li>
<strong>Genotypes</strong>: SNP data from a chip or sequencing</li>
<li>
<strong>Phenotypes</strong>: Performance records, or conventional EBVs based on their own and relatives’ records</li>
</ol>
<p>The training population is used to “train” the genomic prediction model—that is, to estimate how SNP patterns relate to breeding values. The larger and more representative the training population, the more accurate the genomic predictions will be.</p>
<p><strong>Key factors for an effective training population:</strong></p>
<ul>
<li>
<strong>Size</strong>: Larger is better. Thousands of animals are typically needed for moderate to high accuracy
<ul>
<li>Dairy: 10,000-50,000 bulls with progeny-tested EBVs</li>
<li>Swine: 5,000-20,000 pigs with performance records</li>
<li>Poultry: 20,000-100,000 birds (huge populations possible due to low genotyping costs)</li>
</ul>
</li>
<li>
<strong>Relationship to selection candidates</strong>: Predictions are most accurate for animals closely related to the training population
<ul>
<li>Ideally, training population includes sires, dams, and close relatives of candidates</li>
<li>Accuracy declines if training and selection populations are distantly related (e.g., different breeds)</li>
</ul>
</li>
<li>
<strong>Phenotype quality</strong>: Accurate, well-recorded phenotypes lead to better predictions
<ul>
<li>Training on progeny-tested EBVs (high accuracy) is better than training on single records</li>
</ul>
</li>
<li>
<strong>Updated regularly</strong>: As new data become available, re-train the model to maintain accuracy</li>
</ul>
<p>Once the training population is established and the model is trained, we can predict GEBVs for any genotyped animal—even newborns with no performance records. This is the power of genomic selection: the training population does the “heavy lifting” of connecting genotypes to phenotypes, and selection candidates benefit from this accumulated knowledge.</p>
</section></section><section id="two-main-approaches-to-genomic-prediction" class="level2" data-number="13.4"><h2 data-number="13.4" class="anchored" data-anchor-id="two-main-approaches-to-genomic-prediction">
<span class="header-section-number">13.4</span> Two Main Approaches to Genomic Prediction</h2>
<p>There are two philosophical frameworks for genomic prediction, which differ in <strong>what</strong> they estimate:</p>
<ol type="1">
<li>
<strong>Animal model approach</strong> (also called “breeding value model”): Estimate <strong>breeding values</strong> directly for each animal, using genomic relationships</li>
<li>
<strong>Marker effects model</strong>: Estimate the <strong>effect of each SNP</strong>, then sum SNP effects to calculate breeding values</li>
</ol>
<p>These approaches sound fundamentally different, but mathematically they are often equivalent—they’re just different ways of parameterizing the same underlying model. However, they differ in computational approach, interpretation, and practical application.</p>
<section id="animal-model-approach-gblup" class="level3" data-number="13.4.1"><h3 data-number="13.4.1" class="anchored" data-anchor-id="animal-model-approach-gblup">
<span class="header-section-number">13.4.1</span> Animal Model Approach (GBLUP)</h3>
<p>In the <strong>animal model</strong> approach, we estimate breeding values directly, just as in traditional BLUP (Chapter 7). The key difference is that we replace the pedigree relationship matrix (<strong>A</strong>) with the genomic relationship matrix (<strong>G</strong>).</p>
<p><strong>What we estimate</strong>: Breeding values (u) for each animal</p>
<p><strong>Model</strong>: <span class="math display">\[y = X\beta + Zu + e\]</span></p>
<p>Where:</p>
<ul>
<li>
<strong>y</strong> = phenotypes (or EBVs from traditional evaluation)</li>
<li>
<strong>X</strong> = design matrix for fixed effects (contemporary groups, etc.)</li>
<li>
<strong>β</strong> = vector of fixed effects</li>
<li>
<strong>Z</strong> = design matrix relating animals to records</li>
<li>
<strong>u</strong> = vector of breeding values (random effects)</li>
<li>
<strong>e</strong> = residual errors</li>
</ul>
<p>The key difference from traditional BLUP: breeding values are assumed to follow:</p>
<p><span class="math display">\[u \sim N(0, G\sigma^2_u)\]</span></p>
<p>That is, breeding values have a covariance structure defined by the <strong>genomic relationship matrix</strong> G (not the pedigree relationship matrix A).</p>
<p><strong>Advantages</strong>:</p>
<ul>
<li>Conceptually simple (same framework as traditional BLUP)</li>
<li>G captures realized relationships (Mendelian sampling)</li>
<li>Efficient computation for large datasets</li>
<li>Most widely used in practice</li>
</ul>
<p>This approach is called <strong>GBLUP</strong> (Genomic BLUP).</p>
</section><section id="marker-effects-model-approach" class="level3" data-number="13.4.2"><h3 data-number="13.4.2" class="anchored" data-anchor-id="marker-effects-model-approach">
<span class="header-section-number">13.4.2</span> Marker Effects Model Approach</h3>
<p>In the <strong>marker effects model</strong> approach, we estimate the effect of each individual SNP, then sum those effects to calculate breeding values.</p>
<p><strong>What we estimate</strong>: SNP effects (β_j) for each of thousands of SNPs</p>
<p><strong>Model</strong>: <span class="math display">\[y = X\alpha + \sum_{j=1}^{m} x_j \beta_j + e\]</span></p>
<p>Or in matrix notation: <span class="math display">\[y = X\alpha + M\beta + e\]</span></p>
<p>Where:</p>
<ul>
<li>
<strong>y</strong> = phenotypes</li>
<li>
<strong>X</strong> = design matrix for fixed effects</li>
<li>
<strong>α</strong> = vector of fixed effects</li>
<li>
<strong>M</strong> = matrix of SNP genotypes (rows = animals, columns = SNPs)</li>
<li>
<strong>β</strong> = vector of SNP effects (one effect per SNP)</li>
<li>
<strong>m</strong> = number of SNPs (often 50,000+)</li>
<li>
<strong>e</strong> = residual errors</li>
</ul>
<p>Once SNP effects (β) are estimated, we calculate the <strong>GEBV</strong> for animal <em>i</em> as:</p>
<p><span class="math display">\[GEBV_i = \sum_{j=1}^{m} (x_{ij} - 2p_j) \hat{\beta}_j\]</span></p>
<p>Where:</p>
<ul>
<li>
<strong>x_ij</strong> = genotype of animal <em>i</em> at SNP <em>j</em> (coded 0, 1, or 2)</li>
<li>
<strong>p_j</strong> = allele frequency at SNP <em>j</em> in the base population</li>
<li>
<strong><span class="math inline">\((x_{ij} - 2p_j)\)</span></strong> = centered genotype (centers at zero for the population mean)</li>
</ul>
<p><strong>Advantages</strong>:</p>
<ul>
<li>Estimates SNP effects directly (useful for identifying important genomic regions)</li>
<li>Can apply different assumptions about SNP effect distributions (e.g., Bayesian methods)</li>
<li>Easy to calculate GEBVs for new animals once β is estimated</li>
</ul>
<p><strong>Disadvantage</strong>:</p>
<ul>
<li>Computationally challenging when m (number of SNPs) &gt;&gt; n (number of animals)</li>
<li>Requires specialized algorithms (e.g., Bayesian MCMC)</li>
</ul>
<p>Methods in this category include <strong>SNP-BLUP</strong> (assumes all SNPs have equal variance) and <strong>Bayesian methods</strong> (allow SNPs to have different variances).</p>
</section><section id="equivalence-of-gblup-and-snp-blup" class="level3" data-number="13.4.3"><h3 data-number="13.4.3" class="anchored" data-anchor-id="equivalence-of-gblup-and-snp-blup">
<span class="header-section-number">13.4.3</span> Equivalence of GBLUP and SNP-BLUP</h3>
<p>Under certain assumptions, GBLUP (animal model) and SNP-BLUP (marker effects model) are <strong>mathematically equivalent</strong>—they produce identical GEBVs.</p>
<p>Specifically, when:</p>
<ol type="1">
<li>All SNPs have equal variance (no large-effect QTL)</li>
<li>The genomic relationship matrix G is computed as: <span class="math inline">\(G = \frac{MM'}{2\sum p_j(1-p_j)}\)</span> (VanRaden’s first method)</li>
</ol>
<p>Then the breeding values from GBLUP equal the sum of SNP effects from SNP-BLUP.</p>
<p>This equivalence is powerful: we can choose whichever approach is computationally convenient. For large datasets with many animals, GBLUP is often faster. For datasets with more SNPs than animals, SNP-BLUP may be more efficient.</p>
</section><section id="practical-differences" class="level3" data-number="13.4.4"><h3 data-number="13.4.4" class="anchored" data-anchor-id="practical-differences">
<span class="header-section-number">13.4.4</span> Practical Differences</h3>
<p>Despite mathematical equivalence, the two approaches differ in practice:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 11%">
<col style="width: 28%">
<col style="width: 59%">
</colgroup>
<thead><tr class="header">
<th>Feature</th>
<th>Animal Model (GBLUP)</th>
<th>Marker Effects Model (SNP-BLUP, Bayesian)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>Estimates</strong></td>
<td>Breeding values (u)</td>
<td>SNP effects (β)</td>
</tr>
<tr class="even">
<td><strong>Computation</strong></td>
<td>Fast for large n</td>
<td>Faster for large m</td>
</tr>
<tr class="odd">
<td><strong>Interpretation</strong></td>
<td>Directly provides GEBVs</td>
<td>Provides SNP effects; sum to get GEBVs</td>
</tr>
<tr class="even">
<td><strong>SNP information</strong></td>
<td>Implicit (via G matrix)</td>
<td>Explicit (each SNP has estimated effect)</td>
</tr>
<tr class="odd">
<td><strong>Flexibility</strong></td>
<td>Less flexible (assumes equal variance)</td>
<td>More flexible (can vary SNP variances)</td>
</tr>
<tr class="even">
<td><strong>Software</strong></td>
<td>ASReml, BLUPF90</td>
<td>BGLR, GenSel, brms</td>
</tr>
<tr class="odd">
<td><strong>Use case</strong></td>
<td>Standard industry practice</td>
<td>Research, QTL mapping, traits with major genes</td>
</tr>
</tbody>
</table>
<p>In the following sections, we’ll explore GBLUP, SNP-BLUP, and Bayesian methods in detail.</p>
</section></section><section id="gblup-genomic-blup" class="level2" data-number="13.5"><h2 data-number="13.5" class="anchored" data-anchor-id="gblup-genomic-blup">
<span class="header-section-number">13.5</span> GBLUP (Genomic BLUP)</h2>
<p>GBLUP (Genomic Best Linear Unbiased Prediction) is the animal model approach to genomic selection. It extends traditional BLUP (Chapter 7) by replacing the pedigree relationship matrix (A) with a <strong>genomic relationship matrix</strong> (G) that captures the actual realized relationships between animals based on their DNA.</p>
<p>GBLUP was popularized by Paul VanRaden’s 2008 paper “Efficient Methods to Compute Genomic Predictions,” which provided computationally feasible methods for calculating G and solving genomic evaluations. Today, GBLUP is the foundation of genomic selection in dairy cattle, beef cattle, and many other species.</p>
<section id="genomic-relationship-matrix-g" class="level3" data-number="13.5.1"><h3 data-number="13.5.1" class="anchored" data-anchor-id="genomic-relationship-matrix-g">
<span class="header-section-number">13.5.1</span> Genomic Relationship Matrix (G)</h3>
<p>The <strong>genomic relationship matrix</strong> (G) quantifies the genetic similarity between pairs of animals based on their SNP genotypes. It’s analogous to the pedigree relationship matrix (A), but instead of relying on expected relationships from the pedigree, G uses the <strong>realized</strong> (actual) sharing of genome segments.</p>
<p><strong>Key differences between A and G</strong>:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 17%">
<col style="width: 41%">
<col style="width: 41%">
</colgroup>
<thead><tr class="header">
<th>Feature</th>
<th>A (Pedigree Matrix)</th>
<th>G (Genomic Matrix)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>Based on</strong></td>
<td>Pedigree records</td>
<td>SNP genotypes</td>
</tr>
<tr class="even">
<td><strong>Relationship</strong></td>
<td>Expected (average)</td>
<td>Realized (actual)</td>
</tr>
<tr class="odd">
<td><strong>Full-sibs</strong></td>
<td>Always 0.50</td>
<td>Varies (e.g., 0.47-0.53)</td>
</tr>
<tr class="even">
<td><strong>Mendelian sampling</strong></td>
<td>Not captured</td>
<td>Captured</td>
</tr>
<tr class="odd">
<td><strong>Unknown pedigree</strong></td>
<td>Cannot calculate</td>
<td>Can still calculate</td>
</tr>
<tr class="even">
<td><strong>Self-relationship</strong></td>
<td>1.0 or 1 + F</td>
<td>Close to 1.0 (with adjustments)</td>
</tr>
</tbody>
</table>
<p>The beauty of G is that it captures <strong>Mendelian sampling</strong>—the random variation in which parental alleles are inherited by offspring. Even full-siblings don’t share exactly 50% of their genome; some pairs share 48%, others 52%, due to random segregation and recombination. G captures this variation, making predictions more accurate.</p>
</section><section id="calculating-g-vanradens-method" class="level3" data-number="13.5.2"><h3 data-number="13.5.2" class="anchored" data-anchor-id="calculating-g-vanradens-method">
<span class="header-section-number">13.5.2</span> Calculating G: VanRaden’s Method</h3>
<p>Paul VanRaden (2008) proposed an efficient method for computing G from SNP genotypes. The formula is:</p>
<p><span class="math display">\[G = \frac{(M - P)(M - P)'}{2 \sum_{j=1}^{m} p_j (1 - p_j)}\]</span></p>
<p>Let’s break down each component:</p>
<p><strong>M</strong> = Genotype matrix (n × m)</p>
<ul>
<li>
<strong>n</strong> = number of animals</li>
<li>
<strong>m</strong> = number of SNPs</li>
<li>
<strong>M_ij</strong> = genotype of animal <em>i</em> at SNP <em>j</em>, coded as:
<ul>
<li>0 = homozygous for allele 1 (e.g., AA)</li>
<li>1 = heterozygous (e.g., Aa)</li>
<li>2 = homozygous for allele 2 (e.g., aa)</li>
</ul>
</li>
</ul>
<p><strong>P</strong> = Matrix of expected genotypes under Hardy-Weinberg Equilibrium (HWE)</p>
<ul>
<li>
<strong>P_ij</strong> = <span class="math inline">\(2p_j\)</span>, where <span class="math inline">\(p_j\)</span> is the frequency of allele 2 at SNP <em>j</em>
</li>
<li>All animals in column <em>j</em> have the same value (the population mean genotype for that SNP)</li>
<li>P represents the “baseline” genotype expected if SNPs were at population allele frequencies</li>
</ul>
<p><strong>(M - P)</strong> = Centered genotype matrix</p>
<ul>
<li>Subtracts the population mean, so animals with more common alleles have values near zero</li>
<li>This centers the relationship matrix so the average relationship equals zero</li>
</ul>
<p><strong><span class="math inline">\((M - P)(M - P)'\)</span></strong> = Cross-product matrix (n × n)</p>
<ul>
<li>Element (i, i’) is the sum of products of centered genotypes across all SNPs for animals <em>i</em> and <em>i’</em>
</li>
<li>Large values = animals share many alleles that deviate from the population mean (closely related)</li>
<li>Small or negative values = animals have different allele combinations (distantly related)</li>
</ul>
<p><strong>Denominator: <span class="math inline">\(2 \sum_{j=1}^{m} p_j (1 - p_j)\)</span></strong></p>
<ul>
<li>Sum of expected variance across all SNPs (under HWE)</li>
<li>Scales G so the diagonal elements (self-relationships) are close to 1.0</li>
<li>The factor of 2 accounts for diploid genomes</li>
</ul>
<p><strong>Interpretation of G</strong>:</p>
<ul>
<li>
<strong>Diagonal elements</strong> (G_ii): Self-relationship, typically near 1.0
<ul>
<li>Can be &gt; 1 if the animal is more homozygous than expected (inbred)</li>
<li>Can be &lt; 1 if more heterozygous than expected</li>
</ul>
</li>
<li>
<strong>Off-diagonal elements</strong> (G_ij): Relationship between animals <em>i</em> and <em>j</em>
<ul>
<li>G_ij = 0: Animals share genome at population average (unrelated)</li>
<li>G_ij = 0.50: Animals share ~50% of genome (parent-offspring or full-sibs, on average)</li>
<li>G_ij = 0.25: Animals share ~25% of genome (half-sibs or grandparent-grandchild, on average)</li>
<li>G_ij &lt; 0: Animals are less related than population average (have opposite alleles)</li>
</ul>
</li>
</ul></section><section id="gblup-model" class="level3" data-number="13.5.3"><h3 data-number="13.5.3" class="anchored" data-anchor-id="gblup-model">
<span class="header-section-number">13.5.3</span> GBLUP Model</h3>
<p>The GBLUP model is identical in structure to traditional BLUP, except we use G instead of A for the covariance structure of breeding values.</p>
<p><strong>Mixed model</strong>:</p>
<p><span class="math display">\[y = X\beta + Zu + e\]</span></p>
<p>Where:</p>
<ul>
<li>
<strong>y</strong> = vector of phenotypes (or de-regressed EBVs)</li>
<li>
<strong>X</strong> = design matrix for fixed effects (contemporary groups, sex, etc.)</li>
<li>
<strong>β</strong> = vector of fixed effects</li>
<li>
<strong>Z</strong> = incidence matrix linking animals to records</li>
<li>
<strong>u</strong> = vector of breeding values (random effects)</li>
<li>
<strong>e</strong> = vector of residual errors</li>
</ul>
<p><strong>Variance structure</strong>:</p>
<p><span class="math display">\[u \sim N(0, G\sigma^2_u)\]</span> <span class="math display">\[e \sim N(0, I\sigma^2_e)\]</span></p>
<p>Where:</p>
<ul>
<li>
<strong>G</strong> = genomic relationship matrix</li>
<li>
<strong><span class="math inline">\(\sigma^2_u\)</span></strong> = additive genetic variance</li>
<li>
<strong>I</strong> = identity matrix</li>
<li>
<strong><span class="math inline">\(\sigma^2_e\)</span></strong> = residual (error) variance</li>
</ul>
<p>The <strong>mixed model equations</strong> (MME) are:</p>
<p><span class="math display">\[\begin{bmatrix} X'X &amp; X'Z \\ Z'X &amp; Z'Z + G^{-1}\lambda \end{bmatrix} \begin{bmatrix} \hat{\beta} \\ \hat{u} \end{bmatrix} = \begin{bmatrix} X'y \\ Z'y \end{bmatrix}\]</span></p>
<p>Where <span class="math inline">\(\lambda = \sigma^2_e / \sigma^2_u\)</span> (the variance ratio).</p>
<p>Solving these equations gives us:</p>
<ul>
<li>
<strong><span class="math inline">\(\hat{\beta}\)</span></strong> = estimates of fixed effects</li>
<li>
<strong><span class="math inline">\(\hat{u}\)</span></strong> = GEBVs (genomic estimated breeding values)</li>
</ul>
<p><strong>Important note</strong>: You don’t need to solve MMEs by hand! Software packages (ASReml, BLUPF90, etc.) do this for you. The key concept is that GBLUP uses G instead of A, and this improves accuracy because G captures realized relationships.</p>
</section><section id="advantages-of-gblup" class="level3" data-number="13.5.4"><h3 data-number="13.5.4" class="anchored" data-anchor-id="advantages-of-gblup">
<span class="header-section-number">13.5.4</span> Advantages of GBLUP</h3>
<ol type="1">
<li>
<strong>Captures Mendelian sampling</strong>: G reflects actual genome sharing, not just expected relationships</li>
<li>
<strong>High accuracy for young animals</strong>: Animals with genotypes but no phenotypes can receive accurate GEBVs (r = 0.50-0.70) based on realized relationships with the training population</li>
<li>
<strong>Works with incomplete pedigrees</strong>: G can be calculated even if pedigree is unknown (as long as genotypes are available)</li>
<li>
<strong>Computationally efficient</strong>: For large datasets (n &gt; 10,000), GBLUP is faster than marker effects models</li>
<li>
<strong>Widely implemented</strong>: Standard method in dairy, beef, swine, poultry</li>
</ol></section><section id="numerical-example-calculating-g" class="level3" data-number="13.5.5"><h3 data-number="13.5.5" class="anchored" data-anchor-id="numerical-example-calculating-g">
<span class="header-section-number">13.5.5</span> Numerical Example: Calculating G</h3>
<p>Let’s calculate the genomic relationship matrix for 5 animals genotyped at 6 SNPs (in reality, we’d use 50,000+ SNPs, but the principle is the same).</p>
<p><strong>Step 1: Genotype data (M)</strong></p>
<table class="caption-top table">
<thead><tr class="header">
<th>Animal</th>
<th>SNP1</th>
<th>SNP2</th>
<th>SNP3</th>
<th>SNP4</th>
<th>SNP5</th>
<th>SNP6</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2</td>
<td>1</td>
<td>0</td>
<td>2</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td>2</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>2</td>
</tr>
<tr class="odd">
<td>3</td>
<td>0</td>
<td>0</td>
<td>2</td>
<td>0</td>
<td>2</td>
<td>0</td>
</tr>
<tr class="even">
<td>4</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="odd">
<td>5</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>2</td>
<td>2</td>
</tr>
</tbody>
</table>
<p><strong>Step 2: Calculate allele frequencies (p_j)</strong></p>
<p>For SNP1: p_1 = (2+1+0+2+1) / (2×5) = 6/10 = 0.60</p>
<p>Similarly:</p>
<ul>
<li>p_2 = 0.50</li>
<li>p_3 = 0.40</li>
<li>p_4 = 0.60</li>
<li>p_5 = 0.60</li>
<li>p_6 = 0.60</li>
</ul>
<p><strong>Step 3: Create P matrix (expected genotypes)</strong></p>
<p>P has the same dimensions as M, but every element in column <em>j</em> is <span class="math inline">\(2p_j\)</span>:</p>
<table class="caption-top table">
<thead><tr class="header">
<th>Animal</th>
<th>SNP1</th>
<th>SNP2</th>
<th>SNP3</th>
<th>SNP4</th>
<th>SNP5</th>
<th>SNP6</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>1.2</td>
<td>1.0</td>
<td>0.8</td>
<td>1.2</td>
<td>1.2</td>
<td>1.2</td>
</tr>
<tr class="even">
<td>2</td>
<td>1.2</td>
<td>1.0</td>
<td>0.8</td>
<td>1.2</td>
<td>1.2</td>
<td>1.2</td>
</tr>
<tr class="odd">
<td>3</td>
<td>1.2</td>
<td>1.0</td>
<td>0.8</td>
<td>1.2</td>
<td>1.2</td>
<td>1.2</td>
</tr>
<tr class="even">
<td>4</td>
<td>1.2</td>
<td>1.0</td>
<td>0.8</td>
<td>1.2</td>
<td>1.2</td>
<td>1.2</td>
</tr>
<tr class="odd">
<td>5</td>
<td>1.2</td>
<td>1.0</td>
<td>0.8</td>
<td>1.2</td>
<td>1.2</td>
<td>1.2</td>
</tr>
</tbody>
</table>
<p><strong>Step 4: Compute (M - P)</strong> (centered genotypes)</p>
<table class="caption-top table">
<thead><tr class="header">
<th>Animal</th>
<th>SNP1</th>
<th>SNP2</th>
<th>SNP3</th>
<th>SNP4</th>
<th>SNP5</th>
<th>SNP6</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>0.8</td>
<td>0.0</td>
<td>-0.8</td>
<td>0.8</td>
<td>-0.2</td>
<td>-0.2</td>
</tr>
<tr class="even">
<td>2</td>
<td>-0.2</td>
<td>1.0</td>
<td>0.2</td>
<td>-0.2</td>
<td>-1.2</td>
<td>0.8</td>
</tr>
<tr class="odd">
<td>3</td>
<td>-1.2</td>
<td>-1.0</td>
<td>1.2</td>
<td>-1.2</td>
<td>0.8</td>
<td>-1.2</td>
</tr>
<tr class="even">
<td>4</td>
<td>0.8</td>
<td>0.0</td>
<td>0.2</td>
<td>0.8</td>
<td>-0.2</td>
<td>-0.2</td>
</tr>
<tr class="odd">
<td>5</td>
<td>-0.2</td>
<td>0.0</td>
<td>-0.8</td>
<td>-0.2</td>
<td>0.8</td>
<td>0.8</td>
</tr>
</tbody>
</table>
<p><strong>Step 5: Compute <span class="math inline">\((M-P)(M-P)'\)</span></strong></p>
<p>This is a 5×5 matrix. For example, element (1,1) is: <span class="math display">\[(0.8)^2 + (0.0)^2 + (-0.8)^2 + (0.8)^2 + (-0.2)^2 + (-0.2)^2 = 0.64 + 0 + 0.64 + 0.64 + 0.04 + 0.04 = 2.00\]</span></p>
<p>Element (1,2) is: <span class="math display">\[(0.8)(-0.2) + (0.0)(1.0) + (-0.8)(0.2) + (0.8)(-0.2) + (-0.2)(-1.2) + (-0.2)(0.8)\]</span> <span class="math display">\[= -0.16 + 0 - 0.16 - 0.16 + 0.24 - 0.16 = -0.40\]</span></p>
<p>Completing all calculations (we’ll use R in the next section for this!):</p>
<p><span class="math display">\[
(M-P)(M-P)' = \begin{bmatrix}
2.00 &amp; -0.40 &amp; -1.60 &amp; 1.60 &amp; -0.40 \\
-0.40 &amp; 3.60 &amp; -1.60 &amp; -0.40 &amp; 0.80 \\
-1.60 &amp; -1.60 &amp; 6.00 &amp; -1.20 &amp; -1.20 \\
1.60 &amp; -0.40 &amp; -1.20 &amp; 2.00 &amp; -0.40 \\
-0.40 &amp; 0.80 &amp; -1.20 &amp; -0.40 &amp; 2.00 \\
\end{bmatrix}
\]</span></p>
<p><strong>Step 6: Calculate denominator</strong></p>
<p><span class="math display">\[2\sum_{j=1}^{6} p_j(1-p_j) = 2[0.6(0.4) + 0.5(0.5) + 0.4(0.6) + 0.6(0.4) + 0.6(0.4) + 0.6(0.4)]\]</span> <span class="math display">\[= 2[0.24 + 0.25 + 0.24 + 0.24 + 0.24 + 0.24] = 2(1.45) = 2.90\]</span></p>
<p><strong>Step 7: Compute G = <span class="math inline">\((M-P)(M-P)' / 2.90\)</span></strong></p>
<p><span class="math display">\[
G = \begin{bmatrix}
0.69 &amp; -0.14 &amp; -0.55 &amp; 0.55 &amp; -0.14 \\
-0.14 &amp; 1.24 &amp; -0.55 &amp; -0.14 &amp; 0.28 \\
-0.55 &amp; -0.55 &amp; 2.07 &amp; -0.41 &amp; -0.41 \\
0.55 &amp; -0.14 &amp; -0.41 &amp; 0.69 &amp; -0.14 \\
-0.14 &amp; 0.28 &amp; -0.41 &amp; -0.14 &amp; 0.69 \\
\end{bmatrix}
\]</span></p>
<p><strong>Interpretation</strong>:</p>
<ul>
<li>
<strong>Animal 1 and Animal 4</strong>: G_14 = 0.55 (closely related, share ~55% of genome above population average—possibly parent-offspring or full-sibs)</li>
<li>
<strong>Animal 1 and Animal 3</strong>: G_13 = -0.55 (distantly related, share fewer alleles than population average)</li>
<li>
<strong>Animal 3</strong>: G_33 = 2.07 (more homozygous than expected, or has unusual allele composition)</li>
</ul>
<p>In practice, we’d use thousands of SNPs, which stabilizes these estimates. With only 6 SNPs, sampling variation is high.</p>
<p>Next, we’ll implement this in R with a more realistic example.</p>
</section><section id="r-demonstration-computing-and-visualizing-g" class="level3" data-number="13.5.6"><h3 data-number="13.5.6" class="anchored" data-anchor-id="r-demonstration-computing-and-visualizing-g">
<span class="header-section-number">13.5.6</span> R Demonstration: Computing and Visualizing G</h3>
<p>Let’s calculate the genomic relationship matrix using real-scale data (10 animals, 1000 SNPs) and visualize the relationships.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Load required packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hadley/reshape">reshape2</a></span><span class="op">)</span>  <span class="co"># For melting matrix for heatmap</span></span>
<span></span>
<span><span class="co"># Set seed for reproducibility</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">12345</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulate genotype data</span></span>
<span><span class="va">n_animals</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">n_snps</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span></span>
<span><span class="co"># Simulate genotypes (0, 1, or 2) with realistic allele frequencies</span></span>
<span><span class="co"># Most SNPs have intermediate allele frequencies (MAF &gt; 0.05)</span></span>
<span><span class="va">allele_freqs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">n_snps</span>, min <span class="op">=</span> <span class="fl">0.2</span>, max <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate genotype matrix M (n_animals × n_snps)</span></span>
<span><span class="va">M</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, nrow <span class="op">=</span> <span class="va">n_animals</span>, ncol <span class="op">=</span> <span class="va">n_snps</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n_snps</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">p</span> <span class="op">&lt;-</span> <span class="va">allele_freqs</span><span class="op">[</span><span class="va">j</span><span class="op">]</span></span>
<span>  <span class="co"># Genotypes follow HWE: P(0) = (1-p)^2, P(1) = 2p(1-p), P(2) = p^2</span></span>
<span>  <span class="va">M</span><span class="op">[</span>, <span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">2</span>, size <span class="op">=</span> <span class="va">n_animals</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                   prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">*</span><span class="va">p</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p</span><span class="op">)</span>, <span class="va">p</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Add animal names</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Animal_"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">n_animals</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display first 6 SNPs for first 5 animals</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Genotype matrix M (first 5 animals, first 6 SNPs):\n"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Genotype matrix M (first 5 animals, first 6 SNPs):</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">M</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>         [,1] [,2] [,3] [,4] [,5] [,6]
Animal_1    1    2    1    1    0    1
Animal_2    2    1    1    1    1    2
Animal_3    1    1    1    1    0    1
Animal_4    1    2    1    2    2    1
Animal_5    2    1    2    2    0    0</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Step 1: Calculate allele frequencies from the data</span></span>
<span><span class="co"># (In practice, these might be from a larger reference population)</span></span>
<span><span class="va">p_j</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colMeans</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span>  <span class="co"># Allele frequency at each SNP</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\nFirst 10 allele frequencies:\n"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
First 10 allele frequencies:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">p_j</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.55 0.70 0.80 0.80 0.35 0.30 0.55 0.60 0.45 0.75</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Step 2: Create P matrix (expected genotypes = 2 * p_j)</span></span>
<span><span class="va">P</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">p_j</span>, each <span class="op">=</span> <span class="va">n_animals</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">n_animals</span>, ncol <span class="op">=</span> <span class="va">n_snps</span>,</span>
<span>            byrow <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Step 3: Center genotypes (M - P)</span></span>
<span><span class="va">Z</span> <span class="op">&lt;-</span> <span class="va">M</span> <span class="op">-</span> <span class="va">P</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\nCentered genotypes Z (first 5 animals, first 6 SNPs):\n"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Centered genotypes Z (first 5 animals, first 6 SNPs):</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">Z</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>         [,1] [,2] [,3] [,4] [,5] [,6]
Animal_1 -0.1  0.6 -0.6 -0.6 -0.7  0.4
Animal_2  0.9 -0.4 -0.6 -0.6  0.3  1.4
Animal_3 -0.1 -0.4 -0.6 -0.6 -0.7  0.4
Animal_4 -0.1  0.6 -0.6  0.4  1.3  0.4
Animal_5  0.9 -0.4  0.4  0.4 -0.7 -0.6</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Step 4: Calculate cross-product Z %*% t(Z)</span></span>
<span><span class="va">ZZt</span> <span class="op">&lt;-</span> <span class="va">Z</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">Z</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Step 5: Calculate denominator: 2 * sum(p_j * (1 - p_j))</span></span>
<span><span class="va">denom</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">p_j</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p_j</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\nDenominator: 2 * sum(p_j * (1 - p_j)) ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">denom</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Denominator: 2 * sum(p_j * (1 - p_j)) = 419.54 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Step 6: Compute G matrix</span></span>
<span><span class="va">G</span> <span class="op">&lt;-</span> <span class="va">ZZt</span> <span class="op">/</span> <span class="va">denom</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\nGenomic relationship matrix G:\n"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Genomic relationship matrix G:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">G</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Animal_1 Animal_2 Animal_3 Animal_4 Animal_5 Animal_6 Animal_7
Animal_1     0.876   -0.092   -0.135   -0.108   -0.063   -0.085   -0.113
Animal_2    -0.092    0.963   -0.057   -0.118   -0.164   -0.035   -0.147
Animal_3    -0.135   -0.057    0.901   -0.111   -0.121   -0.128   -0.087
Animal_4    -0.108   -0.118   -0.111    0.968   -0.115   -0.115   -0.122
Animal_5    -0.063   -0.164   -0.121   -0.115    0.895   -0.089   -0.034
Animal_6    -0.085   -0.035   -0.128   -0.115   -0.089    0.959   -0.118
Animal_7    -0.113   -0.147   -0.087   -0.122   -0.034   -0.118    0.977
Animal_8    -0.073   -0.128   -0.102   -0.108   -0.085   -0.083   -0.142
Animal_9    -0.105   -0.087   -0.113   -0.079   -0.127   -0.146   -0.107
Animal_10   -0.102   -0.136   -0.048   -0.092   -0.097   -0.162   -0.106
          Animal_8 Animal_9 Animal_10
Animal_1    -0.073   -0.105    -0.102
Animal_2    -0.128   -0.087    -0.136
Animal_3    -0.102   -0.113    -0.048
Animal_4    -0.108   -0.079    -0.092
Animal_5    -0.085   -0.127    -0.097
Animal_6    -0.083   -0.146    -0.162
Animal_7    -0.142   -0.107    -0.106
Animal_8     0.918   -0.106    -0.091
Animal_9    -0.106    0.963    -0.094
Animal_10   -0.091   -0.094     0.927</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Check diagonal elements (should be close to 1)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\nDiagonal elements (self-relationships):\n"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Diagonal elements (self-relationships):</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">G</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> Animal_1  Animal_2  Animal_3  Animal_4  Animal_5  Animal_6  Animal_7  Animal_8 
    0.876     0.963     0.901     0.968     0.895     0.959     0.977     0.918 
 Animal_9 Animal_10 
    0.963     0.927 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Mean diagonal:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">G</span><span class="op">)</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean diagonal: 0.935 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Check off-diagonal range</span></span>
<span><span class="va">off_diag</span> <span class="op">&lt;-</span> <span class="va">G</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html">lower.tri</a></span><span class="op">(</span><span class="va">G</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\nOff-diagonal relationships:\n"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Off-diagonal relationships:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"  Range:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">off_diag</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"to"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">off_diag</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Range: -0.164 to -0.034 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"  Mean:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">off_diag</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Mean: -0.104 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Visualize G matrix as heatmap</span></span>
<span><span class="va">G_melted</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="va">G</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">G_melted</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Animal_1"</span>, <span class="st">"Animal_2"</span>, <span class="st">"Relationship"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">G_melted</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Animal_1</span>, y <span class="op">=</span> <span class="va">Animal_2</span>, fill <span class="op">=</span> <span class="va">Relationship</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_tile</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"white"</span>, linewidth <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradient2</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"blue"</span>, mid <span class="op">=</span> <span class="st">"white"</span>, high <span class="op">=</span> <span class="st">"red"</span>, midpoint <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                       limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>, <span class="fl">1.5</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"G"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Genomic Relationship Matrix (G)"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Heatmap showing realized relationships among 10 animals"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Animal"</span>, y <span class="op">=</span> <span class="st">"Animal"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">11</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>        panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">p1</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="13-genomic-selection_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Distribution of off-diagonal relationships</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Relationship <span class="op">=</span> <span class="va">off_diag</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Relationship</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">20</span>, fill <span class="op">=</span> <span class="st">"steelblue"</span>, color <span class="op">=</span> <span class="st">"black"</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"red"</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Distribution of Off-Diagonal Relationships"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Most animals are unrelated (near 0), some are closely related"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Genomic Relationship (G_ij)"</span>, y <span class="op">=</span> <span class="st">"Count"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">11</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">p2</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="13-genomic-selection_files/figure-html/unnamed-chunk-2-2.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p><strong>Key observations from the G matrix:</strong></p>
<ol type="1">
<li>
<strong>Diagonal elements</strong> average close to 1.0, indicating animals are as homozygous as expected on average</li>
<li>
<strong>Off-diagonal elements</strong> show variation in relationships:
<ul>
<li>Values near 0 indicate unrelated animals</li>
<li>Positive values indicate animals share more alleles than average (related)</li>
<li>Negative values indicate animals have complementary allele sets (less related than random)</li>
</ul>
</li>
<li>
<strong>With 1000 SNPs</strong>, the G matrix estimates are reasonably stable, though more SNPs (50K+) would provide even better precision</li>
</ol>
<p>This G matrix could now be used in GBLUP to estimate genomic breeding values for these animals.</p>
</section></section><section id="snp-blup-and-marker-effects-models" class="level2" data-number="13.6"><h2 data-number="13.6" class="anchored" data-anchor-id="snp-blup-and-marker-effects-models">
<span class="header-section-number">13.6</span> SNP-BLUP and Marker Effects Models</h2>
<p>While GBLUP estimates breeding values directly using the genomic relationship matrix, <strong>marker effects models</strong> estimate the effect of each individual SNP. This approach provides explicit information about which genomic regions contribute to genetic variation—useful for understanding the genetic architecture of traits and for identifying candidate genes.</p>
<section id="snp-blup" class="level3" data-number="13.6.1"><h3 data-number="13.6.1" class="anchored" data-anchor-id="snp-blup">
<span class="header-section-number">13.6.1</span> SNP-BLUP</h3>
<p><strong>SNP-BLUP</strong> is the marker effects equivalent of GBLUP. Instead of estimating <em>n</em> breeding values (one per animal), we estimate <em>m</em> SNP effects (one per SNP, where <em>m</em> might be 50,000 or more).</p>
<p><strong>Model</strong>:</p>
<p><span class="math display">\[y = X\alpha + M\beta + e\]</span></p>
<p>Where:</p>
<ul>
<li>
<strong>y</strong> = vector of phenotypes (n × 1)</li>
<li>
<strong>X</strong> = design matrix for fixed effects</li>
<li>
<strong>α</strong> = vector of fixed effects</li>
<li>
<strong>M</strong> = centered genotype matrix (n × m), where M_ij = x_ij - 2p_j</li>
<li>
<strong>β</strong> = vector of SNP effects (m × 1)</li>
<li>
<strong>e</strong> = vector of residuals</li>
</ul>
<p><strong>Assumptions</strong>:</p>
<ul>
<li>SNP effects are random: <span class="math inline">\(\beta_j \sim N(0, \sigma^2_\beta)\)</span>
</li>
<li>All SNPs have <strong>equal variance</strong> <span class="math inline">\(\sigma^2_\beta\)</span>
</li>
</ul>
<p>This equal-variance assumption is key: SNP-BLUP treats all SNPs as contributing equally (on average) to genetic variation.</p>
<p><strong>Estimating SNP effects</strong>: We solve for <span class="math inline">\(\hat{\beta}\)</span> using ridge regression (penalized regression) or mixed model equations. The penalty shrinks small effects toward zero, preventing overfitting.</p>
<p><strong>Computing GEBVs from SNP effects</strong>:</p>
<p>Once we have estimated SNP effects <span class="math inline">\(\hat{\beta}\)</span>, we calculate each animal’s GEBV by summing the contributions of all SNPs:</p>
<p><span class="math display">\[GEBV_i = \sum_{j=1}^{m} (x_{ij} - 2p_j) \hat{\beta}_j\]</span></p>
<p>Or in matrix notation:</p>
<p><span class="math display">\[GEBV = M\hat{\beta}\]</span></p>
<p>Where <strong>M</strong> is the centered genotype matrix.</p>
<p><strong>Example</strong>:</p>
<p>Suppose we’ve estimated SNP effects for 3 SNPs:</p>
<ul>
<li>
<span class="math inline">\(\hat{\beta}_1 = +0.15\)</span> kg (increases milk yield)</li>
<li>
<span class="math inline">\(\hat{\beta}_2 = -0.08\)</span> kg (decreases milk yield)</li>
<li>
<span class="math inline">\(\hat{\beta}_3 = +0.22\)</span> kg (increases milk yield)</li>
</ul>
<p>And Animal A has centered genotypes:</p>
<ul>
<li>SNP 1: <span class="math inline">\((x_{A1} - 2p_1) = 2 - 2(0.5) = 1.0\)</span>
</li>
<li>SNP 2: <span class="math inline">\((x_{A2} - 2p_2) = 0 - 2(0.3) = -0.6\)</span>
</li>
<li>SNP 3: <span class="math inline">\((x_{A3} - 2p_3) = 1 - 2(0.6) = -0.2\)</span>
</li>
</ul>
<p>Then:</p>
<p><span class="math display">\[GEBV_A = (1.0)(0.15) + (-0.6)(-0.08) + (-0.2)(0.22) = 0.15 + 0.048 - 0.044 = 0.154 \text{ kg}\]</span></p>
<p>Animal A’s GEBV is +0.154 kg above the population mean for milk yield.</p>
</section><section id="equivalence-of-gblup-and-snp-blup-1" class="level3" data-number="13.6.2"><h3 data-number="13.6.2" class="anchored" data-anchor-id="equivalence-of-gblup-and-snp-blup-1">
<span class="header-section-number">13.6.2</span> Equivalence of GBLUP and SNP-BLUP</h3>
<p>Here’s a remarkable mathematical result: Under certain conditions, <strong>GBLUP and SNP-BLUP produce identical GEBVs</strong>. They are different parameterizations of the same underlying model.</p>
<p><strong>When they are equivalent</strong>:</p>
<ol type="1">
<li>All SNPs have equal variance (the SNP-BLUP assumption)</li>
<li>The genomic relationship matrix is computed as <span class="math inline">\(G = \frac{MM'}{2\sum p_j(1-p_j)}\)</span> (VanRaden’s method)</li>
</ol>
<p>Under these conditions:</p>
<p><span class="math display">\[GEBV_{GBLUP} = GEBV_{SNP-BLUP}\]</span></p>
<p><strong>Why this equivalence matters</strong>:</p>
<ul>
<li>
<strong>Computational flexibility</strong>: Choose the approach that’s faster for your dataset
<ul>
<li>GBLUP: Faster when n (animals) &lt; m (SNPs)—invert an n × n matrix (G) instead of solving m equations</li>
<li>SNP-BLUP: Faster when m &lt; n (rare in livestock, but possible with low-density panels)</li>
</ul>
</li>
<li>
<strong>Interpretability</strong>: SNP-BLUP provides explicit SNP effects (useful for genomic architecture studies), while GBLUP is a “black box”</li>
<li>
<strong>Extensions</strong>: SNP-BLUP framework allows relaxing the equal-variance assumption (Bayesian methods)</li>
</ul>
<p><strong>Mathematical connection</strong>:</p>
<p>The relationship between breeding values (u) and SNP effects (β) is:</p>
<p><span class="math display">\[u = M\beta\]</span></p>
<p>And:</p>
<p><span class="math display">\[G = \frac{MM'}{2\sum p_j(1-p_j)} \propto MM'\]</span></p>
<p>So breeding values are linear combinations of SNP effects, and genomic relationships are determined by the similarity of SNP genotype patterns.</p>
</section><section id="when-to-use-snp-blup-vs.-gblup" class="level3" data-number="13.6.3"><h3 data-number="13.6.3" class="anchored" data-anchor-id="when-to-use-snp-blup-vs.-gblup">
<span class="header-section-number">13.6.3</span> When to Use SNP-BLUP vs.&nbsp;GBLUP</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 32%">
<col style="width: 44%">
<col style="width: 23%">
</colgroup>
<thead><tr class="header">
<th>Situation</th>
<th>Best Approach</th>
<th>Reason</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Standard genomic evaluation (50K SNPs, 10,000+ animals)</td>
<td>GBLUP</td>
<td>Faster computation</td>
</tr>
<tr class="even">
<td>Identifying important genomic regions</td>
<td>SNP-BLUP</td>
<td>Provides explicit SNP effects</td>
</tr>
<tr class="odd">
<td>Traits with major QTL</td>
<td>Bayesian methods (next section)</td>
<td>Allows unequal SNP variances</td>
</tr>
<tr class="even">
<td>Integrating genotyped and non-genotyped animals</td>
<td>Single-step GBLUP (discussed later)</td>
<td>Handles both efficiently</td>
</tr>
<tr class="odd">
<td>Research on genetic architecture</td>
<td>SNP-BLUP or Bayesian</td>
<td>Interpretable SNP effects</td>
</tr>
</tbody>
</table>
<p>In practice, <strong>GBLUP dominates in industry</strong> because it’s computationally efficient and easy to implement in existing BLUP software. SNP-BLUP and Bayesian methods are more common in research and for specific applications where understanding SNP effects is important.</p>
</section></section><section id="bayesian-methods" class="level2" data-number="13.7"><h2 data-number="13.7" class="anchored" data-anchor-id="bayesian-methods">
<span class="header-section-number">13.7</span> Bayesian Methods</h2>
<p>Both GBLUP and SNP-BLUP assume that all SNPs contribute equally (on average) to genetic variance. This is a reasonable first approximation for many traits, but it’s not realistic for all traits. Some traits are influenced by a few large-effect QTL, while most SNPs have little to no effect. <strong>Bayesian methods</strong> relax the equal-variance assumption and allow SNPs to have different effect sizes—or even zero effect.</p>
<section id="motivation" class="level3" data-number="13.7.1"><h3 data-number="13.7.1" class="anchored" data-anchor-id="motivation">
<span class="header-section-number">13.7.1</span> Motivation</h3>
<p>The equal-variance assumption of SNP-BLUP implies that the genetic architecture is <strong>infinitesimal</strong>: thousands of genes each contributing tiny, equal effects. This assumption works well for traits like body weight or milk yield, which are truly polygenic.</p>
<p>However, consider these examples where the infinitesimal assumption breaks down:</p>
<ul>
<li>
<strong>Milk fat percentage in dairy cattle</strong>: The DGAT1 gene explains ~30% of genetic variance—one gene with a huge effect</li>
<li>
<strong>Coat color</strong>: A few major genes (MC1R, KIT, etc.) determine most variation</li>
<li>
<strong>Polled/horned in cattle</strong>: The POLLED gene has a near-Mendelian effect</li>
<li>
<strong>Disease resistance</strong>: Some pathogens have major resistance loci (e.g., MHC region)</li>
</ul>
<p>For these traits, forcing all SNPs to have equal variance is inefficient. It would be better to estimate <strong>large effects for SNPs near major QTL</strong> and <strong>small (or zero) effects for SNPs in neutral regions</strong>.</p>
<p>This is exactly what Bayesian methods do: they use <strong>prior distributions</strong> that allow SNPs to have different variances, giving the model flexibility to identify major-effect loci while shrinking small effects toward zero.</p>
</section><section id="the-bayesian-framework" class="level3" data-number="13.7.2"><h3 data-number="13.7.2" class="anchored" data-anchor-id="the-bayesian-framework">
<span class="header-section-number">13.7.2</span> The Bayesian Framework</h3>
<p>In Bayesian statistics, we combine:</p>
<ol type="1">
<li>
<strong>Prior distribution</strong>: Our beliefs about parameters before seeing data (e.g., “most SNPs have small effects”)</li>
<li>
<strong>Likelihood</strong>: The probability of the data given parameters</li>
<li>
<strong>Posterior distribution</strong>: Updated beliefs about parameters after seeing data</li>
</ol>
<p>For genomic prediction, we specify a <strong>prior distribution for SNP effects</strong> (β) that reflects our belief about genetic architecture. The data then updates these priors, yielding a <strong>posterior distribution</strong> for SNP effects. We use Markov Chain Monte Carlo (MCMC) to sample from the posterior.</p>
</section><section id="bayesa" class="level3" data-number="13.7.3"><h3 data-number="13.7.3" class="anchored" data-anchor-id="bayesa">
<span class="header-section-number">13.7.3</span> BayesA</h3>
<p><strong>BayesA</strong> was proposed by Meuwissen, Hayes, and Goddard (2001) as one of the original genomic selection methods.</p>
<p><strong>Key idea</strong>: All SNPs have effects, but each SNP has its own variance.</p>
<p><strong>Model</strong>:</p>
<p><span class="math display">\[y = X\alpha + \sum_{j=1}^{m} M_j \beta_j + e\]</span></p>
<p><strong>Prior distributions</strong>:</p>
<p><span class="math display">\[\beta_j | \sigma^2_{\beta_j} \sim N(0, \sigma^2_{\beta_j})\]</span> <span class="math display">\[\sigma^2_{\beta_j} \sim \text{Scaled Inverse Chi-Square}(\nu, S^2)\]</span></p>
<p>Where:</p>
<ul>
<li>
<strong><span class="math inline">\(\nu\)</span></strong> = degrees of freedom (typically 4-5)</li>
<li>
<strong><span class="math inline">\(S^2\)</span></strong> = scale parameter (related to expected genetic variance)</li>
</ul>
<p><strong>Interpretation</strong>:</p>
<ul>
<li>Each SNP has its own variance (<span class="math inline">\(\sigma^2_{\beta_j}\)</span>)</li>
<li>The prior on <span class="math inline">\(\sigma^2_{\beta_j}\)</span> has heavy tails, allowing some SNPs to have large variances (large effects)</li>
<li>Most SNPs will have small variances, but the model is flexible enough to accommodate a few large-effect SNPs</li>
</ul>
<p><strong>Result</strong>: SNPs near QTL get large effect estimates, while most SNPs get small (shrunken) estimates.</p>
</section><section id="bayesb" class="level3" data-number="13.7.4"><h3 data-number="13.7.4" class="anchored" data-anchor-id="bayesb">
<span class="header-section-number">13.7.4</span> BayesB</h3>
<p><strong>BayesB</strong> extends BayesA by allowing some SNPs to have <strong>exactly zero effect</strong>.</p>
<p><strong>Key idea</strong>: Only a proportion (<span class="math inline">\(\pi\)</span>) of SNPs affect the trait; the rest have β_j = 0.</p>
<p><strong>Model</strong>:</p>
<p><span class="math display">\[\beta_j = \begin{cases} 0 &amp; \text{with probability } \pi \\ N(0, \sigma^2_{\beta_j}) &amp; \text{with probability } 1-\pi \end{cases}\]</span></p>
<p>Where <span class="math inline">\(\sigma^2_{\beta_j}\)</span> again follows a scaled inverse chi-square distribution (as in BayesA).</p>
<p><strong>Interpretation</strong>:</p>
<ul>
<li>This is a <strong>mixture prior</strong>: SNPs are either “in the model” (with non-zero effect) or “out of the model” (zero effect)</li>
<li>
<strong><span class="math inline">\(\pi\)</span></strong> is pre-specified (e.g., <span class="math inline">\(\pi = 0.95\)</span> means 95% of SNPs have zero effect, 5% have non-zero effects)</li>
<li>SNPs in the model can have large effects (heavy-tailed prior on variance)</li>
</ul>
<p><strong>Result</strong>: The model performs <strong>variable selection</strong>—it identifies which SNPs are important and sets the rest to zero. This can improve accuracy for traits with few major QTL.</p>
</section><section id="bayesc-and-bayescπ" class="level3" data-number="13.7.5"><h3 data-number="13.7.5" class="anchored" data-anchor-id="bayesc-and-bayescπ">
<span class="header-section-number">13.7.5</span> BayesC and BayesCπ</h3>
<p><strong>BayesC</strong> is similar to BayesB, but SNPs “in the model” all share the <strong>same variance</strong> (like SNP-BLUP), rather than having individual variances.</p>
<p><strong>BayesCπ</strong> (BayesC-pi) extends BayesC by <strong>estimating <span class="math inline">\(\pi\)</span></strong> (the proportion of SNPs with zero effect) from the data, rather than pre-specifying it.</p>
<p><strong>Key idea</strong>: Let the data tell us how many SNPs affect the trait.</p>
<p><strong>Model</strong>:</p>
<p><span class="math display">\[\beta_j = \begin{cases} 0 &amp; \text{with probability } \pi \\ N(0, \sigma^2_{\beta}) &amp; \text{with probability } 1-\pi \end{cases}\]</span></p>
<p><strong>Prior on <span class="math inline">\(\pi\)</span></strong>:</p>
<p><span class="math display">\[\pi \sim \text{Uniform}(0, 1)\]</span></p>
<p>Or a more informative prior, e.g., Beta(1, 10), which favors most SNPs having zero effect.</p>
<p><strong>Interpretation</strong>:</p>
<ul>
<li>The model learns how “sparse” the genetic architecture is (i.e., what proportion of SNPs matter)</li>
<li>If the trait is highly polygenic, <span class="math inline">\(\pi\)</span> will be estimated near 0 (few SNPs excluded)</li>
<li>If the trait is oligogenic (few QTL), <span class="math inline">\(\pi\)</span> will be estimated near 1 (most SNPs excluded)</li>
</ul></section><section id="bayesian-lasso" class="level3" data-number="13.7.6"><h3 data-number="13.7.6" class="anchored" data-anchor-id="bayesian-lasso">
<span class="header-section-number">13.7.6</span> Bayesian Lasso</h3>
<p>The <strong>Bayesian Lasso</strong> uses a <strong>double exponential (Laplace) prior</strong> on SNP effects:</p>
<p><span class="math display">\[\beta_j | \lambda \sim \text{Double Exponential}(0, \lambda)\]</span></p>
<p><strong>Interpretation</strong>:</p>
<ul>
<li>This prior strongly shrinks small effects toward zero (like ridge regression but stronger)</li>
<li>Allows a few large effects to remain large</li>
<li>Does not perform explicit variable selection (all SNPs have non-zero effects, but many are tiny)</li>
<li>Computationally faster than BayesA/B/C</li>
</ul></section><section id="comparing-bayesian-methods" class="level3" data-number="13.7.7"><h3 data-number="13.7.7" class="anchored" data-anchor-id="comparing-bayesian-methods">
<span class="header-section-number">13.7.7</span> Comparing Bayesian Methods</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 10%">
<col style="width: 24%">
<col style="width: 24%">
<col style="width: 24%">
<col style="width: 17%">
</colgroup>
<thead><tr class="header">
<th>Method</th>
<th>SNPs with β = 0?</th>
<th>Variance per SNP</th>
<th>Estimates <span class="math inline">\(\pi\)</span>?</th>
<th>Best for…</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>BayesA</strong></td>
<td>No</td>
<td>Individual <span class="math inline">\(\sigma^2_{\beta_j}\)</span>
</td>
<td>N/A</td>
<td>Moderate polygenicity, some large QTL</td>
</tr>
<tr class="even">
<td><strong>BayesB</strong></td>
<td>Yes (π pre-specified)</td>
<td>Individual <span class="math inline">\(\sigma^2_{\beta_j}\)</span>
</td>
<td>No</td>
<td>Few large QTL, sparse architecture</td>
</tr>
<tr class="odd">
<td><strong>BayesC</strong></td>
<td>Yes (π pre-specified)</td>
<td>Shared <span class="math inline">\(\sigma^2_{\beta}\)</span>
</td>
<td>No</td>
<td>Few QTL, but equal-sized effects</td>
</tr>
<tr class="even">
<td><strong>BayesCπ</strong></td>
<td>Yes (π estimated)</td>
<td>Shared <span class="math inline">\(\sigma^2_{\beta}\)</span>
</td>
<td>Yes</td>
<td>Unknown architecture, data decides</td>
</tr>
<tr class="odd">
<td><strong>Bayesian Lasso</strong></td>
<td>No</td>
<td>Regularized via λ</td>
<td>N/A</td>
<td>Fast computation, moderate sparsity</td>
</tr>
</tbody>
</table></section><section id="when-bayesian-methods-help" class="level3" data-number="13.7.8"><h3 data-number="13.7.8" class="anchored" data-anchor-id="when-bayesian-methods-help">
<span class="header-section-number">13.7.8</span> When Bayesian Methods Help</h3>
<p>Bayesian methods can improve genomic prediction accuracy over GBLUP/SNP-BLUP, but the gain depends on the trait’s genetic architecture:</p>
<p><strong>Large gains (5-15% higher accuracy)</strong>:</p>
<ul>
<li>Traits with a few major QTL (e.g., milk fat %, coat color, some disease resistance)</li>
<li>Oligogenic traits (controlled by 5-50 genes)</li>
</ul>
<p><strong>Modest gains (0-5% higher accuracy)</strong>:</p>
<ul>
<li>Moderately polygenic traits (e.g., milk yield, body weight)</li>
<li>Traits where most QTL have small effects, but a few are larger</li>
</ul>
<p><strong>Little or no gain (&lt; 1% higher accuracy)</strong>:</p>
<ul>
<li>Highly polygenic traits with purely infinitesimal architecture</li>
<li>Traits with very low heritability (limited signal to detect QTL)</li>
</ul>
<p><strong>Trade-off</strong>: Bayesian methods are <strong>computationally expensive</strong>. MCMC requires thousands of iterations, and each iteration updates thousands of SNP effects. For large datasets (50K SNPs, 10,000 animals), Bayesian methods may take hours to days, while GBLUP takes minutes.</p>
</section><section id="software-for-bayesian-genomic-prediction" class="level3" data-number="13.7.9"><h3 data-number="13.7.9" class="anchored" data-anchor-id="software-for-bayesian-genomic-prediction">
<span class="header-section-number">13.7.9</span> Software for Bayesian Genomic Prediction</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 27%">
<col style="width: 25%">
<col style="width: 27%">
<col style="width: 19%">
</colgroup>
<thead><tr class="header">
<th>Software</th>
<th>Methods</th>
<th>Platform</th>
<th>Notes</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>BGLR</strong></td>
<td>BayesA, BayesB, BayesC, Bayesian Lasso, more</td>
<td>R</td>
<td>Most popular R package, well-documented</td>
</tr>
<tr class="even">
<td><strong>GenSel</strong></td>
<td>BayesB, BayesCπ</td>
<td>Standalone (Fortran)</td>
<td>Developed by Rohan Fernando’s group (Iowa State)</td>
</tr>
<tr class="odd">
<td><strong>bayz</strong></td>
<td>Flexible Bayesian models</td>
<td>R</td>
<td>General Bayesian modeling for genetics</td>
</tr>
<tr class="even">
<td><strong>JWAS</strong></td>
<td>Bayesian methods + single-step</td>
<td>Julia</td>
<td>Fast, modern language</td>
</tr>
</tbody>
</table>
<p><strong>Example using BGLR</strong> (conceptual):</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">BGLR</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># y = phenotypes, M = genotype matrix</span></span>
<span><span class="va">fit_BayesB</span> <span class="op">&lt;-</span> <span class="fu">BGLR</span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span>, ETA <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">M</span>, model <span class="op">=</span> <span class="st">"BayesB"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                   nIter <span class="op">=</span> <span class="fl">12000</span>, burnIn <span class="op">=</span> <span class="fl">2000</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract SNP effects</span></span>
<span><span class="va">beta_hat</span> <span class="op">&lt;-</span> <span class="va">fit_BayesB</span><span class="op">$</span><span class="va">ETA</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">b</span></span>
<span></span>
<span><span class="co"># Calculate GEBVs</span></span>
<span><span class="va">GEBV</span> <span class="op">&lt;-</span> <span class="va">M</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">beta_hat</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>We’ll demonstrate this in an R code example later in the chapter.</p>
</section><section id="summary-bayesian-vs.-gblup" class="level3" data-number="13.7.10"><h3 data-number="13.7.10" class="anchored" data-anchor-id="summary-bayesian-vs.-gblup">
<span class="header-section-number">13.7.10</span> Summary: Bayesian vs.&nbsp;GBLUP</h3>
<ul>
<li>
<strong>GBLUP</strong>: Fast, works well for most traits, industry standard</li>
<li>
<strong>Bayesian methods</strong>: Slower, but can improve accuracy for traits with major QTL</li>
<li>
<strong>In practice</strong>: Most breeding programs use GBLUP as the default, and apply Bayesian methods selectively for specific traits where QTL are known or suspected</li>
</ul>
<p>The Bayesian alphabet represents an important methodological advance, but the computational cost means it’s not universally adopted. For traits with known major genes (e.g., DGAT1 for milk fat), Bayesian methods are highly valuable.</p>
</section></section><section id="single-step-genomic-blup-ssgblup" class="level2" data-number="13.8"><h2 data-number="13.8" class="anchored" data-anchor-id="single-step-genomic-blup-ssgblup">
<span class="header-section-number">13.8</span> Single-Step Genomic BLUP (ssGBLUP)</h2>
<p>In the early years of genomic selection (2009-2013), most breeding programs used a <strong>two-step</strong> (or <strong>multi-step</strong>) approach:</p>
<ol type="1">
<li>
<strong>Step 1</strong>: Estimate SNP effects (or build G matrix) using a <strong>training population</strong> of genotyped animals with phenotypes</li>
<li>
<strong>Step 2</strong>: Apply those SNP effects to predict GEBVs for <strong>selection candidates</strong> (young, genotyped animals without phenotypes)</li>
</ol>
<p>This worked, but it had significant limitations. Enter <strong>single-step genomic BLUP</strong> (ssGBLUP), which revolutionized genomic evaluation by elegantly combining pedigree and genomic information in one unified analysis.</p>
<section id="the-problem-with-multi-step-approaches" class="level3" data-number="13.8.1"><h3 data-number="13.8.1" class="anchored" data-anchor-id="the-problem-with-multi-step-approaches">
<span class="header-section-number">13.8.1</span> The Problem with Multi-Step Approaches</h3>
<p>Multi-step genomic selection had several drawbacks:</p>
<ol type="1">
<li>
<strong>Genotyped and non-genotyped animals analyzed separately</strong>:
<ul>
<li>Traditional BLUP for non-genotyped animals (using pedigree A)</li>
<li>Genomic BLUP for genotyped animals (using genomic G)</li>
<li>Need to merge results, which creates scaling issues</li>
</ul>
</li>
<li>
<strong>Selection candidates not included in training</strong>:
<ul>
<li>Training population = animals with genotypes <strong>and</strong> phenotypes</li>
<li>Selection candidates = animals with genotypes <strong>but no</strong> phenotypes</li>
<li>Selection candidates don’t contribute to estimating SNP effects, even though they have relatives with data</li>
</ul>
</li>
<li>
<strong>Re-estimation required</strong>:
<ul>
<li>When new phenotypes arrive, must re-train the model from scratch</li>
<li>Computationally inefficient</li>
</ul>
</li>
<li>
<strong>EBVs and GEBVs on different scales</strong>:
<ul>
<li>Traditional EBVs (pedigree-based) and GEBVs (genomic) can’t be directly compared</li>
<li>Requires adjustments and approximations</li>
</ul>
</li>
</ol></section><section id="the-single-step-solution" class="level3" data-number="13.8.2"><h3 data-number="13.8.2" class="anchored" data-anchor-id="the-single-step-solution">
<span class="header-section-number">13.8.2</span> The Single-Step Solution</h3>
<p><strong>Single-step genomic BLUP</strong> (ssGBLUP) solves all these problems by analyzing <strong>all animals—genotyped and non-genotyped—in one unified model</strong>. The key innovation is the <strong>H matrix</strong>, which combines pedigree (A) and genomic (G) relationships.</p>
<p><strong>Key insight</strong>: For genotyped animals, use their realized genomic relationships (G). For non-genotyped animals, use their expected pedigree relationships (A). Blend the two seamlessly in one relationship matrix.</p>
<p>The result:</p>
<ul>
<li>One evaluation for <strong>all animals</strong>
</li>
<li>EBVs and GEBVs on the <strong>same scale</strong> (directly comparable)</li>
<li>
<strong>Automatic updates</strong> when new data arrive (just re-run BLUP with updated H)</li>
<li>
<strong>Optimal use</strong> of all information (phenotypes, pedigrees, genotypes)</li>
</ul>
<p>ssGBLUP was developed independently by two research groups in 2009-2010:</p>
<ul>
<li>
<strong>Andres Legarra, Ignacio Aguilar, and Ignacy Misztal</strong> (2009): “A relationship matrix including full pedigree and genomic information”</li>
<li>
<strong>Ole Christensen and Mogens Lund</strong> (2010): “Genomic prediction when some animals are not genotyped”</li>
</ul>
<p>Today, ssGBLUP is the <strong>industry standard</strong> for genomic evaluation in dairy cattle, beef cattle, and increasingly in swine and poultry.</p>
</section><section id="the-h-matrix" class="level3" data-number="13.8.3"><h3 data-number="13.8.3" class="anchored" data-anchor-id="the-h-matrix">
<span class="header-section-number">13.8.3</span> The H Matrix</h3>
<p>The <strong>H matrix</strong> is a unified relationship matrix that combines pedigree and genomic information. For a population with both genotyped and non-genotyped animals, H is structured as:</p>
<p><span class="math display">\[
H = \begin{bmatrix}
A_{11} + A_{12}A_{22}^{-1}(G - A_{22})A_{22}^{-1}A_{21} &amp; A_{12}A_{22}^{-1}G \\
GA_{22}^{-1}A_{21} &amp; G
\end{bmatrix}
\]</span></p>
<p>This looks complex, so it’s more commonly expressed via the <strong>inverse</strong>:</p>
<p><span class="math display">\[
H^{-1} = A^{-1} + \begin{bmatrix} 0 &amp; 0 \\ 0 &amp; G^{-1} - A_{22}^{-1} \end{bmatrix}
\]</span></p>
<p>Where:</p>
<ul>
<li>
<strong>A</strong> = pedigree relationship matrix for <strong>all animals</strong> (genotyped and non-genotyped)</li>
<li>
<strong>A_{22}</strong> = pedigree relationships among <strong>genotyped animals only</strong> (subset of A)</li>
<li>
<strong>G</strong> = genomic relationship matrix for <strong>genotyped animals only</strong>
</li>
<li>
<strong>0</strong> = blocks of zeros for non-genotyped animals (no genomic adjustment)</li>
</ul>
<p><strong>Interpretation</strong>:</p>
<ul>
<li>
<strong>Non-genotyped animals</strong>: Use <span class="math inline">\(A^{-1}\)</span> (pedigree relationships), no adjustment</li>
<li>
<strong>Genotyped animals</strong>: Use <span class="math inline">\(A^{-1}\)</span> + <span class="math inline">\((G^{-1} - A_{22}^{-1})\)</span> — this replaces pedigree relationships with genomic relationships</li>
</ul>
<p>The term <span class="math inline">\((G^{-1} - A_{22}^{-1})\)</span> is the <strong>genomic correction</strong>: it adjusts pedigree relationships to genomic relationships for genotyped animals.</p>
<p><strong>Practical implementation</strong>: Most software (BLUPF90, ASReml) builds <span class="math inline">\(H^{-1}\)</span> directly and solves mixed model equations. You don’t compute H explicitly—just provide the pedigree (A) and genotypes (to compute G).</p>
</section><section id="how-ssgblup-works-a-conceptual-example" class="level3" data-number="13.8.4"><h3 data-number="13.8.4" class="anchored" data-anchor-id="how-ssgblup-works-a-conceptual-example">
<span class="header-section-number">13.8.4</span> How ssGBLUP Works: A Conceptual Example</h3>
<p>Imagine a dairy herd with:</p>
<ul>
<li>
<strong>1000 cows</strong> with milk yield records
<ul>
<li>400 cows are genotyped</li>
<li>600 cows are not genotyped</li>
</ul>
</li>
<li>
<strong>50 young bulls</strong> (selection candidates)
<ul>
<li>All 50 bulls are genotyped</li>
<li>None have daughters with records yet (no phenotypes)</li>
</ul>
</li>
</ul>
<p><strong>Multi-step approach</strong> (old way):</p>
<ol type="1">
<li>Train genomic model on 400 genotyped cows</li>
<li>Predict GEBVs for 50 young bulls</li>
<li>Compute traditional EBVs for 600 non-genotyped cows</li>
<li>Try to merge GEBVs and EBVs (scaling issues!)</li>
</ol>
<p><strong>Single-step approach</strong> (ssGBLUP):</p>
<ol type="1">
<li>Build H matrix combining pedigree (all 1650 animals) and genotypes (450 animals)</li>
<li>Run BLUP once using H</li>
<li>Obtain breeding values for <strong>all 1650 animals</strong> simultaneously
<ul>
<li>400 genotyped cows: High accuracy (own data + genomic relationships)</li>
<li>600 non-genotyped cows: Moderate accuracy (own data + pedigree relationships)</li>
<li>50 young bulls: Moderate accuracy (no own data, but genomic relationships with genotyped cows)</li>
</ul>
</li>
</ol>
<p>All breeding values are on the <strong>same scale</strong> and directly comparable.</p>
</section><section id="advantages-of-ssgblup" class="level3" data-number="13.8.5"><h3 data-number="13.8.5" class="anchored" data-anchor-id="advantages-of-ssgblup">
<span class="header-section-number">13.8.5</span> Advantages of ssGBLUP</h3>
<ol type="1">
<li>
<strong>Unified evaluation</strong>: All animals in one analysis, regardless of genotype status</li>
<li>
<strong>Same scale</strong>: EBVs and GEBVs directly comparable (no scaling adjustments needed)</li>
<li>
<strong>Efficient</strong>: Uses all available information optimally
<ul>
<li>Phenotypes from genotyped <strong>and</strong> non-genotyped animals</li>
<li>Pedigree information for all animals</li>
<li>Genomic information for genotyped animals</li>
</ul>
</li>
<li>
<strong>Easy updates</strong>: When new animals are born or new phenotypes arrive, just re-run BLUP (no re-training of SNP effects)</li>
<li>
<strong>Computationally feasible</strong>: Despite large H matrices, sparse matrix algorithms make it fast enough for industry (evaluations of millions of animals)</li>
<li>
<strong>Handles complex pedigrees</strong>: Works even with incomplete or uncertain pedigrees (G provides information)</li>
<li>
<strong>No need for separate training/validation</strong>: All animals with data contribute to the evaluation</li>
</ol></section><section id="adoption-of-ssgblup" class="level3" data-number="13.8.6"><h3 data-number="13.8.6" class="anchored" data-anchor-id="adoption-of-ssgblup">
<span class="header-section-number">13.8.6</span> Adoption of ssGBLUP</h3>
<p>ssGBLUP has been rapidly adopted across livestock species:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 43%">
<col style="width: 36%">
</colgroup>
<thead><tr class="header">
<th>Species</th>
<th>Adoption Timeline</th>
<th>Implementation</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>Dairy cattle (US)</strong></td>
<td>2017 (CDCB)</td>
<td>Holsteins, Jerseys, all traits</td>
</tr>
<tr class="even">
<td><strong>Beef cattle (US)</strong></td>
<td>2013-2018</td>
<td>American Angus (2017), multiple breeds</td>
</tr>
<tr class="odd">
<td><strong>Swine</strong></td>
<td>2015-present</td>
<td>Major breeding companies (PIC, Topigs, Genesus)</td>
</tr>
<tr class="even">
<td><strong>Poultry</strong></td>
<td>2016-present</td>
<td>Cobb-Vantress, Aviagen, Hy-Line</td>
</tr>
<tr class="odd">
<td><strong>Sheep</strong></td>
<td>2018-present</td>
<td>LAMBPLAN (Australia), NSIP (US)</td>
</tr>
</tbody>
</table>
<p>Today, ssGBLUP is considered the <strong>gold standard</strong> for genomic evaluation. Multi-step approaches are mostly relegated to research or specialized applications.</p>
</section><section id="software-for-ssgblup" class="level3" data-number="13.8.7"><h3 data-number="13.8.7" class="anchored" data-anchor-id="software-for-ssgblup">
<span class="header-section-number">13.8.7</span> Software for ssGBLUP</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 27%">
<col style="width: 36%">
<col style="width: 16%">
<col style="width: 19%">
</colgroup>
<thead><tr class="header">
<th>Software</th>
<th>Description</th>
<th>Cost</th>
<th>Notes</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>BLUPF90 family</strong></td>
<td>Suite of programs (blupf90, remlf90, thrgibbs1f90)</td>
<td>Free</td>
<td>Most widely used, developed by Ignacy Misztal’s group (U. Georgia)</td>
</tr>
<tr class="even">
<td><strong>ASReml</strong></td>
<td>Mixed model software</td>
<td>Commercial</td>
<td>Powerful, flexible, widely used in research</td>
</tr>
<tr class="odd">
<td><strong>DMU</strong></td>
<td>Mixed model software</td>
<td>Free</td>
<td>Developed by Per Madsen (Aarhus University)</td>
</tr>
<tr class="even">
<td><strong>MiX99</strong></td>
<td>Mixed model software</td>
<td>Free</td>
<td>Developed by Esa Mäntysaari (Finland)</td>
</tr>
<tr class="odd">
<td><strong>JWAS</strong></td>
<td>Julia-based software</td>
<td>Free</td>
<td>Modern, fast, user-friendly</td>
</tr>
</tbody>
</table>
<p><strong>BLUPF90</strong> is the most common choice for large-scale industry evaluations due to its speed and ability to handle millions of animals.</p>
</section><section id="ssgblup-vs.-multi-step-summary" class="level3" data-number="13.8.8"><h3 data-number="13.8.8" class="anchored" data-anchor-id="ssgblup-vs.-multi-step-summary">
<span class="header-section-number">13.8.8</span> ssGBLUP vs.&nbsp;Multi-Step: Summary</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 27%">
<col style="width: 51%">
</colgroup>
<thead><tr class="header">
<th>Feature</th>
<th>Multi-Step</th>
<th>Single-Step (ssGBLUP)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>Genotyped &amp; non-genotyped animals</strong></td>
<td>Separate analyses</td>
<td>One unified analysis</td>
</tr>
<tr class="even">
<td><strong>EBV/GEBV scale</strong></td>
<td>Different scales, need adjustment</td>
<td>Same scale, directly comparable</td>
</tr>
<tr class="odd">
<td><strong>Selection candidates</strong></td>
<td>Not in training</td>
<td>Included via relationships</td>
</tr>
<tr class="even">
<td><strong>Updating with new data</strong></td>
<td>Re-train SNP effects</td>
<td>Re-run BLUP (automatic)</td>
</tr>
<tr class="odd">
<td><strong>Computational complexity</strong></td>
<td>Moderate</td>
<td>Higher (but feasible)</td>
</tr>
<tr class="even">
<td><strong>Industry adoption</strong></td>
<td>Historical (pre-2015)</td>
<td>Current standard (2015+)</td>
</tr>
</tbody>
</table>
<p>ssGBLUP represents the maturation of genomic selection: it seamlessly integrates genomics into existing BLUP infrastructure, making genomic evaluation as routine as traditional genetic evaluation.</p>
</section></section><section id="accuracy-of-genomic-predictions" class="level2" data-number="13.9"><h2 data-number="13.9" class="anchored" data-anchor-id="accuracy-of-genomic-predictions">
<span class="header-section-number">13.9</span> Accuracy of Genomic Predictions</h2>
<p>One of the most important questions in genomic selection is: <strong>How accurate will our predictions be?</strong> Accuracy determines the expected response to selection and whether genomic selection is worthwhile compared to traditional methods.</p>
<p>The <strong>accuracy</strong> of genomic prediction is the correlation between the estimated breeding value (GEBV) and the true breeding value (TBV):</p>
<p><span class="math display">\[r = \text{Cor}(GEBV, TBV)\]</span></p>
<p>Higher accuracy means we’re ranking animals more correctly, leading to greater genetic progress.</p>
<section id="factors-influencing-accuracy" class="level3" data-number="13.9.1"><h3 data-number="13.9.1" class="anchored" data-anchor-id="factors-influencing-accuracy">
<span class="header-section-number">13.9.1</span> Factors Influencing Accuracy</h3>
<p>Five main factors determine the accuracy of genomic predictions:</p>
<section id="size-of-training-population-n" class="level4"><h4 class="anchored" data-anchor-id="size-of-training-population-n">1. Size of Training Population (N)</h4>
<p>This is the <strong>most important factor</strong>. Larger training populations provide more information for estimating SNP effects or building the G matrix.</p>
<ul>
<li>
<strong>Small N</strong> (&lt; 1,000): Accuracy is low (r ≈ 0.30-0.45), only slightly better than parent average</li>
<li>
<strong>Moderate N</strong> (2,000-5,000): Accuracy is moderate (r ≈ 0.50-0.60)</li>
<li>
<strong>Large N</strong> (10,000+): Accuracy is high (r ≈ 0.60-0.75), approaching progeny test levels</li>
</ul>
<p><strong>Diminishing returns</strong>: Doubling the training population size does <strong>not</strong> double accuracy. To increase accuracy from 0.60 to 0.70 might require 4× more animals.</p>
<p><strong>Species differences</strong>:</p>
<ul>
<li>Dairy cattle: N = 10,000-100,000 progeny-tested bulls (very large training populations)</li>
<li>Swine: N = 5,000-20,000 pigs with performance records</li>
<li>Poultry: N = 20,000-100,000 birds (can afford to phenotype many birds)</li>
<li>Beef cattle: N = 5,000-30,000 (decentralized industry, smaller training populations)</li>
</ul></section><section id="heritability-of-the-trait-h²" class="level4"><h4 class="anchored" data-anchor-id="heritability-of-the-trait-h²">2. Heritability of the Trait (h²)</h4>
<p>Higher heritability means more genetic signal, making it easier to estimate breeding values accurately.</p>
<ul>
<li>
<strong>Low h²</strong> (&lt; 0.15): Accuracy is limited (r ≈ 0.30-0.50), even with large N
<ul>
<li>Examples: litter size, fertility, disease resistance</li>
</ul>
</li>
<li>
<strong>Moderate h²</strong> (0.20-0.40): Accuracy is moderate (r ≈ 0.50-0.65)
<ul>
<li>Examples: milk production, growth rate, feed efficiency</li>
</ul>
</li>
<li>
<strong>High h²</strong> (&gt; 0.40): Accuracy is high (r ≈ 0.65-0.80)
<ul>
<li>Examples: body weight, carcass traits, egg weight</li>
</ul>
</li>
</ul>
<p><strong>Key insight</strong>: Genomic selection helps most for <strong>low-heritability traits</strong>, where traditional methods (progeny testing) were slow and inaccurate. For high-heritability traits, even simple selection (own performance) works well.</p>
</section><section id="relationship-between-training-and-selection-candidates" class="level4"><h4 class="anchored" data-anchor-id="relationship-between-training-and-selection-candidates">3. Relationship Between Training and Selection Candidates</h4>
<p>Genomic predictions are most accurate when training and selection populations are <strong>closely related</strong>.</p>
<ul>
<li>
<strong>Close relatives</strong> (e.g., parents, sibs, cousins in training population): High accuracy</li>
<li>
<strong>Distant relatives</strong> (e.g., different families or lines): Lower accuracy</li>
<li>
<strong>Different breeds</strong>: Very low accuracy (LD patterns differ between breeds)</li>
</ul>
<p>This is why training populations must be <strong>continuously updated</strong>: as generations pass and selection proceeds, today’s selection candidates become less related to yesterday’s training population. Re-training with recent generations maintains accuracy.</p>
</section><section id="effective-population-size-n_e" class="level4"><h4 class="anchored" data-anchor-id="effective-population-size-n_e">4. Effective Population Size (N_e)</h4>
<p>Effective population size determines the <strong>extent of linkage disequilibrium</strong> (LD) in the population.</p>
<ul>
<li>
<strong>Smaller N_e</strong> → Longer LD → Fewer SNPs needed to capture genetic variance → Higher accuracy with a given SNP density</li>
<li>
<strong>Larger N_e</strong> → Shorter LD → More SNPs needed → Lower accuracy with fixed SNP density</li>
</ul>
<p>Livestock populations typically have small N_e (50-300), which is favorable for genomic selection. This is one reason why genomic selection works so well in livestock.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 11%">
<col style="width: 43%">
<col style="width: 44%">
</colgroup>
<thead><tr class="header">
<th>Species</th>
<th>Effective Population Size (N_e)</th>
<th>Implication for Genomic Selection</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Dairy cattle</td>
<td>100-150</td>
<td>Good LD, 50K SNPs sufficient</td>
</tr>
<tr class="even">
<td>Beef cattle</td>
<td>150-500 (varies by breed)</td>
<td>Moderate LD, 50K SNPs good</td>
</tr>
<tr class="odd">
<td>Swine</td>
<td>100-300</td>
<td>Good LD, 50K SNPs sufficient</td>
</tr>
<tr class="even">
<td>Poultry</td>
<td>50-150</td>
<td>Excellent LD, even 10K SNPs work well</td>
</tr>
</tbody>
</table></section><section id="snp-density" class="level4"><h4 class="anchored" data-anchor-id="snp-density">5. SNP Density</h4>
<p>More SNPs mean better coverage of the genome and higher LD between markers and causal mutations.</p>
<ul>
<li>
<strong>Low density</strong> (3K-10K SNPs): Lower accuracy, but cheap</li>
<li>
<strong>Medium density</strong> (50K SNPs): Good accuracy, standard in industry</li>
<li>
<strong>High density</strong> (600K-1M SNPs): Slightly higher accuracy, more expensive</li>
</ul>
<p><strong>Diminishing returns</strong>: Going from 10K to 50K SNPs increases accuracy substantially (~10-15%), but going from 50K to 600K only increases accuracy by ~2-5%.</p>
<p><strong>Imputation</strong> (Chapter 12) allows cost-effective use of high-density data: genotype animals with low-density chips, impute to high-density, and use imputed genotypes for prediction.</p>
</section></section><section id="typical-accuracies" class="level3" data-number="13.9.2"><h3 data-number="13.9.2" class="anchored" data-anchor-id="typical-accuracies">
<span class="header-section-number">13.9.2</span> Typical Accuracies</h3>
<p>Here are typical genomic prediction accuracies for different scenarios:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 32%">
<col style="width: 45%">
<col style="width: 22%">
</colgroup>
<thead><tr class="header">
<th>Scenario</th>
<th>Accuracy (r)</th>
<th>Notes</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>
<strong>Parent average</strong> (no genomics)</td>
<td>0.30-0.45</td>
<td>Traditional pedigree index</td>
</tr>
<tr class="even">
<td>
<strong>Genomic</strong> (young animal, h²=0.10, N=5,000)</td>
<td>0.35-0.45</td>
<td>Low h² trait, modest improvement</td>
</tr>
<tr class="odd">
<td>
<strong>Genomic</strong> (young animal, h²=0.30, N=5,000)</td>
<td>0.50-0.60</td>
<td>Moderate h² trait, good accuracy</td>
</tr>
<tr class="even">
<td>
<strong>Genomic</strong> (young animal, h²=0.30, N=20,000)</td>
<td>0.65-0.75</td>
<td>Large training population</td>
</tr>
<tr class="odd">
<td><strong>Genomic + own phenotype</strong></td>
<td>0.60-0.80</td>
<td>Combination of genomic and phenotypic info</td>
</tr>
<tr class="even">
<td>
<strong>Genomic + progeny</strong> (n=20)</td>
<td>0.80-0.90</td>
<td>Very high accuracy, but slower</td>
</tr>
<tr class="odd">
<td>
<strong>Progeny testing</strong> (n=50-100 daughters)</td>
<td>0.85-0.95</td>
<td>Gold standard, but slow and expensive</td>
</tr>
</tbody>
</table>
<p><strong>Key comparison</strong>: Genomic selection gives young animals (at birth) the accuracy that used to require 10-20 progeny records, but in <strong>zero time</strong>.</p>
</section><section id="deterministic-prediction-of-accuracy" class="level3" data-number="13.9.3"><h3 data-number="13.9.3" class="anchored" data-anchor-id="deterministic-prediction-of-accuracy">
<span class="header-section-number">13.9.3</span> Deterministic Prediction of Accuracy</h3>
<p><strong>Daetwyler et al.&nbsp;(2008)</strong> derived a simple formula for predicting the accuracy of genomic selection:</p>
<p><span class="math display">\[r = \sqrt{\frac{N h^2}{N h^2 + M_e}}\]</span></p>
<p>Where:</p>
<ul>
<li>
<strong>N</strong> = number of animals in the training population</li>
<li>
<strong>h²</strong> = heritability of the trait</li>
<li>
<strong>M_e</strong> = effective number of independent chromosome segments</li>
</ul>
<p><strong>M_e</strong> depends on effective population size and genome size. For livestock:</p>
<ul>
<li>Dairy cattle: M_e ≈ 1,000-2,000</li>
<li>Swine: M_e ≈ 1,200-1,800</li>
<li>Poultry: M_e ≈ 600-1,000 (smaller N_e, longer LD)</li>
</ul>
<p><strong>Interpretation</strong>:</p>
<ul>
<li>As <strong>N → ∞</strong>, accuracy approaches <span class="math inline">\(\sqrt{h^2} = h\)</span> (the theoretical maximum for predicting breeding values without progeny)</li>
<li>Accuracy increases with <strong>N</strong> and <strong>h²</strong>
</li>
<li>Accuracy is limited by <strong>M_e</strong>: populations with smaller M_e (longer LD) reach high accuracy with fewer training animals</li>
</ul>
<p><strong>Example calculation</strong>:</p>
<p>For dairy milk yield with h² = 0.30, N = 10,000, and M_e = 1,500:</p>
<p><span class="math display">\[r = \sqrt{\frac{10,000 \times 0.30}{10,000 \times 0.30 + 1,500}} = \sqrt{\frac{3,000}{4,500}} = \sqrt{0.667} = 0.82\]</span></p>
<p>This is very close to empirical accuracies observed in U.S. dairy cattle genomic evaluations.</p>
</section><section id="increasing-accuracy-over-time" class="level3" data-number="13.9.4"><h3 data-number="13.9.4" class="anchored" data-anchor-id="increasing-accuracy-over-time">
<span class="header-section-number">13.9.4</span> Increasing Accuracy Over Time</h3>
<p>Genomic prediction accuracy <strong>increases</strong> as breeding programs mature:</p>
<ol type="1">
<li>
<strong>Larger training populations</strong>: As more animals are genotyped and phenotyped, N grows</li>
<li>
<strong>Better phenotypes</strong>: Improved data collection (precision livestock farming) provides higher-quality phenotypes</li>
<li>
<strong>Updated SNP panels</strong>: Higher-density chips and whole-genome sequencing capture more genetic variation</li>
<li>
<strong>Improved methods</strong>: Better statistical models (e.g., multi-trait, multi-breed, machine learning)</li>
</ol>
<p>This creates a <strong>positive feedback loop</strong>: higher accuracy → faster genetic progress → better training population → even higher accuracy.</p>
</section><section id="r-demonstration-simulating-genomic-prediction-accuracy" class="level3" data-number="13.9.5"><h3 data-number="13.9.5" class="anchored" data-anchor-id="r-demonstration-simulating-genomic-prediction-accuracy">
<span class="header-section-number">13.9.5</span> R Demonstration: Simulating Genomic Prediction Accuracy</h3>
<p>Let’s use the Daetwyler formula to explore how training population size and heritability affect genomic prediction accuracy.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Daetwyler et al. (2008) accuracy formula</span></span>
<span><span class="va">genomic_accuracy</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">N</span>, <span class="va">h2</span>, <span class="va">Me</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="op">(</span><span class="va">N</span> <span class="op">*</span> <span class="va">h2</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">N</span> <span class="op">*</span> <span class="va">h2</span> <span class="op">+</span> <span class="va">Me</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Set parameters</span></span>
<span><span class="va">Me</span> <span class="op">&lt;-</span> <span class="fl">1500</span>  <span class="co"># Effective number of chromosome segments (typical for cattle)</span></span>
<span><span class="va">training_sizes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">500</span>, <span class="fl">20000</span>, by <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate accuracy for different heritabilities</span></span>
<span><span class="va">h2_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.10</span>, <span class="fl">0.20</span>, <span class="fl">0.30</span>, <span class="fl">0.40</span>, <span class="fl">0.50</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create data frame with all combinations</span></span>
<span><span class="va">accuracy_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span><span class="op">(</span></span>
<span>  N <span class="op">=</span> <span class="va">training_sizes</span>,</span>
<span>  h2 <span class="op">=</span> <span class="va">h2_values</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    accuracy <span class="op">=</span> <span class="fu">genomic_accuracy</span><span class="op">(</span><span class="va">N</span>, <span class="va">h2</span>, <span class="va">Me</span><span class="op">)</span>,</span>
<span>    h2_label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"h² = "</span>, <span class="va">h2</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot accuracy vs. training population size</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">accuracy_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">N</span>, y <span class="op">=</span> <span class="va">accuracy</span>, color <span class="op">=</span> <span class="va">h2_label</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_color_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set1"</span>, name <span class="op">=</span> <span class="st">"Heritability"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Genomic Prediction Accuracy vs. Training Population Size"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Me = "</span>, <span class="va">Me</span>, <span class="st">" (typical for cattle)"</span><span class="op">)</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Training Population Size (N)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Accuracy (r)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.7</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">18000</span>, y <span class="op">=</span> <span class="fl">0.52</span>, label <span class="op">=</span> <span class="st">"r = 0.50"</span>, size <span class="op">=</span> <span class="fl">3</span>, color <span class="op">=</span> <span class="st">"gray40"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">18000</span>, y <span class="op">=</span> <span class="fl">0.72</span>, label <span class="op">=</span> <span class="st">"r = 0.70"</span>, size <span class="op">=</span> <span class="fl">3</span>, color <span class="op">=</span> <span class="st">"gray40"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">p1</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="13-genomic-selection_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Calculate accuracy needed to match progeny testing (r = 0.85)</span></span>
<span><span class="co"># and find required training population size for h² = 0.30</span></span>
<span><span class="va">target_accuracy</span> <span class="op">&lt;-</span> <span class="fl">0.85</span></span>
<span><span class="va">h2_example</span> <span class="op">&lt;-</span> <span class="fl">0.30</span></span>
<span></span>
<span><span class="co"># Solve for N: r = sqrt(N*h2 / (N*h2 + Me))</span></span>
<span><span class="co"># r^2 = N*h2 / (N*h2 + Me)</span></span>
<span><span class="co"># r^2 * (N*h2 + Me) = N*h2</span></span>
<span><span class="co"># r^2*N*h2 + r^2*Me = N*h2</span></span>
<span><span class="co"># r^2*Me = N*h2 - r^2*N*h2</span></span>
<span><span class="co"># r^2*Me = N*h2*(1 - r^2)</span></span>
<span><span class="co"># N = r^2*Me / (h2*(1 - r^2))</span></span>
<span></span>
<span><span class="va">N_required</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">target_accuracy</span><span class="op">^</span><span class="fl">2</span> <span class="op">*</span> <span class="va">Me</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">h2_example</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">target_accuracy</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\nTo achieve accuracy r ="</span>, <span class="va">target_accuracy</span>,</span>
<span>    <span class="st">"for a trait with h² ="</span>, <span class="va">h2_example</span>,</span>
<span>    <span class="st">"\nTraining population size required: N ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">N_required</span>, <span class="fl">0</span><span class="op">)</span>, <span class="st">"animals\n"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
To achieve accuracy r = 0.85 for a trait with h² = 0.3 
Training population size required: N = 13018 animals</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Compare different species (different Me values)</span></span>
<span><span class="va">species_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>  Species <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Poultry"</span>, <span class="st">"Dairy Cattle"</span>, <span class="st">"Swine"</span>, <span class="st">"Beef Cattle"</span><span class="op">)</span>,</span>
<span>  Me <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">800</span>, <span class="fl">1500</span>, <span class="fl">1400</span>, <span class="fl">2000</span><span class="op">)</span>,</span>
<span>  N <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  h2 <span class="op">=</span> <span class="fl">0.30</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    accuracy <span class="op">=</span> <span class="fu">genomic_accuracy</span><span class="op">(</span><span class="va">N</span>, <span class="va">h2</span>, <span class="va">Me</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\nGenomic prediction accuracy across species (N = 10,000, h² = 0.30):\n"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Genomic prediction accuracy across species (N = 10,000, h² = 0.30):</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">species_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Species</span>, <span class="va">Me</span>, <span class="va">accuracy</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  Species         Me accuracy
  &lt;chr&gt;        &lt;dbl&gt;    &lt;dbl&gt;
1 Poultry        800    0.889
2 Dairy Cattle  1500    0.816
3 Swine         1400    0.826
4 Beef Cattle   2000    0.775</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Plot species comparison</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">species_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span><span class="op">(</span><span class="va">Species</span>, <span class="op">-</span><span class="va">accuracy</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">accuracy</span>, fill <span class="op">=</span> <span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, alpha <span class="op">=</span> <span class="fl">0.8</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Pastel1"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Genomic Prediction Accuracy by Species"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"N = 10,000, h² = 0.30 (Me varies by species)"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Species"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Accuracy (r)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">accuracy</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>, vjust <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span>, size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">p2</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="13-genomic-selection_files/figure-html/unnamed-chunk-3-2.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p><strong>Key insights</strong>:</p>
<ol type="1">
<li>
<strong>Diminishing returns</strong>: Accuracy increases rapidly with initial additions to training population, but gains slow as N grows large</li>
<li>
<strong>Heritability matters</strong>: Higher h² traits reach higher maximum accuracy</li>
<li>
<strong>Species differences</strong>: Species with smaller M_e (longer LD, like poultry) achieve higher accuracy with the same training population size</li>
<li>
<strong>To match progeny testing</strong> (r ≈ 0.85): Requires very large training populations (&gt;30,000 animals for moderate h² traits), which is feasible only in some species (dairy, poultry)</li>
</ol></section></section><section id="comparing-pedigree-a-and-genomic-g-relationship-matrices" class="level2" data-number="13.10"><h2 data-number="13.10" class="anchored" data-anchor-id="comparing-pedigree-a-and-genomic-g-relationship-matrices">
<span class="header-section-number">13.10</span> Comparing Pedigree (A) and Genomic (G) Relationship Matrices</h2>
<p>One of the most profound insights from genomic selection is that <strong>realized relationships differ from expected relationships</strong>. The pedigree relationship matrix (A) tells us the expected proportion of genome shared between relatives, but the genomic relationship matrix (G) tells us the actual proportion shared.</p>
<p>This section demonstrates why G is more powerful than A, using both numerical examples and visualizations.</p>
<section id="why-a-and-g-differ" class="level3" data-number="13.10.1"><h3 data-number="13.10.1" class="anchored" data-anchor-id="why-a-and-g-differ">
<span class="header-section-number">13.10.1</span> Why A and G Differ</h3>
<p><strong>Pedigree relationships (A)</strong> are based on expected inheritance:</p>
<ul>
<li>Parent-offspring: A_ij = 0.50 (always)</li>
<li>Full-siblings: A_ij = 0.50 (always)</li>
<li>Half-siblings: A_ij = 0.25 (always)</li>
<li>Unrelated: A_ij = 0 (if no common ancestors)</li>
</ul>
<p><strong>Genomic relationships (G)</strong> are based on realized inheritance:</p>
<ul>
<li>Parent-offspring: G_ij ≈ 0.50 (close to expected, little variation)</li>
<li>Full-siblings: G_ij ~ Normal(0.50, SD ≈ 0.04) — varies from ~0.42 to 0.58</li>
<li>Half-siblings: G_ij ~ Normal(0.25, SD ≈ 0.03) — varies from ~0.19 to 0.31</li>
<li>Unrelated: G_ij ≈ 0, but can be slightly negative (opposite alleles)</li>
</ul>
<p><strong>Source of variation</strong>: <strong>Mendelian sampling</strong> — the random segregation of parental chromosomes and recombination during meiosis. Full-siblings receive different combinations of parental chromosomes, so they don’t share exactly 50% of their genome.</p>
<p>This variation is crucial for genetic progress: it’s why some offspring are genetically superior to their parents (they inherited favorable alleles), while others are inferior (they inherited unfavorable alleles). <strong>G captures this variation; A does not.</strong></p>
</section><section id="numerical-example-full-siblings" class="level3" data-number="13.10.2"><h3 data-number="13.10.2" class="anchored" data-anchor-id="numerical-example-full-siblings">
<span class="header-section-number">13.10.2</span> Numerical Example: Full-Siblings</h3>
<p>Consider five pairs of full-siblings from the same parents. According to the pedigree (A matrix), all pairs should have relationship = 0.50. But with genomic data (G matrix), we might observe:</p>
<table class="caption-top table">
<thead><tr class="header">
<th>Pair</th>
<th>A (expected)</th>
<th>G (realized)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>0.50</td>
<td>0.48</td>
</tr>
<tr class="even">
<td>2</td>
<td>0.50</td>
<td>0.52</td>
</tr>
<tr class="odd">
<td>3</td>
<td>0.50</td>
<td>0.47</td>
</tr>
<tr class="even">
<td>4</td>
<td>0.50</td>
<td>0.53</td>
</tr>
<tr class="odd">
<td>5</td>
<td>0.50</td>
<td>0.49</td>
</tr>
</tbody>
</table>
<p>The <strong>standard deviation</strong> of G among full-siblings is typically ~0.03-0.04. This small variation is enough to improve genomic predictions significantly, because it captures which siblings inherited more favorable alleles.</p>
</section><section id="r-demonstration-comparing-a-and-g-matrices" class="level3" data-number="13.10.3"><h3 data-number="13.10.3" class="anchored" data-anchor-id="r-demonstration-comparing-a-and-g-matrices">
<span class="header-section-number">13.10.3</span> R Demonstration: Comparing A and G Matrices</h3>
<p>Let’s simulate a small pedigree, calculate both A and G matrices, and visualize the differences.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hadley/reshape">reshape2</a></span><span class="op">)</span>  <span class="co"># For melting matrices</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">54321</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulate a pedigree: 2 parents, 8 full-sib offspring</span></span>
<span><span class="va">n_offspring</span> <span class="op">&lt;-</span> <span class="fl">8</span></span>
<span><span class="va">n_animals</span> <span class="op">&lt;-</span> <span class="fl">10</span>  <span class="co"># 2 parents + 8 offspring</span></span>
<span></span>
<span><span class="va">pedigree_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">n_animals</span>,</span>
<span>  sire <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">n_offspring</span><span class="op">)</span><span class="op">)</span>,   <span class="co"># Parent 1 is sire</span></span>
<span>  dam <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="va">n_offspring</span><span class="op">)</span><span class="op">)</span>     <span class="co"># Parent 2 is dam</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Pedigree structure:\n"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Pedigree structure:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">pedigree_data</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   id sire dam
1   1    0   0
2   2    0   0
3   3    1   2
4   4    1   2
5   5    1   2
6   6    1   2
7   7    1   2
8   8    1   2
9   9    1   2
10 10    1   2</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Calculate pedigree relationship matrix (A) manually</span></span>
<span><span class="co"># For this simple pedigree (2 unrelated parents, 8 full-sib offspring)</span></span>
<span><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow <span class="op">=</span> <span class="va">n_animals</span>, ncol <span class="op">=</span> <span class="va">n_animals</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Anim_"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">n_animals</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Diagonal elements (self-relationships) = 1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span></span>
<span><span class="co"># Parents are unrelated to each other (A[1,2] = A[2,1] = 0)</span></span>
<span></span>
<span><span class="co"># Parent-offspring relationships = 0.5</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">3</span><span class="op">:</span><span class="va">n_animals</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">A</span><span class="op">[</span><span class="fl">1</span>, <span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">A</span><span class="op">[</span><span class="va">i</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.5</span>  <span class="co"># Sire to offspring</span></span>
<span>  <span class="va">A</span><span class="op">[</span><span class="fl">2</span>, <span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">A</span><span class="op">[</span><span class="va">i</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.5</span>  <span class="co"># Dam to offspring</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Full-sib relationships = 0.5</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">3</span><span class="op">:</span><span class="va">n_animals</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">3</span><span class="op">:</span><span class="va">n_animals</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">i</span> <span class="op">!=</span> <span class="va">j</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">A</span><span class="op">[</span><span class="va">i</span>, <span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\nPedigree relationship matrix (A):\n"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Pedigree relationship matrix (A):</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">A</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Anim_1 Anim_2 Anim_3 Anim_4 Anim_5 Anim_6 Anim_7 Anim_8 Anim_9 Anim_10
Anim_1     1.0    0.0    0.5    0.5    0.5    0.5    0.5    0.5    0.5     0.5
Anim_2     0.0    1.0    0.5    0.5    0.5    0.5    0.5    0.5    0.5     0.5
Anim_3     0.5    0.5    1.0    0.5    0.5    0.5    0.5    0.5    0.5     0.5
Anim_4     0.5    0.5    0.5    1.0    0.5    0.5    0.5    0.5    0.5     0.5
Anim_5     0.5    0.5    0.5    0.5    1.0    0.5    0.5    0.5    0.5     0.5
Anim_6     0.5    0.5    0.5    0.5    0.5    1.0    0.5    0.5    0.5     0.5
Anim_7     0.5    0.5    0.5    0.5    0.5    0.5    1.0    0.5    0.5     0.5
Anim_8     0.5    0.5    0.5    0.5    0.5    0.5    0.5    1.0    0.5     0.5
Anim_9     0.5    0.5    0.5    0.5    0.5    0.5    0.5    0.5    1.0     0.5
Anim_10    0.5    0.5    0.5    0.5    0.5    0.5    0.5    0.5    0.5     1.0</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Simulate genotypes for all 10 animals (1000 SNPs)</span></span>
<span><span class="va">n_snps</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span><span class="va">allele_freqs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">n_snps</span>, <span class="fl">0.2</span>, <span class="fl">0.8</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Parents: random genotypes</span></span>
<span><span class="va">parent1_geno</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span><span class="va">n_snps</span>, <span class="fl">2</span>, <span class="va">allele_freqs</span><span class="op">)</span></span>
<span><span class="va">parent2_geno</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span><span class="va">n_snps</span>, <span class="fl">2</span>, <span class="va">allele_freqs</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Offspring: inherit from parents (Mendelian segregation)</span></span>
<span><span class="va">offspring_geno</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, nrow <span class="op">=</span> <span class="va">n_offspring</span>, ncol <span class="op">=</span> <span class="va">n_snps</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n_offspring</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n_snps</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># Each offspring gets one allele from each parent</span></span>
<span>    <span class="va">allele_from_parent1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fl">1</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">-</span> <span class="va">parent1_geno</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>, <span class="va">parent1_geno</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span></span>
<span>    <span class="va">allele_from_parent2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fl">1</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">-</span> <span class="va">parent2_geno</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>, <span class="va">parent2_geno</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span></span>
<span>    <span class="va">offspring_geno</span><span class="op">[</span><span class="va">i</span>, <span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">allele_from_parent1</span> <span class="op">+</span> <span class="va">allele_from_parent2</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Combine into full genotype matrix</span></span>
<span><span class="va">M</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">parent1_geno</span>, <span class="va">parent2_geno</span>, <span class="va">offspring_geno</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Anim_"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">n_animals</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate genomic relationship matrix (G) using VanRaden's method</span></span>
<span><span class="va">p_j</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colMeans</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span></span>
<span><span class="va">P</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">p_j</span>, each <span class="op">=</span> <span class="va">n_animals</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">n_animals</span><span class="op">)</span></span>
<span><span class="va">Z</span> <span class="op">&lt;-</span> <span class="va">M</span> <span class="op">-</span> <span class="va">P</span></span>
<span><span class="va">denom</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">p_j</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p_j</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">G</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">Z</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">Z</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="va">denom</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\nGenomic relationship matrix (G):\n"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Genomic relationship matrix (G):</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">G</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Anim_1 Anim_2 Anim_3 Anim_4 Anim_5 Anim_6 Anim_7 Anim_8 Anim_9 Anim_10
Anim_1   0.755 -0.643 -0.040 -0.016 -0.022 -0.002 -0.010 -0.013  0.011  -0.021
Anim_2  -0.643  0.754  0.009 -0.022 -0.009 -0.024 -0.019 -0.015  0.002  -0.033
Anim_3  -0.040  0.009  0.584 -0.087 -0.078 -0.089 -0.072 -0.094 -0.025  -0.108
Anim_4  -0.016 -0.022 -0.087  0.628 -0.076 -0.101 -0.109 -0.025 -0.104  -0.088
Anim_5  -0.022 -0.009 -0.078 -0.076  0.625 -0.094 -0.093 -0.118 -0.066  -0.069
Anim_6  -0.002 -0.024 -0.089 -0.101 -0.094  0.602 -0.073 -0.123 -0.100   0.003
Anim_7  -0.010 -0.019 -0.072 -0.109 -0.093 -0.073  0.608 -0.061 -0.124  -0.047
Anim_8  -0.013 -0.015 -0.094 -0.025 -0.118 -0.123 -0.061  0.606 -0.056  -0.101
Anim_9   0.011  0.002 -0.025 -0.104 -0.066 -0.100 -0.124 -0.056  0.582  -0.119
Anim_10 -0.021 -0.033 -0.108 -0.088 -0.069  0.003 -0.047 -0.101 -0.119   0.583</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Compare A and G for full-sibs (offspring only, rows/cols 3-10)</span></span>
<span><span class="va">fullsib_indices</span> <span class="op">&lt;-</span> <span class="fl">3</span><span class="op">:</span><span class="fl">10</span></span>
<span><span class="va">A_fullsibs</span> <span class="op">&lt;-</span> <span class="va">A</span><span class="op">[</span><span class="va">fullsib_indices</span>, <span class="va">fullsib_indices</span><span class="op">]</span></span>
<span><span class="va">G_fullsibs</span> <span class="op">&lt;-</span> <span class="va">G</span><span class="op">[</span><span class="va">fullsib_indices</span>, <span class="va">fullsib_indices</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Extract off-diagonal elements (pairwise relationships)</span></span>
<span><span class="va">A_offd</span> <span class="op">&lt;-</span> <span class="va">A_fullsibs</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html">lower.tri</a></span><span class="op">(</span><span class="va">A_fullsibs</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">G_offd</span> <span class="op">&lt;-</span> <span class="va">G_fullsibs</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html">lower.tri</a></span><span class="op">(</span><span class="va">G_fullsibs</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\nFull-sibling relationships (off-diagonal):\n"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Full-sibling relationships (off-diagonal):</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"A (pedigree): All ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">A_offd</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>A (pedigree): All = 0.5 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"G (genomic): Mean ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">G_offd</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    <span class="st">", SD ="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">G_offd</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    <span class="st">", Range = ["</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">G_offd</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">","</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">G_offd</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"]\n"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>G (genomic): Mean = -0.082 , SD = 0.031 , Range = [ -0.124 , 0.003 ]</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Visualize A and G matrices side-by-side as heatmaps</span></span>
<span><span class="va">A_melted</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">A_melted</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Animal_1"</span>, <span class="st">"Animal_2"</span>, <span class="st">"Relationship"</span><span class="op">)</span></span>
<span><span class="va">A_melted</span><span class="op">$</span><span class="va">Matrix</span> <span class="op">&lt;-</span> <span class="st">"A (Pedigree)"</span></span>
<span></span>
<span><span class="va">G_melted</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="va">G</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">G_melted</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Animal_1"</span>, <span class="st">"Animal_2"</span>, <span class="st">"Relationship"</span><span class="op">)</span></span>
<span><span class="va">G_melted</span><span class="op">$</span><span class="va">Matrix</span> <span class="op">&lt;-</span> <span class="st">"G (Genomic)"</span></span>
<span></span>
<span><span class="va">combined_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">A_melted</span>, <span class="va">G_melted</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_heatmap</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">combined_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Animal_1</span>, y <span class="op">=</span> <span class="va">Animal_2</span>, fill <span class="op">=</span> <span class="va">Relationship</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_tile</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"white"</span>, linewidth <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">Matrix</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradient2</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"blue"</span>, mid <span class="op">=</span> <span class="st">"white"</span>, high <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>                       midpoint <span class="op">=</span> <span class="fl">0</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.2</span>, <span class="fl">1.2</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"Relationship"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Comparison of Pedigree (A) and Genomic (G) Relationship Matrices"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"2 parents + 8 full-sib offspring"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>        panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        strip.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span>, face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">p_heatmap</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="13-genomic-selection_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb61"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Scatter plot: A vs. G relationships (off-diagonal only)</span></span>
<span><span class="va">comparison_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  A_relationship <span class="op">=</span> <span class="va">A</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html">lower.tri</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span><span class="op">]</span>,</span>
<span>  G_relationship <span class="op">=</span> <span class="va">G</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html">lower.tri</a></span><span class="op">(</span><span class="va">G</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_scatter</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">comparison_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">A_relationship</span>, y <span class="op">=</span> <span class="va">G_relationship</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.6</span>, size <span class="op">=</span> <span class="fl">3</span>, color <span class="op">=</span> <span class="st">"steelblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_abline</a></span><span class="op">(</span>intercept <span class="op">=</span> <span class="fl">0</span>, slope <span class="op">=</span> <span class="fl">1</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"red"</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Pedigree (A) vs. Genomic (G) Relationships"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Points on red line = perfect agreement; scatter = Mendelian sampling variation"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Pedigree Relationship (A)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Genomic Relationship (G)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span><span class="op">(</span>ratio <span class="op">=</span> <span class="fl">1</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span>, <span class="fl">1</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">p_scatter</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="13-genomic-selection_files/figure-html/unnamed-chunk-4-2.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb62"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Highlight full-sib variation</span></span>
<span><span class="va">fullsib_comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  Pair <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">G_offd</span><span class="op">)</span>,</span>
<span>  A <span class="op">=</span> <span class="va">A_offd</span>,</span>
<span>  G <span class="op">=</span> <span class="va">G_offd</span>,</span>
<span>  Difference <span class="op">=</span> <span class="va">G_offd</span> <span class="op">-</span> <span class="va">A_offd</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_fullsibs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">fullsib_comparison</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Pair</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">A</span>, color <span class="op">=</span> <span class="st">"Expected (A)"</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">G</span>, color <span class="op">=</span> <span class="st">"Realized (G)"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">G</span>, color <span class="op">=</span> <span class="st">"Realized (G)"</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Expected (A)"</span> <span class="op">=</span> <span class="st">"black"</span>, <span class="st">"Realized (G)"</span> <span class="op">=</span> <span class="st">"steelblue"</span><span class="op">)</span>,</span>
<span>                     name <span class="op">=</span> <span class="st">"Relationship"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Full-Sibling Relationships: Expected vs. Realized"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"All pairs are full-sibs (same parents), but realized relationships vary"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Sibling Pair"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Relationship"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0.5</span>, linetype <span class="op">=</span> <span class="st">"dotted"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">p_fullsibs</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="13-genomic-selection_files/figure-html/unnamed-chunk-4-3.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb63"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\nKey observation: G captures Mendelian sampling variation that A cannot.\n"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Key observation: G captures Mendelian sampling variation that A cannot.</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb65"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"This variation improves genomic prediction accuracy.\n"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>This variation improves genomic prediction accuracy.</code></pre>
</div>
</div>
<p><strong>Interpretation</strong>:</p>
<ol type="1">
<li><p><strong>Heatmaps</strong>: The A matrix shows perfect symmetry and fixed values (all full-sibs = 0.50). The G matrix shows variation around those expected values—some pairs share more genome, others less.</p></li>
<li><p><strong>Scatter plot</strong>: Points scatter around the y = x line. The scatter represents <strong>Mendelian sampling</strong>—the realized sharing of genome differs from the expected sharing. This scatter is genetic information that improves predictions.</p></li>
<li><p><strong>Full-sib variation</strong>: Even though all offspring pairs are full-siblings (same parents), their genomic relationships range from ~0.46 to 0.54. The animals with G &gt; 0.50 inherited more similar chromosome segments; those with G &lt; 0.50 inherited more different segments.</p></li>
</ol>
<p><strong>Why this matters for genomic selection</strong>:</p>
<ul>
<li>G differentiates among relatives who A treats identically</li>
<li>This extra information increases accuracy of genomic predictions</li>
<li>
<strong>Example</strong>: Two full-sib bulls might have A = 0.50 (identical), but G = 0.48 vs.&nbsp;0.52. The bull with G = 0.52 is more similar to his high-producing sisters, so his GEBV for milk yield will be higher—even though they have the same pedigree!</li>
</ul>
<p>This is the essence of why genomic selection works better than pedigree-based selection.</p>
</section></section><section id="impact-of-genomic-selection-on-livestock-breeding" class="level2" data-number="13.11"><h2 data-number="13.11" class="anchored" data-anchor-id="impact-of-genomic-selection-on-livestock-breeding">
<span class="header-section-number">13.11</span> Impact of Genomic Selection on Livestock Breeding</h2>
<p>Genomic selection has transformed livestock breeding in ways that would have seemed impossible two decades ago. The speed and scale of genetic improvement have accelerated dramatically, creating economic value and addressing food security challenges. Let’s examine the impact in major livestock species.</p>
<section id="dairy-cattle-the-genomic-revolution" class="level3" data-number="13.11.1"><h3 data-number="13.11.1" class="anchored" data-anchor-id="dairy-cattle-the-genomic-revolution">
<span class="header-section-number">13.11.1</span> Dairy Cattle: The Genomic Revolution</h3>
<p><strong>Before genomics</strong> (pre-2009):</p>
<ul>
<li>Young bulls underwent <strong>progeny testing</strong>: mated to hundreds of cows, wait for daughters to lactate, measure milk production</li>
<li>
<strong>Generation interval</strong>: 6-7 years (birth → daughters born → daughters mature → daughters produce milk → bull evaluated)</li>
<li>
<strong>Accuracy</strong>: Very high (r ≈ 0.85-0.90) after 50-100 daughters, but slow</li>
<li>
<strong>Cost</strong>: $25,000-$50,000 per bull for progeny testing</li>
<li>
<strong>Genetic gain</strong>: ~100-120 kg milk per year</li>
</ul>
<p><strong>After genomics</strong> (2009-present):</p>
<ul>
<li>Young bulls <strong>genotyped at birth</strong>, GEBVs calculated immediately</li>
<li>
<strong>Generation interval</strong>: 2.5-3 years (bulls used at 1-2 years of age)</li>
<li>
<strong>Accuracy</strong>: Moderate to high (r ≈ 0.65-0.75) for genomic young bulls, without any daughters</li>
<li>
<strong>Cost</strong>: $50-$100 for genotyping (1000× cheaper than progeny testing!)</li>
<li>
<strong>Genetic gain</strong>: ~230-250 kg milk per year (<strong>doubled</strong> compared to pre-genomics)</li>
</ul>
<p><strong>Key statistics (U.S. Holsteins)</strong>:</p>
<ul>
<li>Annual genetic gain for milk yield increased from 120 kg/year (2000-2008) to 250 kg/year (2010-2020)</li>
<li>Generation interval decreased from 6.5 years to 2.8 years</li>
<li>Proportion of bulls progeny-tested dropped from 100% to &lt;10% (only elite sires are progeny-tested now)</li>
<li>Genomic breeding values now standard for all traits (milk, fat, protein, fertility, health, longevity)</li>
</ul>
<p><strong>Economic impact</strong>:</p>
<ul>
<li>U.S. dairy industry saves &gt;$100 million/year in progeny testing costs</li>
<li>Faster genetic gain adds ~$300 million/year in productivity improvements</li>
<li>Total economic benefit: ~$400 million/year</li>
</ul></section><section id="swine-precision-breeding-at-scale" class="level3" data-number="13.11.2"><h3 data-number="13.11.2" class="anchored" data-anchor-id="swine-precision-breeding-at-scale">
<span class="header-section-number">13.11.2</span> Swine: Precision Breeding at Scale</h3>
<p><strong>Key applications</strong>:</p>
<ol type="1">
<li>
<strong>Feed efficiency</strong>: Genomic selection enables accurate evaluation without expensive individual feed intake measurement
<ul>
<li>Before genomics: Feed efficiency required individual intake recording (expensive, labor-intensive)</li>
<li>With genomics: Select for feed efficiency using GEBVs (r ≈ 0.50-0.60), measure only a training population</li>
<li>Result: Genetic gain for feed efficiency increased 2-3×</li>
</ul>
</li>
<li>
<strong>Litter size</strong>: Low heritability (h² ≈ 0.10-0.15) trait benefits greatly from genomics
<ul>
<li>Genomic selection improves accuracy by 30-50% compared to pedigree</li>
<li>Faster improvement in number of pigs born alive and weaned</li>
</ul>
</li>
<li>
<strong>Crossbred performance</strong>: Genomic evaluations now predict crossbred performance directly
<ul>
<li>Purebred selection doesn’t always improve crossbred performance</li>
<li>Genomic models trained on crossbred data improve crossbred outcomes</li>
</ul>
</li>
</ol>
<p><strong>Timeline</strong>:</p>
<ul>
<li>2011-2014: Major breeding companies (PIC, Topigs Norsvin, Genesus) adopt genomic selection</li>
<li>2015-present: Single-step genomic BLUP becomes standard</li>
<li>Training populations now exceed 20,000-50,000 animals in major companies</li>
</ul>
<p><strong>Impact</strong>:</p>
<ul>
<li>Generation interval reduced from 1.8 years to 1.2 years</li>
<li>Genetic gain increased by 30-50% for most traits</li>
<li>Enabled selection for novel traits (disease resistance, welfare indicators)</li>
</ul></section><section id="poultry-extreme-selection-intensity" class="level3" data-number="13.11.3"><h3 data-number="13.11.3" class="anchored" data-anchor-id="poultry-extreme-selection-intensity">
<span class="header-section-number">13.11.3</span> Poultry: Extreme Selection Intensity</h3>
<p><strong>Unique advantages for genomics in poultry</strong>:</p>
<ol type="1">
<li>
<strong>Huge training populations</strong>: 20,000-100,000 birds genotyped (low genotyping cost, high bird numbers)</li>
<li>
<strong>High selection intensity</strong>: Thousands of candidates evaluated, top 1-5% selected</li>
<li>
<strong>Family-based structure</strong>: Pedigree hatching allows family evaluation with genomic data</li>
</ol>
<p><strong>Applications</strong>:</p>
<ul>
<li>
<strong>Growth rate</strong>: Already high h², but genomics reduces generation interval</li>
<li>
<strong>Feed efficiency</strong>: Expensive to measure individually, genomics enables accurate selection</li>
<li>
<strong>Leg health</strong>: Low h², improved dramatically with genomics (welfare benefit)</li>
<li>
<strong>Disease resistance</strong>: Genomic selection for specific pathogen resistance (e.g., Marek’s disease, Salmonella)</li>
<li>
<strong>Egg production and quality</strong>: Maintained high production while improving shell strength, egg size uniformity</li>
</ul>
<p><strong>Impact</strong>:</p>
<ul>
<li>Genetic gain increased 20-40% for most traits</li>
<li>Generation interval: already short (9-12 months), but genomics allows earlier selection (select at hatch based on parents’ GEBVs)</li>
<li>Accuracy for young birds: r ≈ 0.60-0.75 (very high due to large training populations)</li>
</ul>
<p><strong>Example</strong>: Broiler body weight at 6 weeks increased from ~2.5 kg (2000) to ~3.0 kg (2020), with much of the acceleration post-2010 due to genomics.</p>
</section><section id="beef-cattle-decentralized-adoption" class="level3" data-number="13.11.4"><h3 data-number="13.11.4" class="anchored" data-anchor-id="beef-cattle-decentralized-adoption">
<span class="header-section-number">13.11.4</span> Beef Cattle: Decentralized Adoption</h3>
<p><strong>Challenges unique to beef</strong>:</p>
<ul>
<li>Decentralized industry (many independent breeders)</li>
<li>Smaller training populations than dairy</li>
<li>Phenotypes harder to collect (carcass traits measured post-slaughter)</li>
</ul>
<p><strong>Progress</strong>:</p>
<ul>
<li>
<strong>Genomic EPDs</strong> available since 2012-2015 for major breeds</li>
<li>
<strong>American Angus Association</strong> implemented single-step GBLUP in 2017</li>
<li>Now standard for young bull selection in seedstock herds</li>
<li>Particularly valuable for:
<ul>
<li>
<strong>Carcass traits</strong> (marbling, ribeye area): Can’t measure on live animals, genomics enables selection without progeny slaughter</li>
<li>
<strong>Feed efficiency</strong>: Expensive to measure, genomics reduces cost</li>
<li>
<strong>Docility and calving ease</strong>: Low h², genomics improves accuracy</li>
</ul>
</li>
</ul>
<p><strong>Adoption</strong>:</p>
<ul>
<li>~40-60% of young bulls in major breeds are now genomically evaluated</li>
<li>Smaller uptake than dairy (less integration, lower ROI for small breeders)</li>
<li>Rapidly growing as genotyping costs decrease</li>
</ul>
<p><strong>Impact</strong>:</p>
<ul>
<li>Young bull accuracy increased from r ≈ 0.30 (parent average) to r ≈ 0.45-0.55 (genomic)</li>
<li>Genetic gain increased 15-30% (less dramatic than dairy, but significant)</li>
</ul></section><section id="sheep-emerging-adoption" class="level3" data-number="13.11.5"><h3 data-number="13.11.5" class="anchored" data-anchor-id="sheep-emerging-adoption">
<span class="header-section-number">13.11.5</span> Sheep: Emerging Adoption</h3>
<ul>
<li>LAMBPLAN (Australia) and NSIP (US) offer genomic evaluations</li>
<li>Smaller training populations (5,000-15,000 animals)</li>
<li>Accuracy improvements modest but valuable</li>
<li>Cost-benefit still being established for commercial producers</li>
</ul></section><section id="summary-of-industry-impact" class="level3" data-number="13.11.6"><h3 data-number="13.11.6" class="anchored" data-anchor-id="summary-of-industry-impact">
<span class="header-section-number">13.11.6</span> Summary of Industry Impact</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 10%">
<col style="width: 17%">
<col style="width: 25%">
<col style="width: 32%">
<col style="width: 14%">
</colgroup>
<thead><tr class="header">
<th>Species</th>
<th>Adoption Year</th>
<th>Genetic Gain Increase</th>
<th>Generation Interval Change</th>
<th>Key Benefit</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>Dairy</strong></td>
<td>2009</td>
<td>2× (doubled)</td>
<td>6.5 yr → 2.8 yr</td>
<td>Eliminated progeny testing</td>
</tr>
<tr class="even">
<td><strong>Swine</strong></td>
<td>2011-2014</td>
<td>1.3-1.5×</td>
<td>1.8 yr → 1.2 yr</td>
<td>Feed efficiency, crossbred performance</td>
</tr>
<tr class="odd">
<td><strong>Poultry</strong></td>
<td>2010-2015</td>
<td>1.2-1.4×</td>
<td>Minimal change (already short)</td>
<td>Leg health, disease resistance</td>
</tr>
<tr class="even">
<td><strong>Beef</strong></td>
<td>2012-2017</td>
<td>1.15-1.30×</td>
<td>Moderate decrease</td>
<td>Carcass traits, young bull accuracy</td>
</tr>
</tbody>
</table>
<p>Genomic selection is now the <strong>industry standard</strong> in all major livestock species. The technology has matured from experimental (2008-2010) to routine (2015+), delivering sustained economic value and accelerating genetic progress worldwide.</p>
</section></section><section id="summary" class="level2" data-number="13.12"><h2 data-number="13.12" class="anchored" data-anchor-id="summary">
<span class="header-section-number">13.12</span> Summary</h2>
<p>Genomic selection has revolutionized animal breeding by enabling accurate prediction of breeding values using genome-wide SNP data. This chapter covered the foundational concepts, methods, and industry impact of genomic selection.</p>
<section id="key-concepts" class="level3" data-number="13.12.1"><h3 data-number="13.12.1" class="anchored" data-anchor-id="key-concepts">
<span class="header-section-number">13.12.1</span> Key Concepts</h3>
<ol type="1">
<li><p><strong>Genomic selection</strong> predicts breeding values (GEBVs) from SNP genotypes, providing moderate to high accuracy for young animals without phenotypes or progeny data</p></li>
<li>
<p><strong>Two approaches</strong> to genomic prediction:</p>
<ul>
<li>
<strong>Animal model (GBLUP)</strong>: Estimates breeding values using genomic relationship matrix (G)</li>
<li>
<strong>Marker effects model (SNP-BLUP, Bayesian)</strong>: Estimates effects of individual SNPs, then sums to get GEBVs</li>
<li>These approaches are mathematically equivalent under certain assumptions</li>
</ul>
</li>
<li><p><strong>GBLUP</strong> uses the genomic relationship matrix (G) to capture realized relationships between animals, accounting for Mendelian sampling that pedigree (A) cannot</p></li>
<li><p><strong>Bayesian methods</strong> (BayesA, B, C, Cπ, Lasso) allow SNPs to have different effect sizes and can improve accuracy for traits with major QTL</p></li>
<li><p><strong>Single-step GBLUP (ssGBLUP)</strong> combines pedigree and genomic information in one unified analysis, making it the industry standard for routine evaluations</p></li>
<li><p><strong>Accuracy</strong> of genomic predictions depends on training population size (N), heritability (h²), effective population size (N_e), SNP density, and relationships between training and selection candidates</p></li>
<li><p><strong>Pedigree (A) vs.&nbsp;genomic (G)</strong> relationships: G captures Mendelian sampling variation that A treats as constant, providing extra genetic information that improves predictions</p></li>
<li><p><strong>Industry impact</strong>: Genomic selection has doubled genetic gain in dairy cattle, increased gain by 30-50% in swine and poultry, and transformed breeding programs across all major livestock species</p></li>
</ol></section><section id="the-big-picture" class="level3" data-number="13.12.2"><h3 data-number="13.12.2" class="anchored" data-anchor-id="the-big-picture">
<span class="header-section-number">13.12.2</span> The Big Picture</h3>
<p>Genomic selection broke the trade-off between accuracy and generation interval that constrained animal breeding for a century. By providing accurate breeding values at birth, genomic selection:</p>
<ul>
<li>
<strong>Reduces generation interval</strong> (L) by eliminating progeny testing</li>
<li>
<strong>Increases accuracy</strong> (r) for young animals without phenotypes</li>
<li>
<strong>Enables selection</strong> for expensive-to-measure traits (feed efficiency, disease resistance, carcass quality)</li>
<li>
<strong>Accelerates genetic progress</strong>: <span class="math inline">\(R = i \times r \times \sigma_A / L\)</span> increases due to higher r and lower L</li>
</ul>
<p>The result is faster, cheaper, and more effective genetic improvement—benefiting producers, consumers, and animal welfare.</p>
</section></section><section id="practice-problems" class="level2" data-number="13.13"><h2 data-number="13.13" class="anchored" data-anchor-id="practice-problems">
<span class="header-section-number">13.13</span> Practice Problems</h2>
<ol type="1">
<li><p><strong>Conceptual understanding</strong>: Explain why genomic selection is particularly beneficial for traits with low heritability (e.g., fertility, disease resistance). Why does genomic selection help more for these traits than for high-heritability traits?</p></li>
<li><p><strong>Accuracy calculation</strong>: A dairy breeding program has a training population of 5,000 bulls with phenotypes and genotypes. For a trait with h² = 0.25 and M_e = 1,200, estimate the accuracy of genomic predictions using the Daetwyler formula: <span class="math display">\[r = \sqrt{\frac{N h^2}{N h^2 + M_e}}\]</span> How does this compare to the parent average accuracy (r ≈ 0.35)?</p></li>
<li><p><strong>Methods comparison</strong>: Compare GBLUP, SNP-BLUP, and Bayesian methods (BayesB). When would you choose each approach? Give specific examples of traits where each method would be most appropriate.</p></li>
<li><p><strong>Single-step GBLUP</strong>: Explain how single-step GBLUP (ssGBLUP) combines pedigree and genomic information. What are the advantages of ssGBLUP over multi-step approaches? Why has ssGBLUP become the industry standard?</p></li>
<li><p><strong>G matrix interpretation</strong>: In a genomic relationship matrix (G), you observe that two full-sibling bulls have G_12 = 0.47 while two other full-sibling bulls have G_34 = 0.53. Their pedigree relationships are both A_12 = A_34 = 0.50. Explain why G values differ, and what this means for genomic selection.</p></li>
<li>
<p><strong>Training population size</strong>: A swine breeding company is deciding whether to genotype 2,000 or 10,000 animals for their training population. For a trait with h² = 0.30 and M_e = 1,400:</p>
<ul>
<li>Calculate the expected accuracy for each training population size</li>
<li>How much does accuracy improve by increasing from 2,000 to 10,000?</li>
<li>Discuss the cost-benefit trade-off of the larger training population</li>
</ul>
</li>
<li>
<p><strong>Impact on genetic gain</strong>: Before genomic selection, a dairy breeding program had:</p>
<ul>
<li>Selection intensity: i = 2.0</li>
<li>Accuracy: r = 0.40 (parent average for young bulls)</li>
<li>Genetic standard deviation: σ_A = 600 kg</li>
<li>Generation interval: L = 6 years</li>
</ul>
<p>After implementing genomic selection:</p>
<ul>
<li>Selection intensity: i = 2.5 (can evaluate more candidates)</li>
<li>Accuracy: r = 0.65 (genomic predictions)</li>
<li>Genetic standard deviation: σ_A = 600 kg (unchanged)</li>
<li>Generation interval: L = 2.5 years</li>
</ul>
<p>Calculate the annual genetic gain before and after genomic selection. By what factor did genetic gain increase?</p>
</li>
</ol></section><section id="further-reading" class="level2" data-number="13.14"><h2 data-number="13.14" class="anchored" data-anchor-id="further-reading">
<span class="header-section-number">13.14</span> Further Reading</h2>
<section id="foundational-papers" class="level3" data-number="13.14.1"><h3 data-number="13.14.1" class="anchored" data-anchor-id="foundational-papers">
<span class="header-section-number">13.14.1</span> Foundational Papers</h3>
<ul>
<li>
<strong>Meuwissen, T.H.E., Hayes, B.J., and Goddard, M.E. (2001)</strong>. “Prediction of Total Genetic Value Using Genome-Wide Dense Marker Maps.” <em>Genetics</em> 157(4):1819-1829.
<ul>
<li>The landmark paper that proposed genomic selection</li>
</ul>
</li>
<li>
<strong>VanRaden, P.M. (2008)</strong>. “Efficient Methods to Compute Genomic Predictions.” <em>Journal of Dairy Science</em> 91(11):4414-4423.
<ul>
<li>Introduced the G matrix and made GBLUP computationally feasible</li>
</ul>
</li>
<li>
<strong>Goddard, M.E., and Hayes, B.J. (2009)</strong>. “Mapping Genes for Complex Traits in Domestic Animals and Their Use in Breeding Programmes.” <em>Nature Reviews Genetics</em> 10:381-391.
<ul>
<li>Excellent review of genomic selection principles</li>
</ul>
</li>
</ul></section><section id="bayesian-methods-1" class="level3" data-number="13.14.2"><h3 data-number="13.14.2" class="anchored" data-anchor-id="bayesian-methods-1">
<span class="header-section-number">13.14.2</span> Bayesian Methods</h3>
<ul>
<li>
<strong>Gianola, D., et al.&nbsp;(2009)</strong>. “Additive Genetic Variability and the Bayesian Alphabet.” <em>Genetics</em> 183(1):347-363.
<ul>
<li>Comprehensive overview of Bayesian methods for genomic prediction</li>
</ul>
</li>
<li>
<strong>Habier, D., et al.&nbsp;(2011)</strong>. “Extension of the Bayesian Alphabet for Genomic Selection.” <em>BMC Bioinformatics</em> 12:186.
<ul>
<li>Describes BayesCπ and extensions</li>
</ul>
</li>
</ul></section><section id="single-step-gblup" class="level3" data-number="13.14.3"><h3 data-number="13.14.3" class="anchored" data-anchor-id="single-step-gblup">
<span class="header-section-number">13.14.3</span> Single-Step GBLUP</h3>
<ul>
<li>
<strong>Legarra, A., Aguilar, I., and Misztal, I. (2009)</strong>. “A Relationship Matrix Including Full Pedigree and Genomic Information.” <em>Journal of Dairy Science</em> 92(9):4656-4663.
<ul>
<li>Original single-step GBLUP paper</li>
</ul>
</li>
<li>
<strong>Christensen, O.F., and Lund, M.S. (2010)</strong>. “Genomic Prediction When Some Animals Are Not Genotyped.” <em>Genetics Selection Evolution</em> 42:2.
<ul>
<li>Alternative formulation of single-step GBLUP</li>
</ul>
</li>
</ul></section><section id="accuracy-and-prediction" class="level3" data-number="13.14.4"><h3 data-number="13.14.4" class="anchored" data-anchor-id="accuracy-and-prediction">
<span class="header-section-number">13.14.4</span> Accuracy and Prediction</h3>
<ul>
<li>
<strong>Daetwyler, H.D., et al.&nbsp;(2008)</strong>. “Accuracy of Predicting the Genetic Risk of Disease Using a Genome-Wide Approach.” <em>PLOS ONE</em> 3(10):e3395.
<ul>
<li>Deterministic formula for genomic prediction accuracy</li>
</ul>
</li>
<li>
<strong>Goddard, M.E. (2009)</strong>. “Genomic Selection: Prediction of Accuracy and Maximisation of Long Term Response.” <em>Genetica</em> 136:245-257.
<ul>
<li>Theory of accuracy and long-term response to genomic selection</li>
</ul>
</li>
</ul></section><section id="reviews-by-species" class="level3" data-number="13.14.5"><h3 data-number="13.14.5" class="anchored" data-anchor-id="reviews-by-species">
<span class="header-section-number">13.14.5</span> Reviews by Species</h3>
<ul>
<li>
<strong>Wiggans, G.R., et al.&nbsp;(2017)</strong>. “Genomic Selection in Dairy Cattle: Progress and Challenges.” <em>Journal of Dairy Science</em> 100(2):10-14.
<ul>
<li>Comprehensive review of dairy genomic selection</li>
</ul>
</li>
<li>
<strong>Dekkers, J.C.M., et al.&nbsp;(2012)</strong>. “Commercial Application of Marker- and Gene-Assisted Selection in Livestock: Strategies and Lessons.” <em>Journal of Animal Science</em> 90(5):1585-1594.
<ul>
<li>Practical implementation of genomic selection in swine</li>
</ul>
</li>
<li>
<strong>Wolc, A., et al.&nbsp;(2016)</strong>. “Genome-Wide Association Analysis and Genetic Architecture of Egg Weight and Egg Uniformity in Layer Chickens.” <em>Animal Genetics</em> 47(4):488-497.
<ul>
<li>Genomic selection in poultry</li>
</ul>
</li>
</ul></section><section id="textbooks" class="level3" data-number="13.14.6"><h3 data-number="13.14.6" class="anchored" data-anchor-id="textbooks">
<span class="header-section-number">13.14.6</span> Textbooks</h3>
<ul>
<li>
<strong>Mrode, R.A. (2014)</strong>. <em>Linear Models for the Prediction of Animal Breeding Values</em>, 3rd Edition. CAB International.
<ul>
<li>Chapters on GBLUP and genomic evaluations</li>
</ul>
</li>
<li>
<strong>Lynch, M., and Walsh, B. (1998)</strong>. <em>Genetics and Analysis of Quantitative Traits</em>. Sinauer Associates.
<ul>
<li>Foundational quantitative genetics (predates genomics, but essential background)</li>
</ul>
</li>
</ul></section><section id="online-resources" class="level3" data-number="13.14.7"><h3 data-number="13.14.7" class="anchored" data-anchor-id="online-resources">
<span class="header-section-number">13.14.7</span> Online Resources</h3>
<ul>
<li>
<strong>Council on Dairy Cattle Breeding (CDCB)</strong>: https://www.uscdcb.com/
<ul>
<li>U.S. dairy genomic evaluations, documentation, and genetic trends</li>
</ul>
</li>
<li>
<strong>BLUPF90 Software</strong>: http://nce.ads.uga.edu/wiki/doku.php
<ul>
<li>Free software for single-step GBLUP (widely used in industry)</li>
</ul>
</li>
<li>
<strong>Beef Improvement Federation Guidelines</strong>: https://beefimprovement.org/
<ul>
<li>Guidelines for genomic EPDs in beef cattle</li>
</ul>
</li>
</ul>


<!-- -->

</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
            // default icon
            link.classList.add("external");
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../chapters/12-genomics-intro.html" class="pagination-link" aria-label="Introduction to Genomics">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Introduction to Genomics</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../chapters/14-practical-skills.html" class="pagination-link" aria-label="Practical Animal Breeding and Data Skills">
        <span class="nav-page-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Practical Animal Breeding and Data Skills</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb67" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Genomic Selection {#sec-genomic-selection}</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">"learning-objectives"</span><span class="dt">&gt;</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="fu">### Learning Objectives {.unnumbered}</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>By the end of this chapter, you will be able to:</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Explain the principles and advantages of genomic selection</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Distinguish GBLUP, SNP-BLUP, and Bayesian genomic prediction methods</span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Understand single-step genomic BLUP and its practical importance</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Describe how genomic selection has impacted livestock breeding</span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Calculate expected accuracy of genomic predictions</span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb67-21"><a href="#cb67-21" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb67-22"><a href="#cb67-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-23"><a href="#cb67-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Load required packages</span></span>
<span id="cb67-24"><a href="#cb67-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb67-25"><a href="#cb67-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb67-26"><a href="#cb67-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-27"><a href="#cb67-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Set default theme for plots</span></span>
<span id="cb67-28"><a href="#cb67-28" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>))</span>
<span id="cb67-29"><a href="#cb67-29" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-30"><a href="#cb67-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-31"><a href="#cb67-31" aria-hidden="true" tabindex="-1"></a><span class="fu">## Introduction</span></span>
<span id="cb67-32"><a href="#cb67-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-33"><a href="#cb67-33" aria-hidden="true" tabindex="-1"></a>In 2001, Theo Meuwissen, Ben Hayes, and Mike Goddard published a paper that would fundamentally change animal breeding. Titled "Prediction of Total Genetic Value Using Genome-Wide Dense Marker Maps," this landmark paper proposed something revolutionary: What if we could predict an animal's breeding value directly from its DNA, without waiting for performance records or progeny data?</span>
<span id="cb67-34"><a href="#cb67-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-35"><a href="#cb67-35" aria-hidden="true" tabindex="-1"></a>At the time, this seemed almost too good to be true. Traditional animal breeding relied heavily on performance testing and progeny trials, which took years to complete. A dairy bull, for example, needed 5-6 years of progeny testing before breeders could confidently estimate his genetic merit for milk production. By the time his breeding value was known, he might be past his prime reproductive years. The same challenges existed across all livestock species—genetic evaluation was accurate but slow.</span>
<span id="cb67-36"><a href="#cb67-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-37"><a href="#cb67-37" aria-hidden="true" tabindex="-1"></a>Meuwissen and colleagues proposed using thousands of DNA markers (SNPs) spread across the entire genome to capture the effects of all genes affecting a trait. Because these markers are in linkage disequilibrium with the actual causal mutations, they could "tag" the genetic variation responsible for differences in performance. With a large enough **training population** of animals with both genotypes and phenotypes, one could estimate the relationship between SNP patterns and breeding values. These estimated relationships could then be applied to young animals with only genotype data, providing accurate predictions at birth—or even as embryos.</span>
<span id="cb67-38"><a href="#cb67-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-39"><a href="#cb67-39" aria-hidden="true" tabindex="-1"></a>The impact of this idea has been nothing short of transformative. Dairy cattle breeding adopted genomic selection in 2009, and the rate of genetic improvement immediately doubled. Similar revolutions followed in swine (2011-2014), poultry (2010-2015), and beef cattle (2012-2017). Today, genomic selection is the standard approach in nearly all major breeding programs worldwide.</span>
<span id="cb67-40"><a href="#cb67-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-41"><a href="#cb67-41" aria-hidden="true" tabindex="-1"></a>This chapter explains **how** genomic selection works. In Chapter 12, we learned about SNPs, genotyping technologies, and data quality control—the raw materials of genomic selection. Now we'll explore the statistical methods that turn genotype data into genomic predictions. We'll cover three major approaches:</span>
<span id="cb67-42"><a href="#cb67-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-43"><a href="#cb67-43" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**GBLUP (Genomic BLUP)**: Uses a genomic relationship matrix to predict breeding values</span>
<span id="cb67-44"><a href="#cb67-44" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Bayesian methods**: Allows different SNPs to have different effect sizes</span>
<span id="cb67-45"><a href="#cb67-45" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Single-step GBLUP**: Combines pedigree and genomic information in one unified analysis</span>
<span id="cb67-46"><a href="#cb67-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-47"><a href="#cb67-47" aria-hidden="true" tabindex="-1"></a>By the end of this chapter, you'll understand why genomic selection has revolutionized animal breeding, and how breeding companies use these methods to accelerate genetic progress.</span>
<span id="cb67-48"><a href="#cb67-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-49"><a href="#cb67-49" aria-hidden="true" tabindex="-1"></a><span class="fu">## What is Genomic Selection?</span></span>
<span id="cb67-50"><a href="#cb67-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-51"><a href="#cb67-51" aria-hidden="true" tabindex="-1"></a>**Genomic selection** is a method of predicting an animal's breeding value using genome-wide SNP genotype data. The predicted value is called a **GEBV** (Genomic Estimated Breeding Value), which represents our best estimate of an animal's true breeding value based on its DNA sequence.</span>
<span id="cb67-52"><a href="#cb67-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-53"><a href="#cb67-53" aria-hidden="true" tabindex="-1"></a>The fundamental idea is elegantly simple:</span>
<span id="cb67-54"><a href="#cb67-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-55"><a href="#cb67-55" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Build a training population**: Collect genotype and phenotype data (or conventional EBVs) on thousands of animals</span>
<span id="cb67-56"><a href="#cb67-56" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Estimate the relationship**: Use statistical models to learn how SNP patterns relate to breeding values</span>
<span id="cb67-57"><a href="#cb67-57" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Predict for selection candidates**: Apply the learned relationships to young, genotyped animals who don't yet have their own performance records</span>
<span id="cb67-58"><a href="#cb67-58" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Select the best**: Choose parents based on GEBVs instead of waiting for performance or progeny data</span>
<span id="cb67-59"><a href="#cb67-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-60"><a href="#cb67-60" aria-hidden="true" tabindex="-1"></a>This approach breaks the traditional trade-off between accuracy and generation interval that constrained animal breeding for decades.</span>
<span id="cb67-61"><a href="#cb67-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-62"><a href="#cb67-62" aria-hidden="true" tabindex="-1"></a><span class="fu">### Traditional Selection (Pre-Genomics)</span></span>
<span id="cb67-63"><a href="#cb67-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-64"><a href="#cb67-64" aria-hidden="true" tabindex="-1"></a>Before genomics, breeders faced a fundamental challenge: **accurate genetic evaluation required time**.</span>
<span id="cb67-65"><a href="#cb67-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-66"><a href="#cb67-66" aria-hidden="true" tabindex="-1"></a>For a young dairy bull with no daughters yet, the only information available was his pedigree. His estimated breeding value was essentially the average of his parents' EBVs—what we call the **parent average** or **pedigree index**. The accuracy of this prediction was modest at best:</span>
<span id="cb67-67"><a href="#cb67-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-68"><a href="#cb67-68" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Accuracy for young animals**: r ≈ 0.30-0.40 (based on parent average only)</span>
<span id="cb67-69"><a href="#cb67-69" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Selection intensity**: Limited, because predictions were imprecise</span>
<span id="cb67-70"><a href="#cb67-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-71"><a href="#cb67-71" aria-hidden="true" tabindex="-1"></a>To improve accuracy, breeders used **progeny testing**: mate the young bull to many cows, wait for daughters to lactate, measure their milk production, and calculate the bull's EBV based on daughter performance. This worked well for accuracy:</span>
<span id="cb67-72"><a href="#cb67-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-73"><a href="#cb67-73" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Accuracy with progeny data**: r ≈ 0.85-0.90 (after 50-100 daughters with records)</span>
<span id="cb67-74"><a href="#cb67-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-75"><a href="#cb67-75" aria-hidden="true" tabindex="-1"></a>But progeny testing came at a steep cost:</span>
<span id="cb67-76"><a href="#cb67-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-77"><a href="#cb67-77" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Generation interval**: 5-7 years (birth → mating → daughters born → daughters mature → milk records collected → EBV computed)</span>
<span id="cb67-78"><a href="#cb67-78" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Expense**: $25,000-$50,000 per bull (semen storage, matings, data collection)</span>
<span id="cb67-79"><a href="#cb67-79" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Opportunity cost**: By the time a bull's genetic merit was known, newer genetics might already be available</span>
<span id="cb67-80"><a href="#cb67-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-81"><a href="#cb67-81" aria-hidden="true" tabindex="-1"></a>This same pattern held across species. In swine, boars needed progeny in multiple litters before feed efficiency could be accurately evaluated. In beef cattle, carcass merit could only be assessed after offspring were slaughtered. The fundamental constraint was always the same: **accuracy required waiting for phenotypes**, which meant long generation intervals and slow genetic progress.</span>
<span id="cb67-82"><a href="#cb67-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-83"><a href="#cb67-83" aria-hidden="true" tabindex="-1"></a><span class="fu">### Genomic Selection</span></span>
<span id="cb67-84"><a href="#cb67-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-85"><a href="#cb67-85" aria-hidden="true" tabindex="-1"></a>Genomic selection changes everything by providing **moderate to high accuracy at birth**, without waiting for performance or progeny records.</span>
<span id="cb67-86"><a href="#cb67-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-87"><a href="#cb67-87" aria-hidden="true" tabindex="-1"></a>Here's what genomic selection uses:</span>
<span id="cb67-88"><a href="#cb67-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-89"><a href="#cb67-89" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Training population**: Animals with both genotypes and phenotypes (or traditional EBVs)</span>
<span id="cb67-90"><a href="#cb67-90" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Dairy: Thousands of progeny-tested bulls with daughter records</span>
<span id="cb67-91"><a href="#cb67-91" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Swine: Thousands of pigs with growth, carcass, and reproduction records</span>
<span id="cb67-92"><a href="#cb67-92" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Poultry: Tens of thousands of birds with production records</span>
<span id="cb67-93"><a href="#cb67-93" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Genomic prediction model**: Statistical method that learns how SNP patterns correlate with breeding values (more on this below)</span>
<span id="cb67-94"><a href="#cb67-94" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Selection candidates**: Young animals with genotypes but no performance records</span>
<span id="cb67-95"><a href="#cb67-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-96"><a href="#cb67-96" aria-hidden="true" tabindex="-1"></a>The result:</span>
<span id="cb67-97"><a href="#cb67-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-98"><a href="#cb67-98" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Accuracy for young animals**: r ≈ 0.50-0.70 (depending on training population size, heritability, and relationships)</span>
<span id="cb67-99"><a href="#cb67-99" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**At birth** (or even as embryos): No need to wait for maturity or progeny</span>
<span id="cb67-100"><a href="#cb67-100" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Generation interval**: Cut in half or more</span>
<span id="cb67-101"><a href="#cb67-101" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Dairy: From 6-7 years → 2.5-3 years</span>
<span id="cb67-102"><a href="#cb67-102" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Swine: From 1.8 years → 1.0-1.2 years</span>
<span id="cb67-103"><a href="#cb67-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-104"><a href="#cb67-104" aria-hidden="true" tabindex="-1"></a>The key advantage is not just accuracy—it's **high accuracy with short generation interval**. Recall the breeder's equation from Chapter 6:</span>
<span id="cb67-105"><a href="#cb67-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-106"><a href="#cb67-106" aria-hidden="true" tabindex="-1"></a>$$R = \frac{i \times r \times \sigma_A}{L}$$</span>
<span id="cb67-107"><a href="#cb67-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-108"><a href="#cb67-108" aria-hidden="true" tabindex="-1"></a>Genomic selection improves both numerator (r increases for young animals) and denominator (L decreases because we don't need to wait for progeny). The combined effect on genetic progress is dramatic: in U.S. dairy cattle, annual genetic gain for milk yield doubled from ~120 kg/year to ~250 kg/year after genomic selection was adopted in 2009.</span>
<span id="cb67-109"><a href="#cb67-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-110"><a href="#cb67-110" aria-hidden="true" tabindex="-1"></a><span class="fu">## Why Genomic Selection Works</span></span>
<span id="cb67-111"><a href="#cb67-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-112"><a href="#cb67-112" aria-hidden="true" tabindex="-1"></a>To understand why genomic selection works, we need to recall a fundamental principle from Chapter 12: **SNPs are not usually the causal mutations** that directly affect traits. Instead, they serve as **markers** that are statistically associated with nearby causal mutations. This association, called linkage disequilibrium, is the genetic foundation of genomic prediction.</span>
<span id="cb67-113"><a href="#cb67-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-114"><a href="#cb67-114" aria-hidden="true" tabindex="-1"></a><span class="fu">### Linkage Disequilibrium (LD)</span></span>
<span id="cb67-115"><a href="#cb67-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-116"><a href="#cb67-116" aria-hidden="true" tabindex="-1"></a>**Linkage disequilibrium (LD)** is the non-random association of alleles at different loci. When two loci are in LD, knowing the allele at one locus tells you something about the likely allele at the other locus.</span>
<span id="cb67-117"><a href="#cb67-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-118"><a href="#cb67-118" aria-hidden="true" tabindex="-1"></a>LD exists for several reasons:</span>
<span id="cb67-119"><a href="#cb67-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-120"><a href="#cb67-120" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Physical proximity**: Loci close together on the same chromosome are less likely to be separated by recombination</span>
<span id="cb67-121"><a href="#cb67-121" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Recent mutation**: Newly arisen mutations haven't had time to recombine onto different genetic backgrounds</span>
<span id="cb67-122"><a href="#cb67-122" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Population history**: Genetic drift, population bottlenecks, and selection create LD patterns</span>
<span id="cb67-123"><a href="#cb67-123" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Limited recombination**: Even over many generations, recombination is a relatively slow process</span>
<span id="cb67-124"><a href="#cb67-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-125"><a href="#cb67-125" aria-hidden="true" tabindex="-1"></a>Here's the key insight: If a SNP is in LD with a causal mutation (sometimes called a QTN—Quantitative Trait Nucleotide), then animals with a particular SNP allele will tend to have a particular QTN allele. The SNP **"tags"** the causal variant.</span>
<span id="cb67-126"><a href="#cb67-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-127"><a href="#cb67-127" aria-hidden="true" tabindex="-1"></a>For example, imagine a causal mutation that increases milk production by 50 kg per lactation. A nearby SNP might be in strong LD with this mutation. Even though the SNP itself doesn't affect milk yield, animals with the "A" allele at the SNP position will tend to carry the beneficial allele at the causal mutation. By tracking the SNP allele, we indirectly track the causal allele.</span>
<span id="cb67-128"><a href="#cb67-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-129"><a href="#cb67-129" aria-hidden="true" tabindex="-1"></a>The strength of LD decays with physical distance. In cattle, SNPs separated by 50,000 base pairs (50 kb) might have moderate LD, while SNPs 1 million base pairs apart typically have little LD. This is why dense SNP panels (50K or 600K+ SNPs) are necessary—we need enough markers to ensure that most causal mutations are in LD with at least one SNP on the array.</span>
<span id="cb67-130"><a href="#cb67-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-131"><a href="#cb67-131" aria-hidden="true" tabindex="-1"></a><span class="fu">### Capturing Additive Genetic Variance</span></span>
<span id="cb67-132"><a href="#cb67-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-133"><a href="#cb67-133" aria-hidden="true" tabindex="-1"></a>Quantitative traits like milk production, growth rate, and litter size are affected by hundreds to thousands of genes scattered across the genome. Each gene contributes a small amount to the total genetic variance. Genomic selection doesn't require identifying every causal gene—it just needs enough SNPs in LD with enough causal loci to capture most of the additive genetic variance.</span>
<span id="cb67-134"><a href="#cb67-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-135"><a href="#cb67-135" aria-hidden="true" tabindex="-1"></a>With a 50K SNP panel (one SNP every ~50,000 base pairs on average), we have excellent genome coverage in most livestock species. Even if we don't know which SNPs are causal, the combination of all SNP effects will track the sum of nearby causal effects. This "polygenic" approach works remarkably well for complex traits.</span>
<span id="cb67-136"><a href="#cb67-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-137"><a href="#cb67-137" aria-hidden="true" tabindex="-1"></a>The proportion of additive genetic variance captured depends on:</span>
<span id="cb67-138"><a href="#cb67-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-139"><a href="#cb67-139" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**SNP density**: More SNPs = better LD coverage</span>
<span id="cb67-140"><a href="#cb67-140" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Effective population size (N_e)**: Smaller N_e = longer LD = fewer SNPs needed</span>
<span id="cb67-141"><a href="#cb67-141" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Dairy cattle: N_e ≈ 100-150, medium LD</span>
<span id="cb67-142"><a href="#cb67-142" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Swine: N_e ≈ 100-300, medium LD</span>
<span id="cb67-143"><a href="#cb67-143" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Poultry: N_e ≈ 50-100, longer LD (easier to capture variance)</span>
<span id="cb67-144"><a href="#cb67-144" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Recombination rate**: Varies across chromosomes and species</span>
<span id="cb67-145"><a href="#cb67-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-146"><a href="#cb67-146" aria-hidden="true" tabindex="-1"></a>In practice, 50K SNP arrays capture 70-90% of additive genetic variance for most traits in dairy cattle. Higher-density arrays (600K+) capture slightly more, but the gain is modest. This is good news: we don't need perfect genome coverage, just good coverage.</span>
<span id="cb67-147"><a href="#cb67-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-148"><a href="#cb67-148" aria-hidden="true" tabindex="-1"></a><span class="fu">### Training Population</span></span>
<span id="cb67-149"><a href="#cb67-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-150"><a href="#cb67-150" aria-hidden="true" tabindex="-1"></a>The **training population** (also called the **reference population**) is the cornerstone of genomic selection. These are animals with:</span>
<span id="cb67-151"><a href="#cb67-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-152"><a href="#cb67-152" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Genotypes**: SNP data from a chip or sequencing</span>
<span id="cb67-153"><a href="#cb67-153" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Phenotypes**: Performance records, or conventional EBVs based on their own and relatives' records</span>
<span id="cb67-154"><a href="#cb67-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-155"><a href="#cb67-155" aria-hidden="true" tabindex="-1"></a>The training population is used to "train" the genomic prediction model—that is, to estimate how SNP patterns relate to breeding values. The larger and more representative the training population, the more accurate the genomic predictions will be.</span>
<span id="cb67-156"><a href="#cb67-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-157"><a href="#cb67-157" aria-hidden="true" tabindex="-1"></a>**Key factors for an effective training population:**</span>
<span id="cb67-158"><a href="#cb67-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-159"><a href="#cb67-159" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Size**: Larger is better. Thousands of animals are typically needed for moderate to high accuracy</span>
<span id="cb67-160"><a href="#cb67-160" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Dairy: 10,000-50,000 bulls with progeny-tested EBVs</span>
<span id="cb67-161"><a href="#cb67-161" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Swine: 5,000-20,000 pigs with performance records</span>
<span id="cb67-162"><a href="#cb67-162" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Poultry: 20,000-100,000 birds (huge populations possible due to low genotyping costs)</span>
<span id="cb67-163"><a href="#cb67-163" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Relationship to selection candidates**: Predictions are most accurate for animals closely related to the training population</span>
<span id="cb67-164"><a href="#cb67-164" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Ideally, training population includes sires, dams, and close relatives of candidates</span>
<span id="cb67-165"><a href="#cb67-165" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Accuracy declines if training and selection populations are distantly related (e.g., different breeds)</span>
<span id="cb67-166"><a href="#cb67-166" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Phenotype quality**: Accurate, well-recorded phenotypes lead to better predictions</span>
<span id="cb67-167"><a href="#cb67-167" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Training on progeny-tested EBVs (high accuracy) is better than training on single records</span>
<span id="cb67-168"><a href="#cb67-168" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Updated regularly**: As new data become available, re-train the model to maintain accuracy</span>
<span id="cb67-169"><a href="#cb67-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-170"><a href="#cb67-170" aria-hidden="true" tabindex="-1"></a>Once the training population is established and the model is trained, we can predict GEBVs for any genotyped animal—even newborns with no performance records. This is the power of genomic selection: the training population does the "heavy lifting" of connecting genotypes to phenotypes, and selection candidates benefit from this accumulated knowledge.</span>
<span id="cb67-171"><a href="#cb67-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-172"><a href="#cb67-172" aria-hidden="true" tabindex="-1"></a><span class="fu">## Two Main Approaches to Genomic Prediction</span></span>
<span id="cb67-173"><a href="#cb67-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-174"><a href="#cb67-174" aria-hidden="true" tabindex="-1"></a>There are two philosophical frameworks for genomic prediction, which differ in **what** they estimate:</span>
<span id="cb67-175"><a href="#cb67-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-176"><a href="#cb67-176" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Animal model approach** (also called "breeding value model"): Estimate **breeding values** directly for each animal, using genomic relationships</span>
<span id="cb67-177"><a href="#cb67-177" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Marker effects model**: Estimate the **effect of each SNP**, then sum SNP effects to calculate breeding values</span>
<span id="cb67-178"><a href="#cb67-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-179"><a href="#cb67-179" aria-hidden="true" tabindex="-1"></a>These approaches sound fundamentally different, but mathematically they are often equivalent—they're just different ways of parameterizing the same underlying model. However, they differ in computational approach, interpretation, and practical application.</span>
<span id="cb67-180"><a href="#cb67-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-181"><a href="#cb67-181" aria-hidden="true" tabindex="-1"></a><span class="fu">### Animal Model Approach (GBLUP)</span></span>
<span id="cb67-182"><a href="#cb67-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-183"><a href="#cb67-183" aria-hidden="true" tabindex="-1"></a>In the **animal model** approach, we estimate breeding values directly, just as in traditional BLUP (Chapter 7). The key difference is that we replace the pedigree relationship matrix (**A**) with the genomic relationship matrix (**G**).</span>
<span id="cb67-184"><a href="#cb67-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-185"><a href="#cb67-185" aria-hidden="true" tabindex="-1"></a>**What we estimate**: Breeding values (u) for each animal</span>
<span id="cb67-186"><a href="#cb67-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-187"><a href="#cb67-187" aria-hidden="true" tabindex="-1"></a>**Model**:</span>
<span id="cb67-188"><a href="#cb67-188" aria-hidden="true" tabindex="-1"></a>$$y = X\beta + Zu + e$$</span>
<span id="cb67-189"><a href="#cb67-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-190"><a href="#cb67-190" aria-hidden="true" tabindex="-1"></a>Where:</span>
<span id="cb67-191"><a href="#cb67-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-192"><a href="#cb67-192" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**y** = phenotypes (or EBVs from traditional evaluation)</span>
<span id="cb67-193"><a href="#cb67-193" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**X** = design matrix for fixed effects (contemporary groups, etc.)</span>
<span id="cb67-194"><a href="#cb67-194" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**β** = vector of fixed effects</span>
<span id="cb67-195"><a href="#cb67-195" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Z** = design matrix relating animals to records</span>
<span id="cb67-196"><a href="#cb67-196" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**u** = vector of breeding values (random effects)</span>
<span id="cb67-197"><a href="#cb67-197" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**e** = residual errors</span>
<span id="cb67-198"><a href="#cb67-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-199"><a href="#cb67-199" aria-hidden="true" tabindex="-1"></a>The key difference from traditional BLUP: breeding values are assumed to follow:</span>
<span id="cb67-200"><a href="#cb67-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-201"><a href="#cb67-201" aria-hidden="true" tabindex="-1"></a>$$u \sim N(0, G\sigma^2_u)$$</span>
<span id="cb67-202"><a href="#cb67-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-203"><a href="#cb67-203" aria-hidden="true" tabindex="-1"></a>That is, breeding values have a covariance structure defined by the **genomic relationship matrix** G (not the pedigree relationship matrix A).</span>
<span id="cb67-204"><a href="#cb67-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-205"><a href="#cb67-205" aria-hidden="true" tabindex="-1"></a>**Advantages**:</span>
<span id="cb67-206"><a href="#cb67-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-207"><a href="#cb67-207" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Conceptually simple (same framework as traditional BLUP)</span>
<span id="cb67-208"><a href="#cb67-208" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>G captures realized relationships (Mendelian sampling)</span>
<span id="cb67-209"><a href="#cb67-209" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Efficient computation for large datasets</span>
<span id="cb67-210"><a href="#cb67-210" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Most widely used in practice</span>
<span id="cb67-211"><a href="#cb67-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-212"><a href="#cb67-212" aria-hidden="true" tabindex="-1"></a>This approach is called **GBLUP** (Genomic BLUP).</span>
<span id="cb67-213"><a href="#cb67-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-214"><a href="#cb67-214" aria-hidden="true" tabindex="-1"></a><span class="fu">### Marker Effects Model Approach</span></span>
<span id="cb67-215"><a href="#cb67-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-216"><a href="#cb67-216" aria-hidden="true" tabindex="-1"></a>In the **marker effects model** approach, we estimate the effect of each individual SNP, then sum those effects to calculate breeding values.</span>
<span id="cb67-217"><a href="#cb67-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-218"><a href="#cb67-218" aria-hidden="true" tabindex="-1"></a>**What we estimate**: SNP effects (β_j) for each of thousands of SNPs</span>
<span id="cb67-219"><a href="#cb67-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-220"><a href="#cb67-220" aria-hidden="true" tabindex="-1"></a>**Model**:</span>
<span id="cb67-221"><a href="#cb67-221" aria-hidden="true" tabindex="-1"></a>$$y = X\alpha + \sum_{j=1}^{m} x_j \beta_j + e$$</span>
<span id="cb67-222"><a href="#cb67-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-223"><a href="#cb67-223" aria-hidden="true" tabindex="-1"></a>Or in matrix notation:</span>
<span id="cb67-224"><a href="#cb67-224" aria-hidden="true" tabindex="-1"></a>$$y = X\alpha + M\beta + e$$</span>
<span id="cb67-225"><a href="#cb67-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-226"><a href="#cb67-226" aria-hidden="true" tabindex="-1"></a>Where:</span>
<span id="cb67-227"><a href="#cb67-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-228"><a href="#cb67-228" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**y** = phenotypes</span>
<span id="cb67-229"><a href="#cb67-229" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**X** = design matrix for fixed effects</span>
<span id="cb67-230"><a href="#cb67-230" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**α** = vector of fixed effects</span>
<span id="cb67-231"><a href="#cb67-231" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**M** = matrix of SNP genotypes (rows = animals, columns = SNPs)</span>
<span id="cb67-232"><a href="#cb67-232" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**β** = vector of SNP effects (one effect per SNP)</span>
<span id="cb67-233"><a href="#cb67-233" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**m** = number of SNPs (often 50,000+)</span>
<span id="cb67-234"><a href="#cb67-234" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**e** = residual errors</span>
<span id="cb67-235"><a href="#cb67-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-236"><a href="#cb67-236" aria-hidden="true" tabindex="-1"></a>Once SNP effects (β) are estimated, we calculate the **GEBV** for animal *i* as:</span>
<span id="cb67-237"><a href="#cb67-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-238"><a href="#cb67-238" aria-hidden="true" tabindex="-1"></a>$$GEBV_i = \sum_{j=1}^{m} (x_{ij} - 2p_j) \hat{\beta}_j$$</span>
<span id="cb67-239"><a href="#cb67-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-240"><a href="#cb67-240" aria-hidden="true" tabindex="-1"></a>Where:</span>
<span id="cb67-241"><a href="#cb67-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-242"><a href="#cb67-242" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**x_ij** = genotype of animal *i* at SNP *j* (coded 0, 1, or 2)</span>
<span id="cb67-243"><a href="#cb67-243" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**p_j** = allele frequency at SNP *j* in the base population</span>
<span id="cb67-244"><a href="#cb67-244" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**$(x_{ij} - 2p_j)$** = centered genotype (centers at zero for the population mean)</span>
<span id="cb67-245"><a href="#cb67-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-246"><a href="#cb67-246" aria-hidden="true" tabindex="-1"></a>**Advantages**:</span>
<span id="cb67-247"><a href="#cb67-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-248"><a href="#cb67-248" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Estimates SNP effects directly (useful for identifying important genomic regions)</span>
<span id="cb67-249"><a href="#cb67-249" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Can apply different assumptions about SNP effect distributions (e.g., Bayesian methods)</span>
<span id="cb67-250"><a href="#cb67-250" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Easy to calculate GEBVs for new animals once β is estimated</span>
<span id="cb67-251"><a href="#cb67-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-252"><a href="#cb67-252" aria-hidden="true" tabindex="-1"></a>**Disadvantage**:</span>
<span id="cb67-253"><a href="#cb67-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-254"><a href="#cb67-254" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Computationally challenging when m (number of SNPs) &gt;&gt; n (number of animals)</span>
<span id="cb67-255"><a href="#cb67-255" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Requires specialized algorithms (e.g., Bayesian MCMC)</span>
<span id="cb67-256"><a href="#cb67-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-257"><a href="#cb67-257" aria-hidden="true" tabindex="-1"></a>Methods in this category include **SNP-BLUP** (assumes all SNPs have equal variance) and **Bayesian methods** (allow SNPs to have different variances).</span>
<span id="cb67-258"><a href="#cb67-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-259"><a href="#cb67-259" aria-hidden="true" tabindex="-1"></a><span class="fu">### Equivalence of GBLUP and SNP-BLUP</span></span>
<span id="cb67-260"><a href="#cb67-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-261"><a href="#cb67-261" aria-hidden="true" tabindex="-1"></a>Under certain assumptions, GBLUP (animal model) and SNP-BLUP (marker effects model) are **mathematically equivalent**—they produce identical GEBVs.</span>
<span id="cb67-262"><a href="#cb67-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-263"><a href="#cb67-263" aria-hidden="true" tabindex="-1"></a>Specifically, when:</span>
<span id="cb67-264"><a href="#cb67-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-265"><a href="#cb67-265" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>All SNPs have equal variance (no large-effect QTL)</span>
<span id="cb67-266"><a href="#cb67-266" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>The genomic relationship matrix G is computed as: $G = \frac{MM'}{2\sum p_j(1-p_j)}$ (VanRaden's first method)</span>
<span id="cb67-267"><a href="#cb67-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-268"><a href="#cb67-268" aria-hidden="true" tabindex="-1"></a>Then the breeding values from GBLUP equal the sum of SNP effects from SNP-BLUP.</span>
<span id="cb67-269"><a href="#cb67-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-270"><a href="#cb67-270" aria-hidden="true" tabindex="-1"></a>This equivalence is powerful: we can choose whichever approach is computationally convenient. For large datasets with many animals, GBLUP is often faster. For datasets with more SNPs than animals, SNP-BLUP may be more efficient.</span>
<span id="cb67-271"><a href="#cb67-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-272"><a href="#cb67-272" aria-hidden="true" tabindex="-1"></a><span class="fu">### Practical Differences</span></span>
<span id="cb67-273"><a href="#cb67-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-274"><a href="#cb67-274" aria-hidden="true" tabindex="-1"></a>Despite mathematical equivalence, the two approaches differ in practice:</span>
<span id="cb67-275"><a href="#cb67-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-276"><a href="#cb67-276" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Feature <span class="pp">|</span> Animal Model (GBLUP) <span class="pp">|</span> Marker Effects Model (SNP-BLUP, Bayesian) <span class="pp">|</span></span>
<span id="cb67-277"><a href="#cb67-277" aria-hidden="true" tabindex="-1"></a><span class="pp">|---------|----------------------|---------------------------------------------|</span></span>
<span id="cb67-278"><a href="#cb67-278" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Estimates** <span class="pp">|</span> Breeding values (u) <span class="pp">|</span> SNP effects (β) <span class="pp">|</span></span>
<span id="cb67-279"><a href="#cb67-279" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Computation** <span class="pp">|</span> Fast for large n <span class="pp">|</span> Faster for large m <span class="pp">|</span></span>
<span id="cb67-280"><a href="#cb67-280" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Interpretation** <span class="pp">|</span> Directly provides GEBVs <span class="pp">|</span> Provides SNP effects; sum to get GEBVs <span class="pp">|</span></span>
<span id="cb67-281"><a href="#cb67-281" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **SNP information** <span class="pp">|</span> Implicit (via G matrix) <span class="pp">|</span> Explicit (each SNP has estimated effect) <span class="pp">|</span></span>
<span id="cb67-282"><a href="#cb67-282" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Flexibility** <span class="pp">|</span> Less flexible (assumes equal variance) <span class="pp">|</span> More flexible (can vary SNP variances) <span class="pp">|</span></span>
<span id="cb67-283"><a href="#cb67-283" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Software** <span class="pp">|</span> ASReml, BLUPF90 <span class="pp">|</span> BGLR, GenSel, brms <span class="pp">|</span></span>
<span id="cb67-284"><a href="#cb67-284" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Use case** <span class="pp">|</span> Standard industry practice <span class="pp">|</span> Research, QTL mapping, traits with major genes <span class="pp">|</span></span>
<span id="cb67-285"><a href="#cb67-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-286"><a href="#cb67-286" aria-hidden="true" tabindex="-1"></a>In the following sections, we'll explore GBLUP, SNP-BLUP, and Bayesian methods in detail.</span>
<span id="cb67-287"><a href="#cb67-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-288"><a href="#cb67-288" aria-hidden="true" tabindex="-1"></a><span class="fu">## GBLUP (Genomic BLUP)</span></span>
<span id="cb67-289"><a href="#cb67-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-290"><a href="#cb67-290" aria-hidden="true" tabindex="-1"></a>GBLUP (Genomic Best Linear Unbiased Prediction) is the animal model approach to genomic selection. It extends traditional BLUP (Chapter 7) by replacing the pedigree relationship matrix (A) with a **genomic relationship matrix** (G) that captures the actual realized relationships between animals based on their DNA.</span>
<span id="cb67-291"><a href="#cb67-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-292"><a href="#cb67-292" aria-hidden="true" tabindex="-1"></a>GBLUP was popularized by Paul VanRaden's 2008 paper "Efficient Methods to Compute Genomic Predictions," which provided computationally feasible methods for calculating G and solving genomic evaluations. Today, GBLUP is the foundation of genomic selection in dairy cattle, beef cattle, and many other species.</span>
<span id="cb67-293"><a href="#cb67-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-294"><a href="#cb67-294" aria-hidden="true" tabindex="-1"></a><span class="fu">### Genomic Relationship Matrix (G)</span></span>
<span id="cb67-295"><a href="#cb67-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-296"><a href="#cb67-296" aria-hidden="true" tabindex="-1"></a>The **genomic relationship matrix** (G) quantifies the genetic similarity between pairs of animals based on their SNP genotypes. It's analogous to the pedigree relationship matrix (A), but instead of relying on expected relationships from the pedigree, G uses the **realized** (actual) sharing of genome segments.</span>
<span id="cb67-297"><a href="#cb67-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-298"><a href="#cb67-298" aria-hidden="true" tabindex="-1"></a>**Key differences between A and G**:</span>
<span id="cb67-299"><a href="#cb67-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-300"><a href="#cb67-300" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Feature <span class="pp">|</span> A (Pedigree Matrix) <span class="pp">|</span> G (Genomic Matrix) <span class="pp">|</span></span>
<span id="cb67-301"><a href="#cb67-301" aria-hidden="true" tabindex="-1"></a><span class="pp">|---------|---------------------|---------------------|</span></span>
<span id="cb67-302"><a href="#cb67-302" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Based on** <span class="pp">|</span> Pedigree records <span class="pp">|</span> SNP genotypes <span class="pp">|</span></span>
<span id="cb67-303"><a href="#cb67-303" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Relationship** <span class="pp">|</span> Expected (average) <span class="pp">|</span> Realized (actual) <span class="pp">|</span></span>
<span id="cb67-304"><a href="#cb67-304" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Full-sibs** <span class="pp">|</span> Always 0.50 <span class="pp">|</span> Varies (e.g., 0.47-0.53) <span class="pp">|</span></span>
<span id="cb67-305"><a href="#cb67-305" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Mendelian sampling** <span class="pp">|</span> Not captured <span class="pp">|</span> Captured <span class="pp">|</span></span>
<span id="cb67-306"><a href="#cb67-306" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Unknown pedigree** <span class="pp">|</span> Cannot calculate <span class="pp">|</span> Can still calculate <span class="pp">|</span></span>
<span id="cb67-307"><a href="#cb67-307" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Self-relationship** <span class="pp">|</span> 1.0 or 1 + F <span class="pp">|</span> Close to 1.0 (with adjustments) <span class="pp">|</span></span>
<span id="cb67-308"><a href="#cb67-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-309"><a href="#cb67-309" aria-hidden="true" tabindex="-1"></a>The beauty of G is that it captures **Mendelian sampling**—the random variation in which parental alleles are inherited by offspring. Even full-siblings don't share exactly 50% of their genome; some pairs share 48%, others 52%, due to random segregation and recombination. G captures this variation, making predictions more accurate.</span>
<span id="cb67-310"><a href="#cb67-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-311"><a href="#cb67-311" aria-hidden="true" tabindex="-1"></a><span class="fu">### Calculating G: VanRaden's Method</span></span>
<span id="cb67-312"><a href="#cb67-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-313"><a href="#cb67-313" aria-hidden="true" tabindex="-1"></a>Paul VanRaden (2008) proposed an efficient method for computing G from SNP genotypes. The formula is:</span>
<span id="cb67-314"><a href="#cb67-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-315"><a href="#cb67-315" aria-hidden="true" tabindex="-1"></a>$$G = \frac{(M - P)(M - P)'}{2 \sum_{j=1}^{m} p_j (1 - p_j)}$$</span>
<span id="cb67-316"><a href="#cb67-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-317"><a href="#cb67-317" aria-hidden="true" tabindex="-1"></a>Let's break down each component:</span>
<span id="cb67-318"><a href="#cb67-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-319"><a href="#cb67-319" aria-hidden="true" tabindex="-1"></a>**M** = Genotype matrix (n × m)</span>
<span id="cb67-320"><a href="#cb67-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-321"><a href="#cb67-321" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**n** = number of animals</span>
<span id="cb67-322"><a href="#cb67-322" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**m** = number of SNPs</span>
<span id="cb67-323"><a href="#cb67-323" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**M_ij** = genotype of animal *i* at SNP *j*, coded as:</span>
<span id="cb67-324"><a href="#cb67-324" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>0 = homozygous for allele 1 (e.g., AA)</span>
<span id="cb67-325"><a href="#cb67-325" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>1 = heterozygous (e.g., Aa)</span>
<span id="cb67-326"><a href="#cb67-326" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>2 = homozygous for allele 2 (e.g., aa)</span>
<span id="cb67-327"><a href="#cb67-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-328"><a href="#cb67-328" aria-hidden="true" tabindex="-1"></a>**P** = Matrix of expected genotypes under Hardy-Weinberg Equilibrium (HWE)</span>
<span id="cb67-329"><a href="#cb67-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-330"><a href="#cb67-330" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**P_ij** = $2p_j$, where $p_j$ is the frequency of allele 2 at SNP *j*</span>
<span id="cb67-331"><a href="#cb67-331" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>All animals in column *j* have the same value (the population mean genotype for that SNP)</span>
<span id="cb67-332"><a href="#cb67-332" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>P represents the "baseline" genotype expected if SNPs were at population allele frequencies</span>
<span id="cb67-333"><a href="#cb67-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-334"><a href="#cb67-334" aria-hidden="true" tabindex="-1"></a>**(M - P)** = Centered genotype matrix</span>
<span id="cb67-335"><a href="#cb67-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-336"><a href="#cb67-336" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Subtracts the population mean, so animals with more common alleles have values near zero</span>
<span id="cb67-337"><a href="#cb67-337" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>This centers the relationship matrix so the average relationship equals zero</span>
<span id="cb67-338"><a href="#cb67-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-339"><a href="#cb67-339" aria-hidden="true" tabindex="-1"></a>**$(M - P)(M - P)'$** = Cross-product matrix (n × n)</span>
<span id="cb67-340"><a href="#cb67-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-341"><a href="#cb67-341" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Element (i, i') is the sum of products of centered genotypes across all SNPs for animals *i* and *i'*</span>
<span id="cb67-342"><a href="#cb67-342" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Large values = animals share many alleles that deviate from the population mean (closely related)</span>
<span id="cb67-343"><a href="#cb67-343" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Small or negative values = animals have different allele combinations (distantly related)</span>
<span id="cb67-344"><a href="#cb67-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-345"><a href="#cb67-345" aria-hidden="true" tabindex="-1"></a>**Denominator: $2 \sum_{j=1}^{m} p_j (1 - p_j)$**</span>
<span id="cb67-346"><a href="#cb67-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-347"><a href="#cb67-347" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Sum of expected variance across all SNPs (under HWE)</span>
<span id="cb67-348"><a href="#cb67-348" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Scales G so the diagonal elements (self-relationships) are close to 1.0</span>
<span id="cb67-349"><a href="#cb67-349" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The factor of 2 accounts for diploid genomes</span>
<span id="cb67-350"><a href="#cb67-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-351"><a href="#cb67-351" aria-hidden="true" tabindex="-1"></a>**Interpretation of G**:</span>
<span id="cb67-352"><a href="#cb67-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-353"><a href="#cb67-353" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Diagonal elements** (G_ii): Self-relationship, typically near 1.0</span>
<span id="cb67-354"><a href="#cb67-354" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Can be &gt; 1 if the animal is more homozygous than expected (inbred)</span>
<span id="cb67-355"><a href="#cb67-355" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Can be &lt; 1 if more heterozygous than expected</span>
<span id="cb67-356"><a href="#cb67-356" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Off-diagonal elements** (G_ij): Relationship between animals *i* and *j*</span>
<span id="cb67-357"><a href="#cb67-357" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>G_ij = 0: Animals share genome at population average (unrelated)</span>
<span id="cb67-358"><a href="#cb67-358" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>G_ij = 0.50: Animals share ~50% of genome (parent-offspring or full-sibs, on average)</span>
<span id="cb67-359"><a href="#cb67-359" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>G_ij = 0.25: Animals share ~25% of genome (half-sibs or grandparent-grandchild, on average)</span>
<span id="cb67-360"><a href="#cb67-360" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>G_ij &lt; 0: Animals are less related than population average (have opposite alleles)</span>
<span id="cb67-361"><a href="#cb67-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-362"><a href="#cb67-362" aria-hidden="true" tabindex="-1"></a><span class="fu">### GBLUP Model</span></span>
<span id="cb67-363"><a href="#cb67-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-364"><a href="#cb67-364" aria-hidden="true" tabindex="-1"></a>The GBLUP model is identical in structure to traditional BLUP, except we use G instead of A for the covariance structure of breeding values.</span>
<span id="cb67-365"><a href="#cb67-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-366"><a href="#cb67-366" aria-hidden="true" tabindex="-1"></a>**Mixed model**:</span>
<span id="cb67-367"><a href="#cb67-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-368"><a href="#cb67-368" aria-hidden="true" tabindex="-1"></a>$$y = X\beta + Zu + e$$</span>
<span id="cb67-369"><a href="#cb67-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-370"><a href="#cb67-370" aria-hidden="true" tabindex="-1"></a>Where:</span>
<span id="cb67-371"><a href="#cb67-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-372"><a href="#cb67-372" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**y** = vector of phenotypes (or de-regressed EBVs)</span>
<span id="cb67-373"><a href="#cb67-373" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**X** = design matrix for fixed effects (contemporary groups, sex, etc.)</span>
<span id="cb67-374"><a href="#cb67-374" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**β** = vector of fixed effects</span>
<span id="cb67-375"><a href="#cb67-375" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Z** = incidence matrix linking animals to records</span>
<span id="cb67-376"><a href="#cb67-376" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**u** = vector of breeding values (random effects)</span>
<span id="cb67-377"><a href="#cb67-377" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**e** = vector of residual errors</span>
<span id="cb67-378"><a href="#cb67-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-379"><a href="#cb67-379" aria-hidden="true" tabindex="-1"></a>**Variance structure**:</span>
<span id="cb67-380"><a href="#cb67-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-381"><a href="#cb67-381" aria-hidden="true" tabindex="-1"></a>$$u \sim N(0, G\sigma^2_u)$$</span>
<span id="cb67-382"><a href="#cb67-382" aria-hidden="true" tabindex="-1"></a>$$e \sim N(0, I\sigma^2_e)$$</span>
<span id="cb67-383"><a href="#cb67-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-384"><a href="#cb67-384" aria-hidden="true" tabindex="-1"></a>Where:</span>
<span id="cb67-385"><a href="#cb67-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-386"><a href="#cb67-386" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**G** = genomic relationship matrix</span>
<span id="cb67-387"><a href="#cb67-387" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**$\sigma^2_u$** = additive genetic variance</span>
<span id="cb67-388"><a href="#cb67-388" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**I** = identity matrix</span>
<span id="cb67-389"><a href="#cb67-389" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**$\sigma^2_e$** = residual (error) variance</span>
<span id="cb67-390"><a href="#cb67-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-391"><a href="#cb67-391" aria-hidden="true" tabindex="-1"></a>The **mixed model equations** (MME) are:</span>
<span id="cb67-392"><a href="#cb67-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-393"><a href="#cb67-393" aria-hidden="true" tabindex="-1"></a>$$\begin{bmatrix} X'X &amp; X'Z <span class="sc">\\</span> Z'X &amp; Z'Z + G^{-1}\lambda \end{bmatrix} \begin{bmatrix} \hat{\beta} <span class="sc">\\</span> \hat{u} \end{bmatrix} = \begin{bmatrix} X'y <span class="sc">\\</span> Z'y \end{bmatrix}$$</span>
<span id="cb67-394"><a href="#cb67-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-395"><a href="#cb67-395" aria-hidden="true" tabindex="-1"></a>Where $\lambda = \sigma^2_e / \sigma^2_u$ (the variance ratio).</span>
<span id="cb67-396"><a href="#cb67-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-397"><a href="#cb67-397" aria-hidden="true" tabindex="-1"></a>Solving these equations gives us:</span>
<span id="cb67-398"><a href="#cb67-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-399"><a href="#cb67-399" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**$\hat{\beta}$** = estimates of fixed effects</span>
<span id="cb67-400"><a href="#cb67-400" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**$\hat{u}$** = GEBVs (genomic estimated breeding values)</span>
<span id="cb67-401"><a href="#cb67-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-402"><a href="#cb67-402" aria-hidden="true" tabindex="-1"></a>**Important note**: You don't need to solve MMEs by hand! Software packages (ASReml, BLUPF90, etc.) do this for you. The key concept is that GBLUP uses G instead of A, and this improves accuracy because G captures realized relationships.</span>
<span id="cb67-403"><a href="#cb67-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-404"><a href="#cb67-404" aria-hidden="true" tabindex="-1"></a><span class="fu">### Advantages of GBLUP</span></span>
<span id="cb67-405"><a href="#cb67-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-406"><a href="#cb67-406" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Captures Mendelian sampling**: G reflects actual genome sharing, not just expected relationships</span>
<span id="cb67-407"><a href="#cb67-407" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**High accuracy for young animals**: Animals with genotypes but no phenotypes can receive accurate GEBVs (r = 0.50-0.70) based on realized relationships with the training population</span>
<span id="cb67-408"><a href="#cb67-408" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Works with incomplete pedigrees**: G can be calculated even if pedigree is unknown (as long as genotypes are available)</span>
<span id="cb67-409"><a href="#cb67-409" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Computationally efficient**: For large datasets (n &gt; 10,000), GBLUP is faster than marker effects models</span>
<span id="cb67-410"><a href="#cb67-410" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**Widely implemented**: Standard method in dairy, beef, swine, poultry</span>
<span id="cb67-411"><a href="#cb67-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-412"><a href="#cb67-412" aria-hidden="true" tabindex="-1"></a><span class="fu">### Numerical Example: Calculating G</span></span>
<span id="cb67-413"><a href="#cb67-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-414"><a href="#cb67-414" aria-hidden="true" tabindex="-1"></a>Let's calculate the genomic relationship matrix for 5 animals genotyped at 6 SNPs (in reality, we'd use 50,000+ SNPs, but the principle is the same).</span>
<span id="cb67-415"><a href="#cb67-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-416"><a href="#cb67-416" aria-hidden="true" tabindex="-1"></a>**Step 1: Genotype data (M)**</span>
<span id="cb67-417"><a href="#cb67-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-418"><a href="#cb67-418" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Animal <span class="pp">|</span> SNP1 <span class="pp">|</span> SNP2 <span class="pp">|</span> SNP3 <span class="pp">|</span> SNP4 <span class="pp">|</span> SNP5 <span class="pp">|</span> SNP6 <span class="pp">|</span></span>
<span id="cb67-419"><a href="#cb67-419" aria-hidden="true" tabindex="-1"></a><span class="pp">|--------|------|------|------|------|------|------|</span></span>
<span id="cb67-420"><a href="#cb67-420" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 1      <span class="pp">|</span> 2    <span class="pp">|</span> 1    <span class="pp">|</span> 0    <span class="pp">|</span> 2    <span class="pp">|</span> 1    <span class="pp">|</span> 1    <span class="pp">|</span></span>
<span id="cb67-421"><a href="#cb67-421" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 2      <span class="pp">|</span> 1    <span class="pp">|</span> 2    <span class="pp">|</span> 1    <span class="pp">|</span> 1    <span class="pp">|</span> 0    <span class="pp">|</span> 2    <span class="pp">|</span></span>
<span id="cb67-422"><a href="#cb67-422" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 3      <span class="pp">|</span> 0    <span class="pp">|</span> 0    <span class="pp">|</span> 2    <span class="pp">|</span> 0    <span class="pp">|</span> 2    <span class="pp">|</span> 0    <span class="pp">|</span></span>
<span id="cb67-423"><a href="#cb67-423" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 4      <span class="pp">|</span> 2    <span class="pp">|</span> 1    <span class="pp">|</span> 1    <span class="pp">|</span> 2    <span class="pp">|</span> 1    <span class="pp">|</span> 1    <span class="pp">|</span></span>
<span id="cb67-424"><a href="#cb67-424" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 5      <span class="pp">|</span> 1    <span class="pp">|</span> 1    <span class="pp">|</span> 0    <span class="pp">|</span> 1    <span class="pp">|</span> 2    <span class="pp">|</span> 2    <span class="pp">|</span></span>
<span id="cb67-425"><a href="#cb67-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-426"><a href="#cb67-426" aria-hidden="true" tabindex="-1"></a>**Step 2: Calculate allele frequencies (p_j)**</span>
<span id="cb67-427"><a href="#cb67-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-428"><a href="#cb67-428" aria-hidden="true" tabindex="-1"></a>For SNP1: p_1 = (2+1+0+2+1) / (2×5) = 6/10 = 0.60</span>
<span id="cb67-429"><a href="#cb67-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-430"><a href="#cb67-430" aria-hidden="true" tabindex="-1"></a>Similarly:</span>
<span id="cb67-431"><a href="#cb67-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-432"><a href="#cb67-432" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>p_2 = 0.50</span>
<span id="cb67-433"><a href="#cb67-433" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>p_3 = 0.40</span>
<span id="cb67-434"><a href="#cb67-434" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>p_4 = 0.60</span>
<span id="cb67-435"><a href="#cb67-435" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>p_5 = 0.60</span>
<span id="cb67-436"><a href="#cb67-436" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>p_6 = 0.60</span>
<span id="cb67-437"><a href="#cb67-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-438"><a href="#cb67-438" aria-hidden="true" tabindex="-1"></a>**Step 3: Create P matrix (expected genotypes)**</span>
<span id="cb67-439"><a href="#cb67-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-440"><a href="#cb67-440" aria-hidden="true" tabindex="-1"></a>P has the same dimensions as M, but every element in column *j* is $2p_j$:</span>
<span id="cb67-441"><a href="#cb67-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-442"><a href="#cb67-442" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Animal <span class="pp">|</span> SNP1 <span class="pp">|</span> SNP2 <span class="pp">|</span> SNP3 <span class="pp">|</span> SNP4 <span class="pp">|</span> SNP5 <span class="pp">|</span> SNP6 <span class="pp">|</span></span>
<span id="cb67-443"><a href="#cb67-443" aria-hidden="true" tabindex="-1"></a><span class="pp">|--------|------|------|------|------|------|------|</span></span>
<span id="cb67-444"><a href="#cb67-444" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 1      <span class="pp">|</span> 1.2  <span class="pp">|</span> 1.0  <span class="pp">|</span> 0.8  <span class="pp">|</span> 1.2  <span class="pp">|</span> 1.2  <span class="pp">|</span> 1.2  <span class="pp">|</span></span>
<span id="cb67-445"><a href="#cb67-445" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 2      <span class="pp">|</span> 1.2  <span class="pp">|</span> 1.0  <span class="pp">|</span> 0.8  <span class="pp">|</span> 1.2  <span class="pp">|</span> 1.2  <span class="pp">|</span> 1.2  <span class="pp">|</span></span>
<span id="cb67-446"><a href="#cb67-446" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 3      <span class="pp">|</span> 1.2  <span class="pp">|</span> 1.0  <span class="pp">|</span> 0.8  <span class="pp">|</span> 1.2  <span class="pp">|</span> 1.2  <span class="pp">|</span> 1.2  <span class="pp">|</span></span>
<span id="cb67-447"><a href="#cb67-447" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 4      <span class="pp">|</span> 1.2  <span class="pp">|</span> 1.0  <span class="pp">|</span> 0.8  <span class="pp">|</span> 1.2  <span class="pp">|</span> 1.2  <span class="pp">|</span> 1.2  <span class="pp">|</span></span>
<span id="cb67-448"><a href="#cb67-448" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 5      <span class="pp">|</span> 1.2  <span class="pp">|</span> 1.0  <span class="pp">|</span> 0.8  <span class="pp">|</span> 1.2  <span class="pp">|</span> 1.2  <span class="pp">|</span> 1.2  <span class="pp">|</span></span>
<span id="cb67-449"><a href="#cb67-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-450"><a href="#cb67-450" aria-hidden="true" tabindex="-1"></a>**Step 4: Compute (M - P)** (centered genotypes)</span>
<span id="cb67-451"><a href="#cb67-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-452"><a href="#cb67-452" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Animal <span class="pp">|</span> SNP1  <span class="pp">|</span> SNP2  <span class="pp">|</span> SNP3  <span class="pp">|</span> SNP4  <span class="pp">|</span> SNP5  <span class="pp">|</span> SNP6  <span class="pp">|</span></span>
<span id="cb67-453"><a href="#cb67-453" aria-hidden="true" tabindex="-1"></a><span class="pp">|--------|-------|-------|-------|-------|-------|-------|</span></span>
<span id="cb67-454"><a href="#cb67-454" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 1      <span class="pp">|</span>  0.8  <span class="pp">|</span>  0.0  <span class="pp">|</span> -0.8  <span class="pp">|</span>  0.8  <span class="pp">|</span> -0.2  <span class="pp">|</span> -0.2  <span class="pp">|</span></span>
<span id="cb67-455"><a href="#cb67-455" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 2      <span class="pp">|</span> -0.2  <span class="pp">|</span>  1.0  <span class="pp">|</span>  0.2  <span class="pp">|</span> -0.2  <span class="pp">|</span> -1.2  <span class="pp">|</span>  0.8  <span class="pp">|</span></span>
<span id="cb67-456"><a href="#cb67-456" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 3      <span class="pp">|</span> -1.2  <span class="pp">|</span> -1.0  <span class="pp">|</span>  1.2  <span class="pp">|</span> -1.2  <span class="pp">|</span>  0.8  <span class="pp">|</span> -1.2  <span class="pp">|</span></span>
<span id="cb67-457"><a href="#cb67-457" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 4      <span class="pp">|</span>  0.8  <span class="pp">|</span>  0.0  <span class="pp">|</span>  0.2  <span class="pp">|</span>  0.8  <span class="pp">|</span> -0.2  <span class="pp">|</span> -0.2  <span class="pp">|</span></span>
<span id="cb67-458"><a href="#cb67-458" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 5      <span class="pp">|</span> -0.2  <span class="pp">|</span>  0.0  <span class="pp">|</span> -0.8  <span class="pp">|</span> -0.2  <span class="pp">|</span>  0.8  <span class="pp">|</span>  0.8  <span class="pp">|</span></span>
<span id="cb67-459"><a href="#cb67-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-460"><a href="#cb67-460" aria-hidden="true" tabindex="-1"></a>**Step 5: Compute $(M-P)(M-P)'$**</span>
<span id="cb67-461"><a href="#cb67-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-462"><a href="#cb67-462" aria-hidden="true" tabindex="-1"></a>This is a 5×5 matrix. For example, element (1,1) is:</span>
<span id="cb67-463"><a href="#cb67-463" aria-hidden="true" tabindex="-1"></a>$$(0.8)^2 + (0.0)^2 + (-0.8)^2 + (0.8)^2 + (-0.2)^2 + (-0.2)^2 = 0.64 + 0 + 0.64 + 0.64 + 0.04 + 0.04 = 2.00$$</span>
<span id="cb67-464"><a href="#cb67-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-465"><a href="#cb67-465" aria-hidden="true" tabindex="-1"></a>Element (1,2) is:</span>
<span id="cb67-466"><a href="#cb67-466" aria-hidden="true" tabindex="-1"></a>$$(0.8)(-0.2) + (0.0)(1.0) + (-0.8)(0.2) + (0.8)(-0.2) + (-0.2)(-1.2) + (-0.2)(0.8)$$</span>
<span id="cb67-467"><a href="#cb67-467" aria-hidden="true" tabindex="-1"></a>$$= -0.16 + 0 - 0.16 - 0.16 + 0.24 - 0.16 = -0.40$$</span>
<span id="cb67-468"><a href="#cb67-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-469"><a href="#cb67-469" aria-hidden="true" tabindex="-1"></a>Completing all calculations (we'll use R in the next section for this!):</span>
<span id="cb67-470"><a href="#cb67-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-471"><a href="#cb67-471" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb67-472"><a href="#cb67-472" aria-hidden="true" tabindex="-1"></a>(M-P)(M-P)' = \begin{bmatrix}</span>
<span id="cb67-473"><a href="#cb67-473" aria-hidden="true" tabindex="-1"></a>2.00 &amp; -0.40 &amp; -1.60 &amp; 1.60 &amp; -0.40 <span class="sc">\\</span></span>
<span id="cb67-474"><a href="#cb67-474" aria-hidden="true" tabindex="-1"></a>-0.40 &amp; 3.60 &amp; -1.60 &amp; -0.40 &amp; 0.80 <span class="sc">\\</span></span>
<span id="cb67-475"><a href="#cb67-475" aria-hidden="true" tabindex="-1"></a>-1.60 &amp; -1.60 &amp; 6.00 &amp; -1.20 &amp; -1.20 <span class="sc">\\</span></span>
<span id="cb67-476"><a href="#cb67-476" aria-hidden="true" tabindex="-1"></a>1.60 &amp; -0.40 &amp; -1.20 &amp; 2.00 &amp; -0.40 <span class="sc">\\</span></span>
<span id="cb67-477"><a href="#cb67-477" aria-hidden="true" tabindex="-1"></a>-0.40 &amp; 0.80 &amp; -1.20 &amp; -0.40 &amp; 2.00 <span class="sc">\\</span></span>
<span id="cb67-478"><a href="#cb67-478" aria-hidden="true" tabindex="-1"></a>\end{bmatrix}</span>
<span id="cb67-479"><a href="#cb67-479" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb67-480"><a href="#cb67-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-481"><a href="#cb67-481" aria-hidden="true" tabindex="-1"></a>**Step 6: Calculate denominator**</span>
<span id="cb67-482"><a href="#cb67-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-483"><a href="#cb67-483" aria-hidden="true" tabindex="-1"></a>$$2\sum_{j=1}^{6} p_j(1-p_j) = 2<span class="co">[</span><span class="ot">0.6(0.4) + 0.5(0.5) + 0.4(0.6) + 0.6(0.4) + 0.6(0.4) + 0.6(0.4)</span><span class="co">]</span>$$</span>
<span id="cb67-484"><a href="#cb67-484" aria-hidden="true" tabindex="-1"></a>$$= 2<span class="co">[</span><span class="ot">0.24 + 0.25 + 0.24 + 0.24 + 0.24 + 0.24</span><span class="co">]</span> = 2(1.45) = 2.90$$</span>
<span id="cb67-485"><a href="#cb67-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-486"><a href="#cb67-486" aria-hidden="true" tabindex="-1"></a>**Step 7: Compute G = $(M-P)(M-P)' / 2.90$**</span>
<span id="cb67-487"><a href="#cb67-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-488"><a href="#cb67-488" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb67-489"><a href="#cb67-489" aria-hidden="true" tabindex="-1"></a>G = \begin{bmatrix}</span>
<span id="cb67-490"><a href="#cb67-490" aria-hidden="true" tabindex="-1"></a>0.69 &amp; -0.14 &amp; -0.55 &amp; 0.55 &amp; -0.14 <span class="sc">\\</span></span>
<span id="cb67-491"><a href="#cb67-491" aria-hidden="true" tabindex="-1"></a>-0.14 &amp; 1.24 &amp; -0.55 &amp; -0.14 &amp; 0.28 <span class="sc">\\</span></span>
<span id="cb67-492"><a href="#cb67-492" aria-hidden="true" tabindex="-1"></a>-0.55 &amp; -0.55 &amp; 2.07 &amp; -0.41 &amp; -0.41 <span class="sc">\\</span></span>
<span id="cb67-493"><a href="#cb67-493" aria-hidden="true" tabindex="-1"></a>0.55 &amp; -0.14 &amp; -0.41 &amp; 0.69 &amp; -0.14 <span class="sc">\\</span></span>
<span id="cb67-494"><a href="#cb67-494" aria-hidden="true" tabindex="-1"></a>-0.14 &amp; 0.28 &amp; -0.41 &amp; -0.14 &amp; 0.69 <span class="sc">\\</span></span>
<span id="cb67-495"><a href="#cb67-495" aria-hidden="true" tabindex="-1"></a>\end{bmatrix}</span>
<span id="cb67-496"><a href="#cb67-496" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb67-497"><a href="#cb67-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-498"><a href="#cb67-498" aria-hidden="true" tabindex="-1"></a>**Interpretation**:</span>
<span id="cb67-499"><a href="#cb67-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-500"><a href="#cb67-500" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Animal 1 and Animal 4**: G_14 = 0.55 (closely related, share ~55% of genome above population average—possibly parent-offspring or full-sibs)</span>
<span id="cb67-501"><a href="#cb67-501" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Animal 1 and Animal 3**: G_13 = -0.55 (distantly related, share fewer alleles than population average)</span>
<span id="cb67-502"><a href="#cb67-502" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Animal 3**: G_33 = 2.07 (more homozygous than expected, or has unusual allele composition)</span>
<span id="cb67-503"><a href="#cb67-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-504"><a href="#cb67-504" aria-hidden="true" tabindex="-1"></a>In practice, we'd use thousands of SNPs, which stabilizes these estimates. With only 6 SNPs, sampling variation is high.</span>
<span id="cb67-505"><a href="#cb67-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-506"><a href="#cb67-506" aria-hidden="true" tabindex="-1"></a>Next, we'll implement this in R with a more realistic example.</span>
<span id="cb67-507"><a href="#cb67-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-508"><a href="#cb67-508" aria-hidden="true" tabindex="-1"></a><span class="fu">### R Demonstration: Computing and Visualizing G</span></span>
<span id="cb67-509"><a href="#cb67-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-510"><a href="#cb67-510" aria-hidden="true" tabindex="-1"></a>Let's calculate the genomic relationship matrix using real-scale data (10 animals, 1000 SNPs) and visualize the relationships.</span>
<span id="cb67-511"><a href="#cb67-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-514"><a href="#cb67-514" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-515"><a href="#cb67-515" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb67-516"><a href="#cb67-516" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb67-517"><a href="#cb67-517" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb67-518"><a href="#cb67-518" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.width: 10</span></span>
<span id="cb67-519"><a href="#cb67-519" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.height: 4</span></span>
<span id="cb67-520"><a href="#cb67-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-521"><a href="#cb67-521" aria-hidden="true" tabindex="-1"></a><span class="co"># Load required packages</span></span>
<span id="cb67-522"><a href="#cb67-522" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb67-523"><a href="#cb67-523" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)  <span class="co"># For melting matrix for heatmap</span></span>
<span id="cb67-524"><a href="#cb67-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-525"><a href="#cb67-525" aria-hidden="true" tabindex="-1"></a><span class="co"># Set seed for reproducibility</span></span>
<span id="cb67-526"><a href="#cb67-526" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb67-527"><a href="#cb67-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-528"><a href="#cb67-528" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate genotype data</span></span>
<span id="cb67-529"><a href="#cb67-529" aria-hidden="true" tabindex="-1"></a>n_animals <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb67-530"><a href="#cb67-530" aria-hidden="true" tabindex="-1"></a>n_snps <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb67-531"><a href="#cb67-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-532"><a href="#cb67-532" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate genotypes (0, 1, or 2) with realistic allele frequencies</span></span>
<span id="cb67-533"><a href="#cb67-533" aria-hidden="true" tabindex="-1"></a><span class="co"># Most SNPs have intermediate allele frequencies (MAF &gt; 0.05)</span></span>
<span id="cb67-534"><a href="#cb67-534" aria-hidden="true" tabindex="-1"></a>allele_freqs <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_snps, <span class="at">min =</span> <span class="fl">0.2</span>, <span class="at">max =</span> <span class="fl">0.8</span>)</span>
<span id="cb67-535"><a href="#cb67-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-536"><a href="#cb67-536" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate genotype matrix M (n_animals × n_snps)</span></span>
<span id="cb67-537"><a href="#cb67-537" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> n_animals, <span class="at">ncol =</span> n_snps)</span>
<span id="cb67-538"><a href="#cb67-538" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_snps) {</span>
<span id="cb67-539"><a href="#cb67-539" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> allele_freqs[j]</span>
<span id="cb67-540"><a href="#cb67-540" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Genotypes follow HWE: P(0) = (1-p)^2, P(1) = 2p(1-p), P(2) = p^2</span></span>
<span id="cb67-541"><a href="#cb67-541" aria-hidden="true" tabindex="-1"></a>  M[, j] <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">size =</span> n_animals, <span class="at">replace =</span> <span class="cn">TRUE</span>,</span>
<span id="cb67-542"><a href="#cb67-542" aria-hidden="true" tabindex="-1"></a>                   <span class="at">prob =</span> <span class="fu">c</span>((<span class="dv">1</span><span class="sc">-</span>p)<span class="sc">^</span><span class="dv">2</span>, <span class="dv">2</span><span class="sc">*</span>p<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p), p<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb67-543"><a href="#cb67-543" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb67-544"><a href="#cb67-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-545"><a href="#cb67-545" aria-hidden="true" tabindex="-1"></a><span class="co"># Add animal names</span></span>
<span id="cb67-546"><a href="#cb67-546" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(M) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Animal_"</span>, <span class="dv">1</span><span class="sc">:</span>n_animals)</span>
<span id="cb67-547"><a href="#cb67-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-548"><a href="#cb67-548" aria-hidden="true" tabindex="-1"></a><span class="co"># Display first 6 SNPs for first 5 animals</span></span>
<span id="cb67-549"><a href="#cb67-549" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Genotype matrix M (first 5 animals, first 6 SNPs):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb67-550"><a href="#cb67-550" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(M[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>])</span>
<span id="cb67-551"><a href="#cb67-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-552"><a href="#cb67-552" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Calculate allele frequencies from the data</span></span>
<span id="cb67-553"><a href="#cb67-553" aria-hidden="true" tabindex="-1"></a><span class="co"># (In practice, these might be from a larger reference population)</span></span>
<span id="cb67-554"><a href="#cb67-554" aria-hidden="true" tabindex="-1"></a>p_j <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(M) <span class="sc">/</span> <span class="dv">2</span>  <span class="co"># Allele frequency at each SNP</span></span>
<span id="cb67-555"><a href="#cb67-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-556"><a href="#cb67-556" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">First 10 allele frequencies:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb67-557"><a href="#cb67-557" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(p_j[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>], <span class="dv">3</span>))</span>
<span id="cb67-558"><a href="#cb67-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-559"><a href="#cb67-559" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Create P matrix (expected genotypes = 2 * p_j)</span></span>
<span id="cb67-560"><a href="#cb67-560" aria-hidden="true" tabindex="-1"></a>P <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="dv">2</span> <span class="sc">*</span> p_j, <span class="at">each =</span> n_animals), <span class="at">nrow =</span> n_animals, <span class="at">ncol =</span> n_snps,</span>
<span id="cb67-561"><a href="#cb67-561" aria-hidden="true" tabindex="-1"></a>            <span class="at">byrow =</span> <span class="cn">FALSE</span>)</span>
<span id="cb67-562"><a href="#cb67-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-563"><a href="#cb67-563" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Center genotypes (M - P)</span></span>
<span id="cb67-564"><a href="#cb67-564" aria-hidden="true" tabindex="-1"></a>Z <span class="ot">&lt;-</span> M <span class="sc">-</span> P</span>
<span id="cb67-565"><a href="#cb67-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-566"><a href="#cb67-566" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Centered genotypes Z (first 5 animals, first 6 SNPs):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb67-567"><a href="#cb67-567" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(Z[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>], <span class="dv">2</span>))</span>
<span id="cb67-568"><a href="#cb67-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-569"><a href="#cb67-569" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Calculate cross-product Z %*% t(Z)</span></span>
<span id="cb67-570"><a href="#cb67-570" aria-hidden="true" tabindex="-1"></a>ZZt <span class="ot">&lt;-</span> Z <span class="sc">%*%</span> <span class="fu">t</span>(Z)</span>
<span id="cb67-571"><a href="#cb67-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-572"><a href="#cb67-572" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Calculate denominator: 2 * sum(p_j * (1 - p_j))</span></span>
<span id="cb67-573"><a href="#cb67-573" aria-hidden="true" tabindex="-1"></a>denom <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">sum</span>(p_j <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p_j))</span>
<span id="cb67-574"><a href="#cb67-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-575"><a href="#cb67-575" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Denominator: 2 * sum(p_j * (1 - p_j)) ="</span>, <span class="fu">round</span>(denom, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb67-576"><a href="#cb67-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-577"><a href="#cb67-577" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 6: Compute G matrix</span></span>
<span id="cb67-578"><a href="#cb67-578" aria-hidden="true" tabindex="-1"></a>G <span class="ot">&lt;-</span> ZZt <span class="sc">/</span> denom</span>
<span id="cb67-579"><a href="#cb67-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-580"><a href="#cb67-580" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Genomic relationship matrix G:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb67-581"><a href="#cb67-581" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(G, <span class="dv">3</span>))</span>
<span id="cb67-582"><a href="#cb67-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-583"><a href="#cb67-583" aria-hidden="true" tabindex="-1"></a><span class="co"># Check diagonal elements (should be close to 1)</span></span>
<span id="cb67-584"><a href="#cb67-584" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Diagonal elements (self-relationships):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb67-585"><a href="#cb67-585" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(<span class="fu">diag</span>(G), <span class="dv">3</span>))</span>
<span id="cb67-586"><a href="#cb67-586" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Mean diagonal:"</span>, <span class="fu">round</span>(<span class="fu">mean</span>(<span class="fu">diag</span>(G)), <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb67-587"><a href="#cb67-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-588"><a href="#cb67-588" aria-hidden="true" tabindex="-1"></a><span class="co"># Check off-diagonal range</span></span>
<span id="cb67-589"><a href="#cb67-589" aria-hidden="true" tabindex="-1"></a>off_diag <span class="ot">&lt;-</span> G[<span class="fu">lower.tri</span>(G)]</span>
<span id="cb67-590"><a href="#cb67-590" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Off-diagonal relationships:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb67-591"><a href="#cb67-591" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Range:"</span>, <span class="fu">round</span>(<span class="fu">min</span>(off_diag), <span class="dv">3</span>), <span class="st">"to"</span>, <span class="fu">round</span>(<span class="fu">max</span>(off_diag), <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb67-592"><a href="#cb67-592" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"  Mean:"</span>, <span class="fu">round</span>(<span class="fu">mean</span>(off_diag), <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb67-593"><a href="#cb67-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-594"><a href="#cb67-594" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize G matrix as heatmap</span></span>
<span id="cb67-595"><a href="#cb67-595" aria-hidden="true" tabindex="-1"></a>G_melted <span class="ot">&lt;-</span> <span class="fu">melt</span>(G)</span>
<span id="cb67-596"><a href="#cb67-596" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(G_melted) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Animal_1"</span>, <span class="st">"Animal_2"</span>, <span class="st">"Relationship"</span>)</span>
<span id="cb67-597"><a href="#cb67-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-598"><a href="#cb67-598" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(G_melted, <span class="fu">aes</span>(<span class="at">x =</span> Animal_1, <span class="at">y =</span> Animal_2, <span class="at">fill =</span> Relationship)) <span class="sc">+</span></span>
<span id="cb67-599"><a href="#cb67-599" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb67-600"><a href="#cb67-600" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">mid =</span> <span class="st">"white"</span>, <span class="at">high =</span> <span class="st">"red"</span>, <span class="at">midpoint =</span> <span class="dv">0</span>,</span>
<span id="cb67-601"><a href="#cb67-601" aria-hidden="true" tabindex="-1"></a>                       <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">1.5</span>), <span class="at">name =</span> <span class="st">"G"</span>) <span class="sc">+</span></span>
<span id="cb67-602"><a href="#cb67-602" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Genomic Relationship Matrix (G)"</span>,</span>
<span id="cb67-603"><a href="#cb67-603" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Heatmap showing realized relationships among 10 animals"</span>,</span>
<span id="cb67-604"><a href="#cb67-604" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Animal"</span>, <span class="at">y =</span> <span class="st">"Animal"</span>) <span class="sc">+</span></span>
<span id="cb67-605"><a href="#cb67-605" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">11</span>) <span class="sc">+</span></span>
<span id="cb67-606"><a href="#cb67-606" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb67-607"><a href="#cb67-607" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span>
<span id="cb67-608"><a href="#cb67-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-609"><a href="#cb67-609" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p1)</span>
<span id="cb67-610"><a href="#cb67-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-611"><a href="#cb67-611" aria-hidden="true" tabindex="-1"></a><span class="co"># Distribution of off-diagonal relationships</span></span>
<span id="cb67-612"><a href="#cb67-612" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">Relationship =</span> off_diag), <span class="fu">aes</span>(<span class="at">x =</span> Relationship)) <span class="sc">+</span></span>
<span id="cb67-613"><a href="#cb67-613" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">20</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb67-614"><a href="#cb67-614" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb67-615"><a href="#cb67-615" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Off-Diagonal Relationships"</span>,</span>
<span id="cb67-616"><a href="#cb67-616" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Most animals are unrelated (near 0), some are closely related"</span>,</span>
<span id="cb67-617"><a href="#cb67-617" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Genomic Relationship (G_ij)"</span>, <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb67-618"><a href="#cb67-618" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">11</span>)</span>
<span id="cb67-619"><a href="#cb67-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-620"><a href="#cb67-620" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p2)</span>
<span id="cb67-621"><a href="#cb67-621" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-622"><a href="#cb67-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-623"><a href="#cb67-623" aria-hidden="true" tabindex="-1"></a>**Key observations from the G matrix:**</span>
<span id="cb67-624"><a href="#cb67-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-625"><a href="#cb67-625" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Diagonal elements** average close to 1.0, indicating animals are as homozygous as expected on average</span>
<span id="cb67-626"><a href="#cb67-626" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Off-diagonal elements** show variation in relationships:</span>
<span id="cb67-627"><a href="#cb67-627" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Values near 0 indicate unrelated animals</span>
<span id="cb67-628"><a href="#cb67-628" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Positive values indicate animals share more alleles than average (related)</span>
<span id="cb67-629"><a href="#cb67-629" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Negative values indicate animals have complementary allele sets (less related than random)</span>
<span id="cb67-630"><a href="#cb67-630" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**With 1000 SNPs**, the G matrix estimates are reasonably stable, though more SNPs (50K+) would provide even better precision</span>
<span id="cb67-631"><a href="#cb67-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-632"><a href="#cb67-632" aria-hidden="true" tabindex="-1"></a>This G matrix could now be used in GBLUP to estimate genomic breeding values for these animals.</span>
<span id="cb67-633"><a href="#cb67-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-634"><a href="#cb67-634" aria-hidden="true" tabindex="-1"></a><span class="fu">## SNP-BLUP and Marker Effects Models</span></span>
<span id="cb67-635"><a href="#cb67-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-636"><a href="#cb67-636" aria-hidden="true" tabindex="-1"></a>While GBLUP estimates breeding values directly using the genomic relationship matrix, **marker effects models** estimate the effect of each individual SNP. This approach provides explicit information about which genomic regions contribute to genetic variation—useful for understanding the genetic architecture of traits and for identifying candidate genes.</span>
<span id="cb67-637"><a href="#cb67-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-638"><a href="#cb67-638" aria-hidden="true" tabindex="-1"></a><span class="fu">### SNP-BLUP</span></span>
<span id="cb67-639"><a href="#cb67-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-640"><a href="#cb67-640" aria-hidden="true" tabindex="-1"></a>**SNP-BLUP** is the marker effects equivalent of GBLUP. Instead of estimating *n* breeding values (one per animal), we estimate *m* SNP effects (one per SNP, where *m* might be 50,000 or more).</span>
<span id="cb67-641"><a href="#cb67-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-642"><a href="#cb67-642" aria-hidden="true" tabindex="-1"></a>**Model**:</span>
<span id="cb67-643"><a href="#cb67-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-644"><a href="#cb67-644" aria-hidden="true" tabindex="-1"></a>$$y = X\alpha + M\beta + e$$</span>
<span id="cb67-645"><a href="#cb67-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-646"><a href="#cb67-646" aria-hidden="true" tabindex="-1"></a>Where:</span>
<span id="cb67-647"><a href="#cb67-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-648"><a href="#cb67-648" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**y** = vector of phenotypes (n × 1)</span>
<span id="cb67-649"><a href="#cb67-649" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**X** = design matrix for fixed effects</span>
<span id="cb67-650"><a href="#cb67-650" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**α** = vector of fixed effects</span>
<span id="cb67-651"><a href="#cb67-651" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**M** = centered genotype matrix (n × m), where M_ij = x_ij - 2p_j</span>
<span id="cb67-652"><a href="#cb67-652" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**β** = vector of SNP effects (m × 1)</span>
<span id="cb67-653"><a href="#cb67-653" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**e** = vector of residuals</span>
<span id="cb67-654"><a href="#cb67-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-655"><a href="#cb67-655" aria-hidden="true" tabindex="-1"></a>**Assumptions**:</span>
<span id="cb67-656"><a href="#cb67-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-657"><a href="#cb67-657" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>SNP effects are random: $\beta_j \sim N(0, \sigma^2_\beta)$</span>
<span id="cb67-658"><a href="#cb67-658" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>All SNPs have **equal variance** $\sigma^2_\beta$</span>
<span id="cb67-659"><a href="#cb67-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-660"><a href="#cb67-660" aria-hidden="true" tabindex="-1"></a>This equal-variance assumption is key: SNP-BLUP treats all SNPs as contributing equally (on average) to genetic variation.</span>
<span id="cb67-661"><a href="#cb67-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-662"><a href="#cb67-662" aria-hidden="true" tabindex="-1"></a>**Estimating SNP effects**: We solve for $\hat{\beta}$ using ridge regression (penalized regression) or mixed model equations. The penalty shrinks small effects toward zero, preventing overfitting.</span>
<span id="cb67-663"><a href="#cb67-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-664"><a href="#cb67-664" aria-hidden="true" tabindex="-1"></a>**Computing GEBVs from SNP effects**:</span>
<span id="cb67-665"><a href="#cb67-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-666"><a href="#cb67-666" aria-hidden="true" tabindex="-1"></a>Once we have estimated SNP effects $\hat{\beta}$, we calculate each animal's GEBV by summing the contributions of all SNPs:</span>
<span id="cb67-667"><a href="#cb67-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-668"><a href="#cb67-668" aria-hidden="true" tabindex="-1"></a>$$GEBV_i = \sum_{j=1}^{m} (x_{ij} - 2p_j) \hat{\beta}_j$$</span>
<span id="cb67-669"><a href="#cb67-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-670"><a href="#cb67-670" aria-hidden="true" tabindex="-1"></a>Or in matrix notation:</span>
<span id="cb67-671"><a href="#cb67-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-672"><a href="#cb67-672" aria-hidden="true" tabindex="-1"></a>$$GEBV = M\hat{\beta}$$</span>
<span id="cb67-673"><a href="#cb67-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-674"><a href="#cb67-674" aria-hidden="true" tabindex="-1"></a>Where **M** is the centered genotype matrix.</span>
<span id="cb67-675"><a href="#cb67-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-676"><a href="#cb67-676" aria-hidden="true" tabindex="-1"></a>**Example**:</span>
<span id="cb67-677"><a href="#cb67-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-678"><a href="#cb67-678" aria-hidden="true" tabindex="-1"></a>Suppose we've estimated SNP effects for 3 SNPs:</span>
<span id="cb67-679"><a href="#cb67-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-680"><a href="#cb67-680" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\hat{\beta}_1 = +0.15$ kg (increases milk yield)</span>
<span id="cb67-681"><a href="#cb67-681" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\hat{\beta}_2 = -0.08$ kg (decreases milk yield)</span>
<span id="cb67-682"><a href="#cb67-682" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\hat{\beta}_3 = +0.22$ kg (increases milk yield)</span>
<span id="cb67-683"><a href="#cb67-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-684"><a href="#cb67-684" aria-hidden="true" tabindex="-1"></a>And Animal A has centered genotypes:</span>
<span id="cb67-685"><a href="#cb67-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-686"><a href="#cb67-686" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>SNP 1: $(x_{A1} - 2p_1) = 2 - 2(0.5) = 1.0$</span>
<span id="cb67-687"><a href="#cb67-687" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>SNP 2: $(x_{A2} - 2p_2) = 0 - 2(0.3) = -0.6$</span>
<span id="cb67-688"><a href="#cb67-688" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>SNP 3: $(x_{A3} - 2p_3) = 1 - 2(0.6) = -0.2$</span>
<span id="cb67-689"><a href="#cb67-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-690"><a href="#cb67-690" aria-hidden="true" tabindex="-1"></a>Then:</span>
<span id="cb67-691"><a href="#cb67-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-692"><a href="#cb67-692" aria-hidden="true" tabindex="-1"></a>$$GEBV_A = (1.0)(0.15) + (-0.6)(-0.08) + (-0.2)(0.22) = 0.15 + 0.048 - 0.044 = 0.154 \text{ kg}$$</span>
<span id="cb67-693"><a href="#cb67-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-694"><a href="#cb67-694" aria-hidden="true" tabindex="-1"></a>Animal A's GEBV is +0.154 kg above the population mean for milk yield.</span>
<span id="cb67-695"><a href="#cb67-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-696"><a href="#cb67-696" aria-hidden="true" tabindex="-1"></a><span class="fu">### Equivalence of GBLUP and SNP-BLUP</span></span>
<span id="cb67-697"><a href="#cb67-697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-698"><a href="#cb67-698" aria-hidden="true" tabindex="-1"></a>Here's a remarkable mathematical result: Under certain conditions, **GBLUP and SNP-BLUP produce identical GEBVs**. They are different parameterizations of the same underlying model.</span>
<span id="cb67-699"><a href="#cb67-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-700"><a href="#cb67-700" aria-hidden="true" tabindex="-1"></a>**When they are equivalent**:</span>
<span id="cb67-701"><a href="#cb67-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-702"><a href="#cb67-702" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>All SNPs have equal variance (the SNP-BLUP assumption)</span>
<span id="cb67-703"><a href="#cb67-703" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>The genomic relationship matrix is computed as $G = \frac{MM'}{2\sum p_j(1-p_j)}$ (VanRaden's method)</span>
<span id="cb67-704"><a href="#cb67-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-705"><a href="#cb67-705" aria-hidden="true" tabindex="-1"></a>Under these conditions:</span>
<span id="cb67-706"><a href="#cb67-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-707"><a href="#cb67-707" aria-hidden="true" tabindex="-1"></a>$$GEBV_{GBLUP} = GEBV_{SNP-BLUP}$$</span>
<span id="cb67-708"><a href="#cb67-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-709"><a href="#cb67-709" aria-hidden="true" tabindex="-1"></a>**Why this equivalence matters**:</span>
<span id="cb67-710"><a href="#cb67-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-711"><a href="#cb67-711" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Computational flexibility**: Choose the approach that's faster for your dataset</span>
<span id="cb67-712"><a href="#cb67-712" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>GBLUP: Faster when n (animals) &lt; m (SNPs)—invert an n × n matrix (G) instead of solving m equations</span>
<span id="cb67-713"><a href="#cb67-713" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>SNP-BLUP: Faster when m &lt; n (rare in livestock, but possible with low-density panels)</span>
<span id="cb67-714"><a href="#cb67-714" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Interpretability**: SNP-BLUP provides explicit SNP effects (useful for genomic architecture studies), while GBLUP is a "black box"</span>
<span id="cb67-715"><a href="#cb67-715" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Extensions**: SNP-BLUP framework allows relaxing the equal-variance assumption (Bayesian methods)</span>
<span id="cb67-716"><a href="#cb67-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-717"><a href="#cb67-717" aria-hidden="true" tabindex="-1"></a>**Mathematical connection**:</span>
<span id="cb67-718"><a href="#cb67-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-719"><a href="#cb67-719" aria-hidden="true" tabindex="-1"></a>The relationship between breeding values (u) and SNP effects (β) is:</span>
<span id="cb67-720"><a href="#cb67-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-721"><a href="#cb67-721" aria-hidden="true" tabindex="-1"></a>$$u = M\beta$$</span>
<span id="cb67-722"><a href="#cb67-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-723"><a href="#cb67-723" aria-hidden="true" tabindex="-1"></a>And:</span>
<span id="cb67-724"><a href="#cb67-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-725"><a href="#cb67-725" aria-hidden="true" tabindex="-1"></a>$$G = \frac{MM'}{2\sum p_j(1-p_j)} \propto MM'$$</span>
<span id="cb67-726"><a href="#cb67-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-727"><a href="#cb67-727" aria-hidden="true" tabindex="-1"></a>So breeding values are linear combinations of SNP effects, and genomic relationships are determined by the similarity of SNP genotype patterns.</span>
<span id="cb67-728"><a href="#cb67-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-729"><a href="#cb67-729" aria-hidden="true" tabindex="-1"></a><span class="fu">### When to Use SNP-BLUP vs. GBLUP</span></span>
<span id="cb67-730"><a href="#cb67-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-731"><a href="#cb67-731" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Situation <span class="pp">|</span> Best Approach <span class="pp">|</span> Reason <span class="pp">|</span></span>
<span id="cb67-732"><a href="#cb67-732" aria-hidden="true" tabindex="-1"></a><span class="pp">|-----------|---------------|--------|</span></span>
<span id="cb67-733"><a href="#cb67-733" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Standard genomic evaluation (50K SNPs, 10,000+ animals) <span class="pp">|</span> GBLUP <span class="pp">|</span> Faster computation <span class="pp">|</span></span>
<span id="cb67-734"><a href="#cb67-734" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Identifying important genomic regions <span class="pp">|</span> SNP-BLUP <span class="pp">|</span> Provides explicit SNP effects <span class="pp">|</span></span>
<span id="cb67-735"><a href="#cb67-735" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Traits with major QTL <span class="pp">|</span> Bayesian methods (next section) <span class="pp">|</span> Allows unequal SNP variances <span class="pp">|</span></span>
<span id="cb67-736"><a href="#cb67-736" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Integrating genotyped and non-genotyped animals <span class="pp">|</span> Single-step GBLUP (discussed later) <span class="pp">|</span> Handles both efficiently <span class="pp">|</span></span>
<span id="cb67-737"><a href="#cb67-737" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Research on genetic architecture <span class="pp">|</span> SNP-BLUP or Bayesian <span class="pp">|</span> Interpretable SNP effects <span class="pp">|</span></span>
<span id="cb67-738"><a href="#cb67-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-739"><a href="#cb67-739" aria-hidden="true" tabindex="-1"></a>In practice, **GBLUP dominates in industry** because it's computationally efficient and easy to implement in existing BLUP software. SNP-BLUP and Bayesian methods are more common in research and for specific applications where understanding SNP effects is important.</span>
<span id="cb67-740"><a href="#cb67-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-741"><a href="#cb67-741" aria-hidden="true" tabindex="-1"></a><span class="fu">## Bayesian Methods</span></span>
<span id="cb67-742"><a href="#cb67-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-743"><a href="#cb67-743" aria-hidden="true" tabindex="-1"></a>Both GBLUP and SNP-BLUP assume that all SNPs contribute equally (on average) to genetic variance. This is a reasonable first approximation for many traits, but it's not realistic for all traits. Some traits are influenced by a few large-effect QTL, while most SNPs have little to no effect. **Bayesian methods** relax the equal-variance assumption and allow SNPs to have different effect sizes—or even zero effect.</span>
<span id="cb67-744"><a href="#cb67-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-745"><a href="#cb67-745" aria-hidden="true" tabindex="-1"></a><span class="fu">### Motivation</span></span>
<span id="cb67-746"><a href="#cb67-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-747"><a href="#cb67-747" aria-hidden="true" tabindex="-1"></a>The equal-variance assumption of SNP-BLUP implies that the genetic architecture is **infinitesimal**: thousands of genes each contributing tiny, equal effects. This assumption works well for traits like body weight or milk yield, which are truly polygenic.</span>
<span id="cb67-748"><a href="#cb67-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-749"><a href="#cb67-749" aria-hidden="true" tabindex="-1"></a>However, consider these examples where the infinitesimal assumption breaks down:</span>
<span id="cb67-750"><a href="#cb67-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-751"><a href="#cb67-751" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Milk fat percentage in dairy cattle**: The DGAT1 gene explains ~30% of genetic variance—one gene with a huge effect</span>
<span id="cb67-752"><a href="#cb67-752" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Coat color**: A few major genes (MC1R, KIT, etc.) determine most variation</span>
<span id="cb67-753"><a href="#cb67-753" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Polled/horned in cattle**: The POLLED gene has a near-Mendelian effect</span>
<span id="cb67-754"><a href="#cb67-754" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Disease resistance**: Some pathogens have major resistance loci (e.g., MHC region)</span>
<span id="cb67-755"><a href="#cb67-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-756"><a href="#cb67-756" aria-hidden="true" tabindex="-1"></a>For these traits, forcing all SNPs to have equal variance is inefficient. It would be better to estimate **large effects for SNPs near major QTL** and **small (or zero) effects for SNPs in neutral regions**.</span>
<span id="cb67-757"><a href="#cb67-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-758"><a href="#cb67-758" aria-hidden="true" tabindex="-1"></a>This is exactly what Bayesian methods do: they use **prior distributions** that allow SNPs to have different variances, giving the model flexibility to identify major-effect loci while shrinking small effects toward zero.</span>
<span id="cb67-759"><a href="#cb67-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-760"><a href="#cb67-760" aria-hidden="true" tabindex="-1"></a><span class="fu">### The Bayesian Framework</span></span>
<span id="cb67-761"><a href="#cb67-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-762"><a href="#cb67-762" aria-hidden="true" tabindex="-1"></a>In Bayesian statistics, we combine:</span>
<span id="cb67-763"><a href="#cb67-763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-764"><a href="#cb67-764" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Prior distribution**: Our beliefs about parameters before seeing data (e.g., "most SNPs have small effects")</span>
<span id="cb67-765"><a href="#cb67-765" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Likelihood**: The probability of the data given parameters</span>
<span id="cb67-766"><a href="#cb67-766" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Posterior distribution**: Updated beliefs about parameters after seeing data</span>
<span id="cb67-767"><a href="#cb67-767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-768"><a href="#cb67-768" aria-hidden="true" tabindex="-1"></a>For genomic prediction, we specify a **prior distribution for SNP effects** (β) that reflects our belief about genetic architecture. The data then updates these priors, yielding a **posterior distribution** for SNP effects. We use Markov Chain Monte Carlo (MCMC) to sample from the posterior.</span>
<span id="cb67-769"><a href="#cb67-769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-770"><a href="#cb67-770" aria-hidden="true" tabindex="-1"></a><span class="fu">### BayesA</span></span>
<span id="cb67-771"><a href="#cb67-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-772"><a href="#cb67-772" aria-hidden="true" tabindex="-1"></a>**BayesA** was proposed by Meuwissen, Hayes, and Goddard (2001) as one of the original genomic selection methods.</span>
<span id="cb67-773"><a href="#cb67-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-774"><a href="#cb67-774" aria-hidden="true" tabindex="-1"></a>**Key idea**: All SNPs have effects, but each SNP has its own variance.</span>
<span id="cb67-775"><a href="#cb67-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-776"><a href="#cb67-776" aria-hidden="true" tabindex="-1"></a>**Model**:</span>
<span id="cb67-777"><a href="#cb67-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-778"><a href="#cb67-778" aria-hidden="true" tabindex="-1"></a>$$y = X\alpha + \sum_{j=1}^{m} M_j \beta_j + e$$</span>
<span id="cb67-779"><a href="#cb67-779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-780"><a href="#cb67-780" aria-hidden="true" tabindex="-1"></a>**Prior distributions**:</span>
<span id="cb67-781"><a href="#cb67-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-782"><a href="#cb67-782" aria-hidden="true" tabindex="-1"></a>$$\beta_j | \sigma^2_{\beta_j} \sim N(0, \sigma^2_{\beta_j})$$</span>
<span id="cb67-783"><a href="#cb67-783" aria-hidden="true" tabindex="-1"></a>$$\sigma^2_{\beta_j} \sim \text{Scaled Inverse Chi-Square}(\nu, S^2)$$</span>
<span id="cb67-784"><a href="#cb67-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-785"><a href="#cb67-785" aria-hidden="true" tabindex="-1"></a>Where:</span>
<span id="cb67-786"><a href="#cb67-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-787"><a href="#cb67-787" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**$\nu$** = degrees of freedom (typically 4-5)</span>
<span id="cb67-788"><a href="#cb67-788" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**$S^2$** = scale parameter (related to expected genetic variance)</span>
<span id="cb67-789"><a href="#cb67-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-790"><a href="#cb67-790" aria-hidden="true" tabindex="-1"></a>**Interpretation**:</span>
<span id="cb67-791"><a href="#cb67-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-792"><a href="#cb67-792" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Each SNP has its own variance ($\sigma^2_{\beta_j}$)</span>
<span id="cb67-793"><a href="#cb67-793" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The prior on $\sigma^2_{\beta_j}$ has heavy tails, allowing some SNPs to have large variances (large effects)</span>
<span id="cb67-794"><a href="#cb67-794" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Most SNPs will have small variances, but the model is flexible enough to accommodate a few large-effect SNPs</span>
<span id="cb67-795"><a href="#cb67-795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-796"><a href="#cb67-796" aria-hidden="true" tabindex="-1"></a>**Result**: SNPs near QTL get large effect estimates, while most SNPs get small (shrunken) estimates.</span>
<span id="cb67-797"><a href="#cb67-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-798"><a href="#cb67-798" aria-hidden="true" tabindex="-1"></a><span class="fu">### BayesB</span></span>
<span id="cb67-799"><a href="#cb67-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-800"><a href="#cb67-800" aria-hidden="true" tabindex="-1"></a>**BayesB** extends BayesA by allowing some SNPs to have **exactly zero effect**.</span>
<span id="cb67-801"><a href="#cb67-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-802"><a href="#cb67-802" aria-hidden="true" tabindex="-1"></a>**Key idea**: Only a proportion ($\pi$) of SNPs affect the trait; the rest have β_j = 0.</span>
<span id="cb67-803"><a href="#cb67-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-804"><a href="#cb67-804" aria-hidden="true" tabindex="-1"></a>**Model**:</span>
<span id="cb67-805"><a href="#cb67-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-806"><a href="#cb67-806" aria-hidden="true" tabindex="-1"></a>$$\beta_j = \begin{cases} 0 &amp; \text{with probability } \pi <span class="sc">\\</span> N(0, \sigma^2_{\beta_j}) &amp; \text{with probability } 1-\pi \end{cases}$$</span>
<span id="cb67-807"><a href="#cb67-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-808"><a href="#cb67-808" aria-hidden="true" tabindex="-1"></a>Where $\sigma^2_{\beta_j}$ again follows a scaled inverse chi-square distribution (as in BayesA).</span>
<span id="cb67-809"><a href="#cb67-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-810"><a href="#cb67-810" aria-hidden="true" tabindex="-1"></a>**Interpretation**:</span>
<span id="cb67-811"><a href="#cb67-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-812"><a href="#cb67-812" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>This is a **mixture prior**: SNPs are either "in the model" (with non-zero effect) or "out of the model" (zero effect)</span>
<span id="cb67-813"><a href="#cb67-813" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**$\pi$** is pre-specified (e.g., $\pi = 0.95$ means 95% of SNPs have zero effect, 5% have non-zero effects)</span>
<span id="cb67-814"><a href="#cb67-814" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>SNPs in the model can have large effects (heavy-tailed prior on variance)</span>
<span id="cb67-815"><a href="#cb67-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-816"><a href="#cb67-816" aria-hidden="true" tabindex="-1"></a>**Result**: The model performs **variable selection**—it identifies which SNPs are important and sets the rest to zero. This can improve accuracy for traits with few major QTL.</span>
<span id="cb67-817"><a href="#cb67-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-818"><a href="#cb67-818" aria-hidden="true" tabindex="-1"></a><span class="fu">### BayesC and BayesCπ</span></span>
<span id="cb67-819"><a href="#cb67-819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-820"><a href="#cb67-820" aria-hidden="true" tabindex="-1"></a>**BayesC** is similar to BayesB, but SNPs "in the model" all share the **same variance** (like SNP-BLUP), rather than having individual variances.</span>
<span id="cb67-821"><a href="#cb67-821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-822"><a href="#cb67-822" aria-hidden="true" tabindex="-1"></a>**BayesCπ** (BayesC-pi) extends BayesC by **estimating $\pi$** (the proportion of SNPs with zero effect) from the data, rather than pre-specifying it.</span>
<span id="cb67-823"><a href="#cb67-823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-824"><a href="#cb67-824" aria-hidden="true" tabindex="-1"></a>**Key idea**: Let the data tell us how many SNPs affect the trait.</span>
<span id="cb67-825"><a href="#cb67-825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-826"><a href="#cb67-826" aria-hidden="true" tabindex="-1"></a>**Model**:</span>
<span id="cb67-827"><a href="#cb67-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-828"><a href="#cb67-828" aria-hidden="true" tabindex="-1"></a>$$\beta_j = \begin{cases} 0 &amp; \text{with probability } \pi <span class="sc">\\</span> N(0, \sigma^2_{\beta}) &amp; \text{with probability } 1-\pi \end{cases}$$</span>
<span id="cb67-829"><a href="#cb67-829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-830"><a href="#cb67-830" aria-hidden="true" tabindex="-1"></a>**Prior on $\pi$**:</span>
<span id="cb67-831"><a href="#cb67-831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-832"><a href="#cb67-832" aria-hidden="true" tabindex="-1"></a>$$\pi \sim \text{Uniform}(0, 1)$$</span>
<span id="cb67-833"><a href="#cb67-833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-834"><a href="#cb67-834" aria-hidden="true" tabindex="-1"></a>Or a more informative prior, e.g., Beta(1, 10), which favors most SNPs having zero effect.</span>
<span id="cb67-835"><a href="#cb67-835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-836"><a href="#cb67-836" aria-hidden="true" tabindex="-1"></a>**Interpretation**:</span>
<span id="cb67-837"><a href="#cb67-837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-838"><a href="#cb67-838" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The model learns how "sparse" the genetic architecture is (i.e., what proportion of SNPs matter)</span>
<span id="cb67-839"><a href="#cb67-839" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>If the trait is highly polygenic, $\pi$ will be estimated near 0 (few SNPs excluded)</span>
<span id="cb67-840"><a href="#cb67-840" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>If the trait is oligogenic (few QTL), $\pi$ will be estimated near 1 (most SNPs excluded)</span>
<span id="cb67-841"><a href="#cb67-841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-842"><a href="#cb67-842" aria-hidden="true" tabindex="-1"></a><span class="fu">### Bayesian Lasso</span></span>
<span id="cb67-843"><a href="#cb67-843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-844"><a href="#cb67-844" aria-hidden="true" tabindex="-1"></a>The **Bayesian Lasso** uses a **double exponential (Laplace) prior** on SNP effects:</span>
<span id="cb67-845"><a href="#cb67-845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-846"><a href="#cb67-846" aria-hidden="true" tabindex="-1"></a>$$\beta_j | \lambda \sim \text{Double Exponential}(0, \lambda)$$</span>
<span id="cb67-847"><a href="#cb67-847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-848"><a href="#cb67-848" aria-hidden="true" tabindex="-1"></a>**Interpretation**:</span>
<span id="cb67-849"><a href="#cb67-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-850"><a href="#cb67-850" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>This prior strongly shrinks small effects toward zero (like ridge regression but stronger)</span>
<span id="cb67-851"><a href="#cb67-851" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Allows a few large effects to remain large</span>
<span id="cb67-852"><a href="#cb67-852" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Does not perform explicit variable selection (all SNPs have non-zero effects, but many are tiny)</span>
<span id="cb67-853"><a href="#cb67-853" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Computationally faster than BayesA/B/C</span>
<span id="cb67-854"><a href="#cb67-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-855"><a href="#cb67-855" aria-hidden="true" tabindex="-1"></a><span class="fu">### Comparing Bayesian Methods</span></span>
<span id="cb67-856"><a href="#cb67-856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-857"><a href="#cb67-857" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Method <span class="pp">|</span> SNPs with β = 0? <span class="pp">|</span> Variance per SNP <span class="pp">|</span> Estimates $\pi$? <span class="pp">|</span> Best for... <span class="pp">|</span></span>
<span id="cb67-858"><a href="#cb67-858" aria-hidden="true" tabindex="-1"></a><span class="pp">|--------|------------------|------------------|------------------|-------------|</span></span>
<span id="cb67-859"><a href="#cb67-859" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **BayesA** <span class="pp">|</span> No <span class="pp">|</span> Individual $\sigma^2_{\beta_j}$ <span class="pp">|</span> N/A <span class="pp">|</span> Moderate polygenicity, some large QTL <span class="pp">|</span></span>
<span id="cb67-860"><a href="#cb67-860" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **BayesB** <span class="pp">|</span> Yes (π pre-specified) <span class="pp">|</span> Individual $\sigma^2_{\beta_j}$ <span class="pp">|</span> No <span class="pp">|</span> Few large QTL, sparse architecture <span class="pp">|</span></span>
<span id="cb67-861"><a href="#cb67-861" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **BayesC** <span class="pp">|</span> Yes (π pre-specified) <span class="pp">|</span> Shared $\sigma^2_{\beta}$ <span class="pp">|</span> No <span class="pp">|</span> Few QTL, but equal-sized effects <span class="pp">|</span></span>
<span id="cb67-862"><a href="#cb67-862" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **BayesCπ** <span class="pp">|</span> Yes (π estimated) <span class="pp">|</span> Shared $\sigma^2_{\beta}$ <span class="pp">|</span> Yes <span class="pp">|</span> Unknown architecture, data decides <span class="pp">|</span></span>
<span id="cb67-863"><a href="#cb67-863" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Bayesian Lasso** <span class="pp">|</span> No <span class="pp">|</span> Regularized via λ <span class="pp">|</span> N/A <span class="pp">|</span> Fast computation, moderate sparsity <span class="pp">|</span></span>
<span id="cb67-864"><a href="#cb67-864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-865"><a href="#cb67-865" aria-hidden="true" tabindex="-1"></a><span class="fu">### When Bayesian Methods Help</span></span>
<span id="cb67-866"><a href="#cb67-866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-867"><a href="#cb67-867" aria-hidden="true" tabindex="-1"></a>Bayesian methods can improve genomic prediction accuracy over GBLUP/SNP-BLUP, but the gain depends on the trait's genetic architecture:</span>
<span id="cb67-868"><a href="#cb67-868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-869"><a href="#cb67-869" aria-hidden="true" tabindex="-1"></a>**Large gains (5-15% higher accuracy)**:</span>
<span id="cb67-870"><a href="#cb67-870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-871"><a href="#cb67-871" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Traits with a few major QTL (e.g., milk fat %, coat color, some disease resistance)</span>
<span id="cb67-872"><a href="#cb67-872" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Oligogenic traits (controlled by 5-50 genes)</span>
<span id="cb67-873"><a href="#cb67-873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-874"><a href="#cb67-874" aria-hidden="true" tabindex="-1"></a>**Modest gains (0-5% higher accuracy)**:</span>
<span id="cb67-875"><a href="#cb67-875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-876"><a href="#cb67-876" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Moderately polygenic traits (e.g., milk yield, body weight)</span>
<span id="cb67-877"><a href="#cb67-877" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Traits where most QTL have small effects, but a few are larger</span>
<span id="cb67-878"><a href="#cb67-878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-879"><a href="#cb67-879" aria-hidden="true" tabindex="-1"></a>**Little or no gain (&lt; 1% higher accuracy)**:</span>
<span id="cb67-880"><a href="#cb67-880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-881"><a href="#cb67-881" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Highly polygenic traits with purely infinitesimal architecture</span>
<span id="cb67-882"><a href="#cb67-882" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Traits with very low heritability (limited signal to detect QTL)</span>
<span id="cb67-883"><a href="#cb67-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-884"><a href="#cb67-884" aria-hidden="true" tabindex="-1"></a>**Trade-off**: Bayesian methods are **computationally expensive**. MCMC requires thousands of iterations, and each iteration updates thousands of SNP effects. For large datasets (50K SNPs, 10,000 animals), Bayesian methods may take hours to days, while GBLUP takes minutes.</span>
<span id="cb67-885"><a href="#cb67-885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-886"><a href="#cb67-886" aria-hidden="true" tabindex="-1"></a><span class="fu">### Software for Bayesian Genomic Prediction</span></span>
<span id="cb67-887"><a href="#cb67-887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-888"><a href="#cb67-888" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Software <span class="pp">|</span> Methods <span class="pp">|</span> Platform <span class="pp">|</span> Notes <span class="pp">|</span></span>
<span id="cb67-889"><a href="#cb67-889" aria-hidden="true" tabindex="-1"></a><span class="pp">|----------|---------|----------|-------|</span></span>
<span id="cb67-890"><a href="#cb67-890" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **BGLR** <span class="pp">|</span> BayesA, BayesB, BayesC, Bayesian Lasso, more <span class="pp">|</span> R <span class="pp">|</span> Most popular R package, well-documented <span class="pp">|</span></span>
<span id="cb67-891"><a href="#cb67-891" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **GenSel** <span class="pp">|</span> BayesB, BayesCπ <span class="pp">|</span> Standalone (Fortran) <span class="pp">|</span> Developed by Rohan Fernando's group (Iowa State) <span class="pp">|</span></span>
<span id="cb67-892"><a href="#cb67-892" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **bayz** <span class="pp">|</span> Flexible Bayesian models <span class="pp">|</span> R <span class="pp">|</span> General Bayesian modeling for genetics <span class="pp">|</span></span>
<span id="cb67-893"><a href="#cb67-893" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **JWAS** <span class="pp">|</span> Bayesian methods + single-step <span class="pp">|</span> Julia <span class="pp">|</span> Fast, modern language <span class="pp">|</span></span>
<span id="cb67-894"><a href="#cb67-894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-895"><a href="#cb67-895" aria-hidden="true" tabindex="-1"></a>**Example using BGLR** (conceptual):</span>
<span id="cb67-896"><a href="#cb67-896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-897"><a href="#cb67-897" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb67-898"><a href="#cb67-898" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(BGLR)</span>
<span id="cb67-899"><a href="#cb67-899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-900"><a href="#cb67-900" aria-hidden="true" tabindex="-1"></a><span class="co"># y = phenotypes, M = genotype matrix</span></span>
<span id="cb67-901"><a href="#cb67-901" aria-hidden="true" tabindex="-1"></a>fit_BayesB <span class="ot">&lt;-</span> <span class="fu">BGLR</span>(<span class="at">y =</span> y, <span class="at">ETA =</span> <span class="fu">list</span>(<span class="fu">list</span>(<span class="at">X =</span> M, <span class="at">model =</span> <span class="st">"BayesB"</span>)),</span>
<span id="cb67-902"><a href="#cb67-902" aria-hidden="true" tabindex="-1"></a>                   <span class="at">nIter =</span> <span class="dv">12000</span>, <span class="at">burnIn =</span> <span class="dv">2000</span>)</span>
<span id="cb67-903"><a href="#cb67-903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-904"><a href="#cb67-904" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract SNP effects</span></span>
<span id="cb67-905"><a href="#cb67-905" aria-hidden="true" tabindex="-1"></a>beta_hat <span class="ot">&lt;-</span> fit_BayesB<span class="sc">$</span>ETA[[<span class="dv">1</span>]]<span class="sc">$</span>b</span>
<span id="cb67-906"><a href="#cb67-906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-907"><a href="#cb67-907" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate GEBVs</span></span>
<span id="cb67-908"><a href="#cb67-908" aria-hidden="true" tabindex="-1"></a>GEBV <span class="ot">&lt;-</span> M <span class="sc">%*%</span> beta_hat</span>
<span id="cb67-909"><a href="#cb67-909" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-910"><a href="#cb67-910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-911"><a href="#cb67-911" aria-hidden="true" tabindex="-1"></a>We'll demonstrate this in an R code example later in the chapter.</span>
<span id="cb67-912"><a href="#cb67-912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-913"><a href="#cb67-913" aria-hidden="true" tabindex="-1"></a><span class="fu">### Summary: Bayesian vs. GBLUP</span></span>
<span id="cb67-914"><a href="#cb67-914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-915"><a href="#cb67-915" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**GBLUP**: Fast, works well for most traits, industry standard</span>
<span id="cb67-916"><a href="#cb67-916" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Bayesian methods**: Slower, but can improve accuracy for traits with major QTL</span>
<span id="cb67-917"><a href="#cb67-917" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**In practice**: Most breeding programs use GBLUP as the default, and apply Bayesian methods selectively for specific traits where QTL are known or suspected</span>
<span id="cb67-918"><a href="#cb67-918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-919"><a href="#cb67-919" aria-hidden="true" tabindex="-1"></a>The Bayesian alphabet represents an important methodological advance, but the computational cost means it's not universally adopted. For traits with known major genes (e.g., DGAT1 for milk fat), Bayesian methods are highly valuable.</span>
<span id="cb67-920"><a href="#cb67-920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-921"><a href="#cb67-921" aria-hidden="true" tabindex="-1"></a><span class="fu">## Single-Step Genomic BLUP (ssGBLUP)</span></span>
<span id="cb67-922"><a href="#cb67-922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-923"><a href="#cb67-923" aria-hidden="true" tabindex="-1"></a>In the early years of genomic selection (2009-2013), most breeding programs used a **two-step** (or **multi-step**) approach:</span>
<span id="cb67-924"><a href="#cb67-924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-925"><a href="#cb67-925" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Step 1**: Estimate SNP effects (or build G matrix) using a **training population** of genotyped animals with phenotypes</span>
<span id="cb67-926"><a href="#cb67-926" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Step 2**: Apply those SNP effects to predict GEBVs for **selection candidates** (young, genotyped animals without phenotypes)</span>
<span id="cb67-927"><a href="#cb67-927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-928"><a href="#cb67-928" aria-hidden="true" tabindex="-1"></a>This worked, but it had significant limitations. Enter **single-step genomic BLUP** (ssGBLUP), which revolutionized genomic evaluation by elegantly combining pedigree and genomic information in one unified analysis.</span>
<span id="cb67-929"><a href="#cb67-929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-930"><a href="#cb67-930" aria-hidden="true" tabindex="-1"></a><span class="fu">### The Problem with Multi-Step Approaches</span></span>
<span id="cb67-931"><a href="#cb67-931" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-932"><a href="#cb67-932" aria-hidden="true" tabindex="-1"></a>Multi-step genomic selection had several drawbacks:</span>
<span id="cb67-933"><a href="#cb67-933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-934"><a href="#cb67-934" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Genotyped and non-genotyped animals analyzed separately**:</span>
<span id="cb67-935"><a href="#cb67-935" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Traditional BLUP for non-genotyped animals (using pedigree A)</span>
<span id="cb67-936"><a href="#cb67-936" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Genomic BLUP for genotyped animals (using genomic G)</span>
<span id="cb67-937"><a href="#cb67-937" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Need to merge results, which creates scaling issues</span>
<span id="cb67-938"><a href="#cb67-938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-939"><a href="#cb67-939" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Selection candidates not included in training**:</span>
<span id="cb67-940"><a href="#cb67-940" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Training population = animals with genotypes **and** phenotypes</span>
<span id="cb67-941"><a href="#cb67-941" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Selection candidates = animals with genotypes **but no** phenotypes</span>
<span id="cb67-942"><a href="#cb67-942" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Selection candidates don't contribute to estimating SNP effects, even though they have relatives with data</span>
<span id="cb67-943"><a href="#cb67-943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-944"><a href="#cb67-944" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Re-estimation required**:</span>
<span id="cb67-945"><a href="#cb67-945" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>When new phenotypes arrive, must re-train the model from scratch</span>
<span id="cb67-946"><a href="#cb67-946" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Computationally inefficient</span>
<span id="cb67-947"><a href="#cb67-947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-948"><a href="#cb67-948" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**EBVs and GEBVs on different scales**:</span>
<span id="cb67-949"><a href="#cb67-949" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Traditional EBVs (pedigree-based) and GEBVs (genomic) can't be directly compared</span>
<span id="cb67-950"><a href="#cb67-950" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Requires adjustments and approximations</span>
<span id="cb67-951"><a href="#cb67-951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-952"><a href="#cb67-952" aria-hidden="true" tabindex="-1"></a><span class="fu">### The Single-Step Solution</span></span>
<span id="cb67-953"><a href="#cb67-953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-954"><a href="#cb67-954" aria-hidden="true" tabindex="-1"></a>**Single-step genomic BLUP** (ssGBLUP) solves all these problems by analyzing **all animals—genotyped and non-genotyped—in one unified model**. The key innovation is the **H matrix**, which combines pedigree (A) and genomic (G) relationships.</span>
<span id="cb67-955"><a href="#cb67-955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-956"><a href="#cb67-956" aria-hidden="true" tabindex="-1"></a>**Key insight**: For genotyped animals, use their realized genomic relationships (G). For non-genotyped animals, use their expected pedigree relationships (A). Blend the two seamlessly in one relationship matrix.</span>
<span id="cb67-957"><a href="#cb67-957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-958"><a href="#cb67-958" aria-hidden="true" tabindex="-1"></a>The result:</span>
<span id="cb67-959"><a href="#cb67-959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-960"><a href="#cb67-960" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>One evaluation for **all animals**</span>
<span id="cb67-961"><a href="#cb67-961" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>EBVs and GEBVs on the **same scale** (directly comparable)</span>
<span id="cb67-962"><a href="#cb67-962" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Automatic updates** when new data arrive (just re-run BLUP with updated H)</span>
<span id="cb67-963"><a href="#cb67-963" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Optimal use** of all information (phenotypes, pedigrees, genotypes)</span>
<span id="cb67-964"><a href="#cb67-964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-965"><a href="#cb67-965" aria-hidden="true" tabindex="-1"></a>ssGBLUP was developed independently by two research groups in 2009-2010:</span>
<span id="cb67-966"><a href="#cb67-966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-967"><a href="#cb67-967" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Andres Legarra, Ignacio Aguilar, and Ignacy Misztal** (2009): "A relationship matrix including full pedigree and genomic information"</span>
<span id="cb67-968"><a href="#cb67-968" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Ole Christensen and Mogens Lund** (2010): "Genomic prediction when some animals are not genotyped"</span>
<span id="cb67-969"><a href="#cb67-969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-970"><a href="#cb67-970" aria-hidden="true" tabindex="-1"></a>Today, ssGBLUP is the **industry standard** for genomic evaluation in dairy cattle, beef cattle, and increasingly in swine and poultry.</span>
<span id="cb67-971"><a href="#cb67-971" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-972"><a href="#cb67-972" aria-hidden="true" tabindex="-1"></a><span class="fu">### The H Matrix</span></span>
<span id="cb67-973"><a href="#cb67-973" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-974"><a href="#cb67-974" aria-hidden="true" tabindex="-1"></a>The **H matrix** is a unified relationship matrix that combines pedigree and genomic information. For a population with both genotyped and non-genotyped animals, H is structured as:</span>
<span id="cb67-975"><a href="#cb67-975" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-976"><a href="#cb67-976" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb67-977"><a href="#cb67-977" aria-hidden="true" tabindex="-1"></a>H = \begin{bmatrix}</span>
<span id="cb67-978"><a href="#cb67-978" aria-hidden="true" tabindex="-1"></a>A_{11} + A_{12}A_{22}^{-1}(G - A_{22})A_{22}^{-1}A_{21} &amp; A_{12}A_{22}^{-1}G <span class="sc">\\</span></span>
<span id="cb67-979"><a href="#cb67-979" aria-hidden="true" tabindex="-1"></a>GA_{22}^{-1}A_{21} &amp; G</span>
<span id="cb67-980"><a href="#cb67-980" aria-hidden="true" tabindex="-1"></a>\end{bmatrix}</span>
<span id="cb67-981"><a href="#cb67-981" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb67-982"><a href="#cb67-982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-983"><a href="#cb67-983" aria-hidden="true" tabindex="-1"></a>This looks complex, so it's more commonly expressed via the **inverse**:</span>
<span id="cb67-984"><a href="#cb67-984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-985"><a href="#cb67-985" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb67-986"><a href="#cb67-986" aria-hidden="true" tabindex="-1"></a>H^{-1} = A^{-1} + \begin{bmatrix} 0 &amp; 0 <span class="sc">\\</span> 0 &amp; G^{-1} - A_{22}^{-1} \end{bmatrix}</span>
<span id="cb67-987"><a href="#cb67-987" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb67-988"><a href="#cb67-988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-989"><a href="#cb67-989" aria-hidden="true" tabindex="-1"></a>Where:</span>
<span id="cb67-990"><a href="#cb67-990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-991"><a href="#cb67-991" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**A** = pedigree relationship matrix for **all animals** (genotyped and non-genotyped)</span>
<span id="cb67-992"><a href="#cb67-992" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**A_{22}** = pedigree relationships among **genotyped animals only** (subset of A)</span>
<span id="cb67-993"><a href="#cb67-993" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**G** = genomic relationship matrix for **genotyped animals only**</span>
<span id="cb67-994"><a href="#cb67-994" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**0** = blocks of zeros for non-genotyped animals (no genomic adjustment)</span>
<span id="cb67-995"><a href="#cb67-995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-996"><a href="#cb67-996" aria-hidden="true" tabindex="-1"></a>**Interpretation**:</span>
<span id="cb67-997"><a href="#cb67-997" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-998"><a href="#cb67-998" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Non-genotyped animals**: Use $A^{-1}$ (pedigree relationships), no adjustment</span>
<span id="cb67-999"><a href="#cb67-999" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Genotyped animals**: Use $A^{-1}$ + $(G^{-1} - A_{22}^{-1})$ — this replaces pedigree relationships with genomic relationships</span>
<span id="cb67-1000"><a href="#cb67-1000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1001"><a href="#cb67-1001" aria-hidden="true" tabindex="-1"></a>The term $(G^{-1} - A_{22}^{-1})$ is the **genomic correction**: it adjusts pedigree relationships to genomic relationships for genotyped animals.</span>
<span id="cb67-1002"><a href="#cb67-1002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1003"><a href="#cb67-1003" aria-hidden="true" tabindex="-1"></a>**Practical implementation**: Most software (BLUPF90, ASReml) builds $H^{-1}$ directly and solves mixed model equations. You don't compute H explicitly—just provide the pedigree (A) and genotypes (to compute G).</span>
<span id="cb67-1004"><a href="#cb67-1004" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1005"><a href="#cb67-1005" aria-hidden="true" tabindex="-1"></a><span class="fu">### How ssGBLUP Works: A Conceptual Example</span></span>
<span id="cb67-1006"><a href="#cb67-1006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1007"><a href="#cb67-1007" aria-hidden="true" tabindex="-1"></a>Imagine a dairy herd with:</span>
<span id="cb67-1008"><a href="#cb67-1008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1009"><a href="#cb67-1009" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**1000 cows** with milk yield records</span>
<span id="cb67-1010"><a href="#cb67-1010" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>400 cows are genotyped</span>
<span id="cb67-1011"><a href="#cb67-1011" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>600 cows are not genotyped</span>
<span id="cb67-1012"><a href="#cb67-1012" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**50 young bulls** (selection candidates)</span>
<span id="cb67-1013"><a href="#cb67-1013" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>All 50 bulls are genotyped</span>
<span id="cb67-1014"><a href="#cb67-1014" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>None have daughters with records yet (no phenotypes)</span>
<span id="cb67-1015"><a href="#cb67-1015" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1016"><a href="#cb67-1016" aria-hidden="true" tabindex="-1"></a>**Multi-step approach** (old way):</span>
<span id="cb67-1017"><a href="#cb67-1017" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1018"><a href="#cb67-1018" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Train genomic model on 400 genotyped cows</span>
<span id="cb67-1019"><a href="#cb67-1019" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Predict GEBVs for 50 young bulls</span>
<span id="cb67-1020"><a href="#cb67-1020" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Compute traditional EBVs for 600 non-genotyped cows</span>
<span id="cb67-1021"><a href="#cb67-1021" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Try to merge GEBVs and EBVs (scaling issues!)</span>
<span id="cb67-1022"><a href="#cb67-1022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1023"><a href="#cb67-1023" aria-hidden="true" tabindex="-1"></a>**Single-step approach** (ssGBLUP):</span>
<span id="cb67-1024"><a href="#cb67-1024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1025"><a href="#cb67-1025" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Build H matrix combining pedigree (all 1650 animals) and genotypes (450 animals)</span>
<span id="cb67-1026"><a href="#cb67-1026" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Run BLUP once using H</span>
<span id="cb67-1027"><a href="#cb67-1027" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Obtain breeding values for **all 1650 animals** simultaneously</span>
<span id="cb67-1028"><a href="#cb67-1028" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>400 genotyped cows: High accuracy (own data + genomic relationships)</span>
<span id="cb67-1029"><a href="#cb67-1029" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>600 non-genotyped cows: Moderate accuracy (own data + pedigree relationships)</span>
<span id="cb67-1030"><a href="#cb67-1030" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>50 young bulls: Moderate accuracy (no own data, but genomic relationships with genotyped cows)</span>
<span id="cb67-1031"><a href="#cb67-1031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1032"><a href="#cb67-1032" aria-hidden="true" tabindex="-1"></a>All breeding values are on the **same scale** and directly comparable.</span>
<span id="cb67-1033"><a href="#cb67-1033" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1034"><a href="#cb67-1034" aria-hidden="true" tabindex="-1"></a><span class="fu">### Advantages of ssGBLUP</span></span>
<span id="cb67-1035"><a href="#cb67-1035" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1036"><a href="#cb67-1036" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Unified evaluation**: All animals in one analysis, regardless of genotype status</span>
<span id="cb67-1037"><a href="#cb67-1037" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Same scale**: EBVs and GEBVs directly comparable (no scaling adjustments needed)</span>
<span id="cb67-1038"><a href="#cb67-1038" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Efficient**: Uses all available information optimally</span>
<span id="cb67-1039"><a href="#cb67-1039" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Phenotypes from genotyped **and** non-genotyped animals</span>
<span id="cb67-1040"><a href="#cb67-1040" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Pedigree information for all animals</span>
<span id="cb67-1041"><a href="#cb67-1041" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Genomic information for genotyped animals</span>
<span id="cb67-1042"><a href="#cb67-1042" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Easy updates**: When new animals are born or new phenotypes arrive, just re-run BLUP (no re-training of SNP effects)</span>
<span id="cb67-1043"><a href="#cb67-1043" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**Computationally feasible**: Despite large H matrices, sparse matrix algorithms make it fast enough for industry (evaluations of millions of animals)</span>
<span id="cb67-1044"><a href="#cb67-1044" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>**Handles complex pedigrees**: Works even with incomplete or uncertain pedigrees (G provides information)</span>
<span id="cb67-1045"><a href="#cb67-1045" aria-hidden="true" tabindex="-1"></a><span class="ss">7. </span>**No need for separate training/validation**: All animals with data contribute to the evaluation</span>
<span id="cb67-1046"><a href="#cb67-1046" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1047"><a href="#cb67-1047" aria-hidden="true" tabindex="-1"></a><span class="fu">### Adoption of ssGBLUP</span></span>
<span id="cb67-1048"><a href="#cb67-1048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1049"><a href="#cb67-1049" aria-hidden="true" tabindex="-1"></a>ssGBLUP has been rapidly adopted across livestock species:</span>
<span id="cb67-1050"><a href="#cb67-1050" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1051"><a href="#cb67-1051" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Species <span class="pp">|</span> Adoption Timeline <span class="pp">|</span> Implementation <span class="pp">|</span></span>
<span id="cb67-1052"><a href="#cb67-1052" aria-hidden="true" tabindex="-1"></a><span class="pp">|---------|-------------------|----------------|</span></span>
<span id="cb67-1053"><a href="#cb67-1053" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Dairy cattle (US)** <span class="pp">|</span> 2017 (CDCB) <span class="pp">|</span> Holsteins, Jerseys, all traits <span class="pp">|</span></span>
<span id="cb67-1054"><a href="#cb67-1054" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Beef cattle (US)** <span class="pp">|</span> 2013-2018 <span class="pp">|</span> American Angus (2017), multiple breeds <span class="pp">|</span></span>
<span id="cb67-1055"><a href="#cb67-1055" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Swine** <span class="pp">|</span> 2015-present <span class="pp">|</span> Major breeding companies (PIC, Topigs, Genesus) <span class="pp">|</span></span>
<span id="cb67-1056"><a href="#cb67-1056" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Poultry** <span class="pp">|</span> 2016-present <span class="pp">|</span> Cobb-Vantress, Aviagen, Hy-Line <span class="pp">|</span></span>
<span id="cb67-1057"><a href="#cb67-1057" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Sheep** <span class="pp">|</span> 2018-present <span class="pp">|</span> LAMBPLAN (Australia), NSIP (US) <span class="pp">|</span></span>
<span id="cb67-1058"><a href="#cb67-1058" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1059"><a href="#cb67-1059" aria-hidden="true" tabindex="-1"></a>Today, ssGBLUP is considered the **gold standard** for genomic evaluation. Multi-step approaches are mostly relegated to research or specialized applications.</span>
<span id="cb67-1060"><a href="#cb67-1060" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1061"><a href="#cb67-1061" aria-hidden="true" tabindex="-1"></a><span class="fu">### Software for ssGBLUP</span></span>
<span id="cb67-1062"><a href="#cb67-1062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1063"><a href="#cb67-1063" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Software <span class="pp">|</span> Description <span class="pp">|</span> Cost <span class="pp">|</span> Notes <span class="pp">|</span></span>
<span id="cb67-1064"><a href="#cb67-1064" aria-hidden="true" tabindex="-1"></a><span class="pp">|----------|-------------|------|-------|</span></span>
<span id="cb67-1065"><a href="#cb67-1065" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **BLUPF90 family** <span class="pp">|</span> Suite of programs (blupf90, remlf90, thrgibbs1f90) <span class="pp">|</span> Free <span class="pp">|</span> Most widely used, developed by Ignacy Misztal's group (U. Georgia) <span class="pp">|</span></span>
<span id="cb67-1066"><a href="#cb67-1066" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **ASReml** <span class="pp">|</span> Mixed model software <span class="pp">|</span> Commercial <span class="pp">|</span> Powerful, flexible, widely used in research <span class="pp">|</span></span>
<span id="cb67-1067"><a href="#cb67-1067" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **DMU** <span class="pp">|</span> Mixed model software <span class="pp">|</span> Free <span class="pp">|</span> Developed by Per Madsen (Aarhus University) <span class="pp">|</span></span>
<span id="cb67-1068"><a href="#cb67-1068" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **MiX99** <span class="pp">|</span> Mixed model software <span class="pp">|</span> Free <span class="pp">|</span> Developed by Esa Mäntysaari (Finland) <span class="pp">|</span></span>
<span id="cb67-1069"><a href="#cb67-1069" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **JWAS** <span class="pp">|</span> Julia-based software <span class="pp">|</span> Free <span class="pp">|</span> Modern, fast, user-friendly <span class="pp">|</span></span>
<span id="cb67-1070"><a href="#cb67-1070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1071"><a href="#cb67-1071" aria-hidden="true" tabindex="-1"></a>**BLUPF90** is the most common choice for large-scale industry evaluations due to its speed and ability to handle millions of animals.</span>
<span id="cb67-1072"><a href="#cb67-1072" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1073"><a href="#cb67-1073" aria-hidden="true" tabindex="-1"></a><span class="fu">### ssGBLUP vs. Multi-Step: Summary</span></span>
<span id="cb67-1074"><a href="#cb67-1074" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1075"><a href="#cb67-1075" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Feature <span class="pp">|</span> Multi-Step <span class="pp">|</span> Single-Step (ssGBLUP) <span class="pp">|</span></span>
<span id="cb67-1076"><a href="#cb67-1076" aria-hidden="true" tabindex="-1"></a><span class="pp">|---------|------------|----------------------|</span></span>
<span id="cb67-1077"><a href="#cb67-1077" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Genotyped &amp; non-genotyped animals** <span class="pp">|</span> Separate analyses <span class="pp">|</span> One unified analysis <span class="pp">|</span></span>
<span id="cb67-1078"><a href="#cb67-1078" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **EBV/GEBV scale** <span class="pp">|</span> Different scales, need adjustment <span class="pp">|</span> Same scale, directly comparable <span class="pp">|</span></span>
<span id="cb67-1079"><a href="#cb67-1079" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Selection candidates** <span class="pp">|</span> Not in training <span class="pp">|</span> Included via relationships <span class="pp">|</span></span>
<span id="cb67-1080"><a href="#cb67-1080" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Updating with new data** <span class="pp">|</span> Re-train SNP effects <span class="pp">|</span> Re-run BLUP (automatic) <span class="pp">|</span></span>
<span id="cb67-1081"><a href="#cb67-1081" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Computational complexity** <span class="pp">|</span> Moderate <span class="pp">|</span> Higher (but feasible) <span class="pp">|</span></span>
<span id="cb67-1082"><a href="#cb67-1082" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Industry adoption** <span class="pp">|</span> Historical (pre-2015) <span class="pp">|</span> Current standard (2015+) <span class="pp">|</span></span>
<span id="cb67-1083"><a href="#cb67-1083" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1084"><a href="#cb67-1084" aria-hidden="true" tabindex="-1"></a>ssGBLUP represents the maturation of genomic selection: it seamlessly integrates genomics into existing BLUP infrastructure, making genomic evaluation as routine as traditional genetic evaluation.</span>
<span id="cb67-1085"><a href="#cb67-1085" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1086"><a href="#cb67-1086" aria-hidden="true" tabindex="-1"></a><span class="fu">## Accuracy of Genomic Predictions</span></span>
<span id="cb67-1087"><a href="#cb67-1087" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1088"><a href="#cb67-1088" aria-hidden="true" tabindex="-1"></a>One of the most important questions in genomic selection is: **How accurate will our predictions be?** Accuracy determines the expected response to selection and whether genomic selection is worthwhile compared to traditional methods.</span>
<span id="cb67-1089"><a href="#cb67-1089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1090"><a href="#cb67-1090" aria-hidden="true" tabindex="-1"></a>The **accuracy** of genomic prediction is the correlation between the estimated breeding value (GEBV) and the true breeding value (TBV):</span>
<span id="cb67-1091"><a href="#cb67-1091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1092"><a href="#cb67-1092" aria-hidden="true" tabindex="-1"></a>$$r = \text{Cor}(GEBV, TBV)$$</span>
<span id="cb67-1093"><a href="#cb67-1093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1094"><a href="#cb67-1094" aria-hidden="true" tabindex="-1"></a>Higher accuracy means we're ranking animals more correctly, leading to greater genetic progress.</span>
<span id="cb67-1095"><a href="#cb67-1095" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1096"><a href="#cb67-1096" aria-hidden="true" tabindex="-1"></a><span class="fu">### Factors Influencing Accuracy</span></span>
<span id="cb67-1097"><a href="#cb67-1097" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1098"><a href="#cb67-1098" aria-hidden="true" tabindex="-1"></a>Five main factors determine the accuracy of genomic predictions:</span>
<span id="cb67-1099"><a href="#cb67-1099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1100"><a href="#cb67-1100" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 1. Size of Training Population (N)</span></span>
<span id="cb67-1101"><a href="#cb67-1101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1102"><a href="#cb67-1102" aria-hidden="true" tabindex="-1"></a>This is the **most important factor**. Larger training populations provide more information for estimating SNP effects or building the G matrix.</span>
<span id="cb67-1103"><a href="#cb67-1103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1104"><a href="#cb67-1104" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Small N** (&lt; 1,000): Accuracy is low (r ≈ 0.30-0.45), only slightly better than parent average</span>
<span id="cb67-1105"><a href="#cb67-1105" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Moderate N** (2,000-5,000): Accuracy is moderate (r ≈ 0.50-0.60)</span>
<span id="cb67-1106"><a href="#cb67-1106" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Large N** (10,000+): Accuracy is high (r ≈ 0.60-0.75), approaching progeny test levels</span>
<span id="cb67-1107"><a href="#cb67-1107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1108"><a href="#cb67-1108" aria-hidden="true" tabindex="-1"></a>**Diminishing returns**: Doubling the training population size does **not** double accuracy. To increase accuracy from 0.60 to 0.70 might require 4× more animals.</span>
<span id="cb67-1109"><a href="#cb67-1109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1110"><a href="#cb67-1110" aria-hidden="true" tabindex="-1"></a>**Species differences**:</span>
<span id="cb67-1111"><a href="#cb67-1111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1112"><a href="#cb67-1112" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Dairy cattle: N = 10,000-100,000 progeny-tested bulls (very large training populations)</span>
<span id="cb67-1113"><a href="#cb67-1113" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Swine: N = 5,000-20,000 pigs with performance records</span>
<span id="cb67-1114"><a href="#cb67-1114" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Poultry: N = 20,000-100,000 birds (can afford to phenotype many birds)</span>
<span id="cb67-1115"><a href="#cb67-1115" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Beef cattle: N = 5,000-30,000 (decentralized industry, smaller training populations)</span>
<span id="cb67-1116"><a href="#cb67-1116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1117"><a href="#cb67-1117" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 2. Heritability of the Trait (h²)</span></span>
<span id="cb67-1118"><a href="#cb67-1118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1119"><a href="#cb67-1119" aria-hidden="true" tabindex="-1"></a>Higher heritability means more genetic signal, making it easier to estimate breeding values accurately.</span>
<span id="cb67-1120"><a href="#cb67-1120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1121"><a href="#cb67-1121" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Low h²** (&lt; 0.15): Accuracy is limited (r ≈ 0.30-0.50), even with large N</span>
<span id="cb67-1122"><a href="#cb67-1122" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Examples: litter size, fertility, disease resistance</span>
<span id="cb67-1123"><a href="#cb67-1123" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Moderate h²** (0.20-0.40): Accuracy is moderate (r ≈ 0.50-0.65)</span>
<span id="cb67-1124"><a href="#cb67-1124" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Examples: milk production, growth rate, feed efficiency</span>
<span id="cb67-1125"><a href="#cb67-1125" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**High h²** (&gt; 0.40): Accuracy is high (r ≈ 0.65-0.80)</span>
<span id="cb67-1126"><a href="#cb67-1126" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Examples: body weight, carcass traits, egg weight</span>
<span id="cb67-1127"><a href="#cb67-1127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1128"><a href="#cb67-1128" aria-hidden="true" tabindex="-1"></a>**Key insight**: Genomic selection helps most for **low-heritability traits**, where traditional methods (progeny testing) were slow and inaccurate. For high-heritability traits, even simple selection (own performance) works well.</span>
<span id="cb67-1129"><a href="#cb67-1129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1130"><a href="#cb67-1130" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 3. Relationship Between Training and Selection Candidates</span></span>
<span id="cb67-1131"><a href="#cb67-1131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1132"><a href="#cb67-1132" aria-hidden="true" tabindex="-1"></a>Genomic predictions are most accurate when training and selection populations are **closely related**.</span>
<span id="cb67-1133"><a href="#cb67-1133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1134"><a href="#cb67-1134" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Close relatives** (e.g., parents, sibs, cousins in training population): High accuracy</span>
<span id="cb67-1135"><a href="#cb67-1135" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Distant relatives** (e.g., different families or lines): Lower accuracy</span>
<span id="cb67-1136"><a href="#cb67-1136" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Different breeds**: Very low accuracy (LD patterns differ between breeds)</span>
<span id="cb67-1137"><a href="#cb67-1137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1138"><a href="#cb67-1138" aria-hidden="true" tabindex="-1"></a>This is why training populations must be **continuously updated**: as generations pass and selection proceeds, today's selection candidates become less related to yesterday's training population. Re-training with recent generations maintains accuracy.</span>
<span id="cb67-1139"><a href="#cb67-1139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1140"><a href="#cb67-1140" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 4. Effective Population Size (N_e)</span></span>
<span id="cb67-1141"><a href="#cb67-1141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1142"><a href="#cb67-1142" aria-hidden="true" tabindex="-1"></a>Effective population size determines the **extent of linkage disequilibrium** (LD) in the population.</span>
<span id="cb67-1143"><a href="#cb67-1143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1144"><a href="#cb67-1144" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Smaller N_e** → Longer LD → Fewer SNPs needed to capture genetic variance → Higher accuracy with a given SNP density</span>
<span id="cb67-1145"><a href="#cb67-1145" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Larger N_e** → Shorter LD → More SNPs needed → Lower accuracy with fixed SNP density</span>
<span id="cb67-1146"><a href="#cb67-1146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1147"><a href="#cb67-1147" aria-hidden="true" tabindex="-1"></a>Livestock populations typically have small N_e (50-300), which is favorable for genomic selection. This is one reason why genomic selection works so well in livestock.</span>
<span id="cb67-1148"><a href="#cb67-1148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1149"><a href="#cb67-1149" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Species <span class="pp">|</span> Effective Population Size (N_e) <span class="pp">|</span> Implication for Genomic Selection <span class="pp">|</span></span>
<span id="cb67-1150"><a href="#cb67-1150" aria-hidden="true" tabindex="-1"></a><span class="pp">|---------|----------------------------------|-----------------------------------|</span></span>
<span id="cb67-1151"><a href="#cb67-1151" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Dairy cattle <span class="pp">|</span> 100-150 <span class="pp">|</span> Good LD, 50K SNPs sufficient <span class="pp">|</span></span>
<span id="cb67-1152"><a href="#cb67-1152" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Beef cattle <span class="pp">|</span> 150-500 (varies by breed) <span class="pp">|</span> Moderate LD, 50K SNPs good <span class="pp">|</span></span>
<span id="cb67-1153"><a href="#cb67-1153" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Swine <span class="pp">|</span> 100-300 <span class="pp">|</span> Good LD, 50K SNPs sufficient <span class="pp">|</span></span>
<span id="cb67-1154"><a href="#cb67-1154" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Poultry <span class="pp">|</span> 50-150 <span class="pp">|</span> Excellent LD, even 10K SNPs work well <span class="pp">|</span></span>
<span id="cb67-1155"><a href="#cb67-1155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1156"><a href="#cb67-1156" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 5. SNP Density</span></span>
<span id="cb67-1157"><a href="#cb67-1157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1158"><a href="#cb67-1158" aria-hidden="true" tabindex="-1"></a>More SNPs mean better coverage of the genome and higher LD between markers and causal mutations.</span>
<span id="cb67-1159"><a href="#cb67-1159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1160"><a href="#cb67-1160" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Low density** (3K-10K SNPs): Lower accuracy, but cheap</span>
<span id="cb67-1161"><a href="#cb67-1161" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Medium density** (50K SNPs): Good accuracy, standard in industry</span>
<span id="cb67-1162"><a href="#cb67-1162" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**High density** (600K-1M SNPs): Slightly higher accuracy, more expensive</span>
<span id="cb67-1163"><a href="#cb67-1163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1164"><a href="#cb67-1164" aria-hidden="true" tabindex="-1"></a>**Diminishing returns**: Going from 10K to 50K SNPs increases accuracy substantially (~10-15%), but going from 50K to 600K only increases accuracy by ~2-5%.</span>
<span id="cb67-1165"><a href="#cb67-1165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1166"><a href="#cb67-1166" aria-hidden="true" tabindex="-1"></a>**Imputation** (Chapter 12) allows cost-effective use of high-density data: genotype animals with low-density chips, impute to high-density, and use imputed genotypes for prediction.</span>
<span id="cb67-1167"><a href="#cb67-1167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1168"><a href="#cb67-1168" aria-hidden="true" tabindex="-1"></a><span class="fu">### Typical Accuracies</span></span>
<span id="cb67-1169"><a href="#cb67-1169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1170"><a href="#cb67-1170" aria-hidden="true" tabindex="-1"></a>Here are typical genomic prediction accuracies for different scenarios:</span>
<span id="cb67-1171"><a href="#cb67-1171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1172"><a href="#cb67-1172" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Scenario <span class="pp">|</span> Accuracy (r) <span class="pp">|</span> Notes <span class="pp">|</span></span>
<span id="cb67-1173"><a href="#cb67-1173" aria-hidden="true" tabindex="-1"></a><span class="pp">|----------|--------------|-------|</span></span>
<span id="cb67-1174"><a href="#cb67-1174" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Parent average** (no genomics) <span class="pp">|</span> 0.30-0.45 <span class="pp">|</span> Traditional pedigree index <span class="pp">|</span></span>
<span id="cb67-1175"><a href="#cb67-1175" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Genomic** (young animal, h²=0.10, N=5,000) <span class="pp">|</span> 0.35-0.45 <span class="pp">|</span> Low h² trait, modest improvement <span class="pp">|</span></span>
<span id="cb67-1176"><a href="#cb67-1176" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Genomic** (young animal, h²=0.30, N=5,000) <span class="pp">|</span> 0.50-0.60 <span class="pp">|</span> Moderate h² trait, good accuracy <span class="pp">|</span></span>
<span id="cb67-1177"><a href="#cb67-1177" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Genomic** (young animal, h²=0.30, N=20,000) <span class="pp">|</span> 0.65-0.75 <span class="pp">|</span> Large training population <span class="pp">|</span></span>
<span id="cb67-1178"><a href="#cb67-1178" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Genomic + own phenotype** <span class="pp">|</span> 0.60-0.80 <span class="pp">|</span> Combination of genomic and phenotypic info <span class="pp">|</span></span>
<span id="cb67-1179"><a href="#cb67-1179" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Genomic + progeny** (n=20) <span class="pp">|</span> 0.80-0.90 <span class="pp">|</span> Very high accuracy, but slower <span class="pp">|</span></span>
<span id="cb67-1180"><a href="#cb67-1180" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Progeny testing** (n=50-100 daughters) <span class="pp">|</span> 0.85-0.95 <span class="pp">|</span> Gold standard, but slow and expensive <span class="pp">|</span></span>
<span id="cb67-1181"><a href="#cb67-1181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1182"><a href="#cb67-1182" aria-hidden="true" tabindex="-1"></a>**Key comparison**: Genomic selection gives young animals (at birth) the accuracy that used to require 10-20 progeny records, but in **zero time**.</span>
<span id="cb67-1183"><a href="#cb67-1183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1184"><a href="#cb67-1184" aria-hidden="true" tabindex="-1"></a><span class="fu">### Deterministic Prediction of Accuracy</span></span>
<span id="cb67-1185"><a href="#cb67-1185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1186"><a href="#cb67-1186" aria-hidden="true" tabindex="-1"></a>**Daetwyler et al. (2008)** derived a simple formula for predicting the accuracy of genomic selection:</span>
<span id="cb67-1187"><a href="#cb67-1187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1188"><a href="#cb67-1188" aria-hidden="true" tabindex="-1"></a>$$r = \sqrt{\frac{N h^2}{N h^2 + M_e}}$$</span>
<span id="cb67-1189"><a href="#cb67-1189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1190"><a href="#cb67-1190" aria-hidden="true" tabindex="-1"></a>Where:</span>
<span id="cb67-1191"><a href="#cb67-1191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1192"><a href="#cb67-1192" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**N** = number of animals in the training population</span>
<span id="cb67-1193"><a href="#cb67-1193" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**h²** = heritability of the trait</span>
<span id="cb67-1194"><a href="#cb67-1194" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**M_e** = effective number of independent chromosome segments</span>
<span id="cb67-1195"><a href="#cb67-1195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1196"><a href="#cb67-1196" aria-hidden="true" tabindex="-1"></a>**M_e** depends on effective population size and genome size. For livestock:</span>
<span id="cb67-1197"><a href="#cb67-1197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1198"><a href="#cb67-1198" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Dairy cattle: M_e ≈ 1,000-2,000</span>
<span id="cb67-1199"><a href="#cb67-1199" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Swine: M_e ≈ 1,200-1,800</span>
<span id="cb67-1200"><a href="#cb67-1200" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Poultry: M_e ≈ 600-1,000 (smaller N_e, longer LD)</span>
<span id="cb67-1201"><a href="#cb67-1201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1202"><a href="#cb67-1202" aria-hidden="true" tabindex="-1"></a>**Interpretation**:</span>
<span id="cb67-1203"><a href="#cb67-1203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1204"><a href="#cb67-1204" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>As **N → ∞**, accuracy approaches $\sqrt{h^2} = h$ (the theoretical maximum for predicting breeding values without progeny)</span>
<span id="cb67-1205"><a href="#cb67-1205" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Accuracy increases with **N** and **h²**</span>
<span id="cb67-1206"><a href="#cb67-1206" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Accuracy is limited by **M_e**: populations with smaller M_e (longer LD) reach high accuracy with fewer training animals</span>
<span id="cb67-1207"><a href="#cb67-1207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1208"><a href="#cb67-1208" aria-hidden="true" tabindex="-1"></a>**Example calculation**:</span>
<span id="cb67-1209"><a href="#cb67-1209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1210"><a href="#cb67-1210" aria-hidden="true" tabindex="-1"></a>For dairy milk yield with h² = 0.30, N = 10,000, and M_e = 1,500:</span>
<span id="cb67-1211"><a href="#cb67-1211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1212"><a href="#cb67-1212" aria-hidden="true" tabindex="-1"></a>$$r = \sqrt{\frac{10,000 \times 0.30}{10,000 \times 0.30 + 1,500}} = \sqrt{\frac{3,000}{4,500}} = \sqrt{0.667} = 0.82$$</span>
<span id="cb67-1213"><a href="#cb67-1213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1214"><a href="#cb67-1214" aria-hidden="true" tabindex="-1"></a>This is very close to empirical accuracies observed in U.S. dairy cattle genomic evaluations.</span>
<span id="cb67-1215"><a href="#cb67-1215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1216"><a href="#cb67-1216" aria-hidden="true" tabindex="-1"></a><span class="fu">### Increasing Accuracy Over Time</span></span>
<span id="cb67-1217"><a href="#cb67-1217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1218"><a href="#cb67-1218" aria-hidden="true" tabindex="-1"></a>Genomic prediction accuracy **increases** as breeding programs mature:</span>
<span id="cb67-1219"><a href="#cb67-1219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1220"><a href="#cb67-1220" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Larger training populations**: As more animals are genotyped and phenotyped, N grows</span>
<span id="cb67-1221"><a href="#cb67-1221" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Better phenotypes**: Improved data collection (precision livestock farming) provides higher-quality phenotypes</span>
<span id="cb67-1222"><a href="#cb67-1222" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Updated SNP panels**: Higher-density chips and whole-genome sequencing capture more genetic variation</span>
<span id="cb67-1223"><a href="#cb67-1223" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Improved methods**: Better statistical models (e.g., multi-trait, multi-breed, machine learning)</span>
<span id="cb67-1224"><a href="#cb67-1224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1225"><a href="#cb67-1225" aria-hidden="true" tabindex="-1"></a>This creates a **positive feedback loop**: higher accuracy → faster genetic progress → better training population → even higher accuracy.</span>
<span id="cb67-1226"><a href="#cb67-1226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1227"><a href="#cb67-1227" aria-hidden="true" tabindex="-1"></a><span class="fu">### R Demonstration: Simulating Genomic Prediction Accuracy</span></span>
<span id="cb67-1228"><a href="#cb67-1228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1229"><a href="#cb67-1229" aria-hidden="true" tabindex="-1"></a>Let's use the Daetwyler formula to explore how training population size and heritability affect genomic prediction accuracy.</span>
<span id="cb67-1230"><a href="#cb67-1230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1233"><a href="#cb67-1233" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-1234"><a href="#cb67-1234" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb67-1235"><a href="#cb67-1235" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb67-1236"><a href="#cb67-1236" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb67-1237"><a href="#cb67-1237" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.width: 10</span></span>
<span id="cb67-1238"><a href="#cb67-1238" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.height: 5</span></span>
<span id="cb67-1239"><a href="#cb67-1239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1240"><a href="#cb67-1240" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb67-1241"><a href="#cb67-1241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1242"><a href="#cb67-1242" aria-hidden="true" tabindex="-1"></a><span class="co"># Daetwyler et al. (2008) accuracy formula</span></span>
<span id="cb67-1243"><a href="#cb67-1243" aria-hidden="true" tabindex="-1"></a>genomic_accuracy <span class="ot">&lt;-</span> <span class="cf">function</span>(N, h2, Me) {</span>
<span id="cb67-1244"><a href="#cb67-1244" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sqrt</span>((N <span class="sc">*</span> h2) <span class="sc">/</span> (N <span class="sc">*</span> h2 <span class="sc">+</span> Me))</span>
<span id="cb67-1245"><a href="#cb67-1245" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb67-1246"><a href="#cb67-1246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1247"><a href="#cb67-1247" aria-hidden="true" tabindex="-1"></a><span class="co"># Set parameters</span></span>
<span id="cb67-1248"><a href="#cb67-1248" aria-hidden="true" tabindex="-1"></a>Me <span class="ot">&lt;-</span> <span class="dv">1500</span>  <span class="co"># Effective number of chromosome segments (typical for cattle)</span></span>
<span id="cb67-1249"><a href="#cb67-1249" aria-hidden="true" tabindex="-1"></a>training_sizes <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">500</span>, <span class="dv">20000</span>, <span class="at">by =</span> <span class="dv">500</span>)</span>
<span id="cb67-1250"><a href="#cb67-1250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1251"><a href="#cb67-1251" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate accuracy for different heritabilities</span></span>
<span id="cb67-1252"><a href="#cb67-1252" aria-hidden="true" tabindex="-1"></a>h2_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.10</span>, <span class="fl">0.20</span>, <span class="fl">0.30</span>, <span class="fl">0.40</span>, <span class="fl">0.50</span>)</span>
<span id="cb67-1253"><a href="#cb67-1253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1254"><a href="#cb67-1254" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data frame with all combinations</span></span>
<span id="cb67-1255"><a href="#cb67-1255" aria-hidden="true" tabindex="-1"></a>accuracy_data <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb67-1256"><a href="#cb67-1256" aria-hidden="true" tabindex="-1"></a>  <span class="at">N =</span> training_sizes,</span>
<span id="cb67-1257"><a href="#cb67-1257" aria-hidden="true" tabindex="-1"></a>  <span class="at">h2 =</span> h2_values</span>
<span id="cb67-1258"><a href="#cb67-1258" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb67-1259"><a href="#cb67-1259" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb67-1260"><a href="#cb67-1260" aria-hidden="true" tabindex="-1"></a>    <span class="at">accuracy =</span> <span class="fu">genomic_accuracy</span>(N, h2, Me),</span>
<span id="cb67-1261"><a href="#cb67-1261" aria-hidden="true" tabindex="-1"></a>    <span class="at">h2_label =</span> <span class="fu">paste0</span>(<span class="st">"h² = "</span>, h2)</span>
<span id="cb67-1262"><a href="#cb67-1262" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb67-1263"><a href="#cb67-1263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1264"><a href="#cb67-1264" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot accuracy vs. training population size</span></span>
<span id="cb67-1265"><a href="#cb67-1265" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(accuracy_data, <span class="fu">aes</span>(<span class="at">x =</span> N, <span class="at">y =</span> accuracy, <span class="at">color =</span> h2_label)) <span class="sc">+</span></span>
<span id="cb67-1266"><a href="#cb67-1266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb67-1267"><a href="#cb67-1267" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>, <span class="at">name =</span> <span class="st">"Heritability"</span>) <span class="sc">+</span></span>
<span id="cb67-1268"><a href="#cb67-1268" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Genomic Prediction Accuracy vs. Training Population Size"</span>,</span>
<span id="cb67-1269"><a href="#cb67-1269" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste0</span>(<span class="st">"Me = "</span>, Me, <span class="st">" (typical for cattle)"</span>),</span>
<span id="cb67-1270"><a href="#cb67-1270" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Training Population Size (N)"</span>,</span>
<span id="cb67-1271"><a href="#cb67-1271" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Accuracy (r)"</span>) <span class="sc">+</span></span>
<span id="cb67-1272"><a href="#cb67-1272" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb67-1273"><a href="#cb67-1273" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>) <span class="sc">+</span></span>
<span id="cb67-1274"><a href="#cb67-1274" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.7</span>), <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb67-1275"><a href="#cb67-1275" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">18000</span>, <span class="at">y =</span> <span class="fl">0.52</span>, <span class="at">label =</span> <span class="st">"r = 0.50"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"gray40"</span>) <span class="sc">+</span></span>
<span id="cb67-1276"><a href="#cb67-1276" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">18000</span>, <span class="at">y =</span> <span class="fl">0.72</span>, <span class="at">label =</span> <span class="st">"r = 0.70"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"gray40"</span>)</span>
<span id="cb67-1277"><a href="#cb67-1277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1278"><a href="#cb67-1278" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p1)</span>
<span id="cb67-1279"><a href="#cb67-1279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1280"><a href="#cb67-1280" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate accuracy needed to match progeny testing (r = 0.85)</span></span>
<span id="cb67-1281"><a href="#cb67-1281" aria-hidden="true" tabindex="-1"></a><span class="co"># and find required training population size for h² = 0.30</span></span>
<span id="cb67-1282"><a href="#cb67-1282" aria-hidden="true" tabindex="-1"></a>target_accuracy <span class="ot">&lt;-</span> <span class="fl">0.85</span></span>
<span id="cb67-1283"><a href="#cb67-1283" aria-hidden="true" tabindex="-1"></a>h2_example <span class="ot">&lt;-</span> <span class="fl">0.30</span></span>
<span id="cb67-1284"><a href="#cb67-1284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1285"><a href="#cb67-1285" aria-hidden="true" tabindex="-1"></a><span class="co"># Solve for N: r = sqrt(N*h2 / (N*h2 + Me))</span></span>
<span id="cb67-1286"><a href="#cb67-1286" aria-hidden="true" tabindex="-1"></a><span class="co"># r^2 = N*h2 / (N*h2 + Me)</span></span>
<span id="cb67-1287"><a href="#cb67-1287" aria-hidden="true" tabindex="-1"></a><span class="co"># r^2 * (N*h2 + Me) = N*h2</span></span>
<span id="cb67-1288"><a href="#cb67-1288" aria-hidden="true" tabindex="-1"></a><span class="co"># r^2*N*h2 + r^2*Me = N*h2</span></span>
<span id="cb67-1289"><a href="#cb67-1289" aria-hidden="true" tabindex="-1"></a><span class="co"># r^2*Me = N*h2 - r^2*N*h2</span></span>
<span id="cb67-1290"><a href="#cb67-1290" aria-hidden="true" tabindex="-1"></a><span class="co"># r^2*Me = N*h2*(1 - r^2)</span></span>
<span id="cb67-1291"><a href="#cb67-1291" aria-hidden="true" tabindex="-1"></a><span class="co"># N = r^2*Me / (h2*(1 - r^2))</span></span>
<span id="cb67-1292"><a href="#cb67-1292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1293"><a href="#cb67-1293" aria-hidden="true" tabindex="-1"></a>N_required <span class="ot">&lt;-</span> (target_accuracy<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> Me) <span class="sc">/</span> (h2_example <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> target_accuracy<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb67-1294"><a href="#cb67-1294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1295"><a href="#cb67-1295" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">To achieve accuracy r ="</span>, target_accuracy,</span>
<span id="cb67-1296"><a href="#cb67-1296" aria-hidden="true" tabindex="-1"></a>    <span class="st">"for a trait with h² ="</span>, h2_example,</span>
<span id="cb67-1297"><a href="#cb67-1297" aria-hidden="true" tabindex="-1"></a>    <span class="st">"</span><span class="sc">\n</span><span class="st">Training population size required: N ="</span>, <span class="fu">round</span>(N_required, <span class="dv">0</span>), <span class="st">"animals</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb67-1298"><a href="#cb67-1298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1299"><a href="#cb67-1299" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare different species (different Me values)</span></span>
<span id="cb67-1300"><a href="#cb67-1300" aria-hidden="true" tabindex="-1"></a>species_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb67-1301"><a href="#cb67-1301" aria-hidden="true" tabindex="-1"></a>  <span class="at">Species =</span> <span class="fu">c</span>(<span class="st">"Poultry"</span>, <span class="st">"Dairy Cattle"</span>, <span class="st">"Swine"</span>, <span class="st">"Beef Cattle"</span>),</span>
<span id="cb67-1302"><a href="#cb67-1302" aria-hidden="true" tabindex="-1"></a>  <span class="at">Me =</span> <span class="fu">c</span>(<span class="dv">800</span>, <span class="dv">1500</span>, <span class="dv">1400</span>, <span class="dv">2000</span>),</span>
<span id="cb67-1303"><a href="#cb67-1303" aria-hidden="true" tabindex="-1"></a>  <span class="at">N =</span> <span class="dv">10000</span>,</span>
<span id="cb67-1304"><a href="#cb67-1304" aria-hidden="true" tabindex="-1"></a>  <span class="at">h2 =</span> <span class="fl">0.30</span></span>
<span id="cb67-1305"><a href="#cb67-1305" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb67-1306"><a href="#cb67-1306" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb67-1307"><a href="#cb67-1307" aria-hidden="true" tabindex="-1"></a>    <span class="at">accuracy =</span> <span class="fu">genomic_accuracy</span>(N, h2, Me)</span>
<span id="cb67-1308"><a href="#cb67-1308" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb67-1309"><a href="#cb67-1309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1310"><a href="#cb67-1310" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Genomic prediction accuracy across species (N = 10,000, h² = 0.30):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb67-1311"><a href="#cb67-1311" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(species_data <span class="sc">%&gt;%</span> <span class="fu">select</span>(Species, Me, accuracy))</span>
<span id="cb67-1312"><a href="#cb67-1312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1313"><a href="#cb67-1313" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot species comparison</span></span>
<span id="cb67-1314"><a href="#cb67-1314" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(species_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(Species, <span class="sc">-</span>accuracy), <span class="at">y =</span> accuracy, <span class="at">fill =</span> Species)) <span class="sc">+</span></span>
<span id="cb67-1315"><a href="#cb67-1315" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb67-1316"><a href="#cb67-1316" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Pastel1"</span>) <span class="sc">+</span></span>
<span id="cb67-1317"><a href="#cb67-1317" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Genomic Prediction Accuracy by Species"</span>,</span>
<span id="cb67-1318"><a href="#cb67-1318" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"N = 10,000, h² = 0.30 (Me varies by species)"</span>,</span>
<span id="cb67-1319"><a href="#cb67-1319" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Species"</span>,</span>
<span id="cb67-1320"><a href="#cb67-1320" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Accuracy (r)"</span>) <span class="sc">+</span></span>
<span id="cb67-1321"><a href="#cb67-1321" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb67-1322"><a href="#cb67-1322" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb67-1323"><a href="#cb67-1323" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(accuracy, <span class="dv">3</span>)), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb67-1324"><a href="#cb67-1324" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb67-1325"><a href="#cb67-1325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1326"><a href="#cb67-1326" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p2)</span>
<span id="cb67-1327"><a href="#cb67-1327" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-1328"><a href="#cb67-1328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1329"><a href="#cb67-1329" aria-hidden="true" tabindex="-1"></a>**Key insights**:</span>
<span id="cb67-1330"><a href="#cb67-1330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1331"><a href="#cb67-1331" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Diminishing returns**: Accuracy increases rapidly with initial additions to training population, but gains slow as N grows large</span>
<span id="cb67-1332"><a href="#cb67-1332" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Heritability matters**: Higher h² traits reach higher maximum accuracy</span>
<span id="cb67-1333"><a href="#cb67-1333" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Species differences**: Species with smaller M_e (longer LD, like poultry) achieve higher accuracy with the same training population size</span>
<span id="cb67-1334"><a href="#cb67-1334" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**To match progeny testing** (r ≈ 0.85): Requires very large training populations (&gt;30,000 animals for moderate h² traits), which is feasible only in some species (dairy, poultry)</span>
<span id="cb67-1335"><a href="#cb67-1335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1336"><a href="#cb67-1336" aria-hidden="true" tabindex="-1"></a><span class="fu">## Comparing Pedigree (A) and Genomic (G) Relationship Matrices</span></span>
<span id="cb67-1337"><a href="#cb67-1337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1338"><a href="#cb67-1338" aria-hidden="true" tabindex="-1"></a>One of the most profound insights from genomic selection is that **realized relationships differ from expected relationships**. The pedigree relationship matrix (A) tells us the expected proportion of genome shared between relatives, but the genomic relationship matrix (G) tells us the actual proportion shared.</span>
<span id="cb67-1339"><a href="#cb67-1339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1340"><a href="#cb67-1340" aria-hidden="true" tabindex="-1"></a>This section demonstrates why G is more powerful than A, using both numerical examples and visualizations.</span>
<span id="cb67-1341"><a href="#cb67-1341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1342"><a href="#cb67-1342" aria-hidden="true" tabindex="-1"></a><span class="fu">### Why A and G Differ</span></span>
<span id="cb67-1343"><a href="#cb67-1343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1344"><a href="#cb67-1344" aria-hidden="true" tabindex="-1"></a>**Pedigree relationships (A)** are based on expected inheritance:</span>
<span id="cb67-1345"><a href="#cb67-1345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1346"><a href="#cb67-1346" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Parent-offspring: A_ij = 0.50 (always)</span>
<span id="cb67-1347"><a href="#cb67-1347" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Full-siblings: A_ij = 0.50 (always)</span>
<span id="cb67-1348"><a href="#cb67-1348" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Half-siblings: A_ij = 0.25 (always)</span>
<span id="cb67-1349"><a href="#cb67-1349" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Unrelated: A_ij = 0 (if no common ancestors)</span>
<span id="cb67-1350"><a href="#cb67-1350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1351"><a href="#cb67-1351" aria-hidden="true" tabindex="-1"></a>**Genomic relationships (G)** are based on realized inheritance:</span>
<span id="cb67-1352"><a href="#cb67-1352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1353"><a href="#cb67-1353" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Parent-offspring: G_ij ≈ 0.50 (close to expected, little variation)</span>
<span id="cb67-1354"><a href="#cb67-1354" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Full-siblings: G_ij ~ Normal(0.50, SD ≈ 0.04) — varies from ~0.42 to 0.58</span>
<span id="cb67-1355"><a href="#cb67-1355" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Half-siblings: G_ij ~ Normal(0.25, SD ≈ 0.03) — varies from ~0.19 to 0.31</span>
<span id="cb67-1356"><a href="#cb67-1356" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Unrelated: G_ij ≈ 0, but can be slightly negative (opposite alleles)</span>
<span id="cb67-1357"><a href="#cb67-1357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1358"><a href="#cb67-1358" aria-hidden="true" tabindex="-1"></a>**Source of variation**: **Mendelian sampling** — the random segregation of parental chromosomes and recombination during meiosis. Full-siblings receive different combinations of parental chromosomes, so they don't share exactly 50% of their genome.</span>
<span id="cb67-1359"><a href="#cb67-1359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1360"><a href="#cb67-1360" aria-hidden="true" tabindex="-1"></a>This variation is crucial for genetic progress: it's why some offspring are genetically superior to their parents (they inherited favorable alleles), while others are inferior (they inherited unfavorable alleles). **G captures this variation; A does not.**</span>
<span id="cb67-1361"><a href="#cb67-1361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1362"><a href="#cb67-1362" aria-hidden="true" tabindex="-1"></a><span class="fu">### Numerical Example: Full-Siblings</span></span>
<span id="cb67-1363"><a href="#cb67-1363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1364"><a href="#cb67-1364" aria-hidden="true" tabindex="-1"></a>Consider five pairs of full-siblings from the same parents. According to the pedigree (A matrix), all pairs should have relationship = 0.50. But with genomic data (G matrix), we might observe:</span>
<span id="cb67-1365"><a href="#cb67-1365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1366"><a href="#cb67-1366" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Pair <span class="pp">|</span> A (expected) <span class="pp">|</span> G (realized) <span class="pp">|</span></span>
<span id="cb67-1367"><a href="#cb67-1367" aria-hidden="true" tabindex="-1"></a><span class="pp">|------|--------------|--------------|</span></span>
<span id="cb67-1368"><a href="#cb67-1368" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 1    <span class="pp">|</span> 0.50         <span class="pp">|</span> 0.48         <span class="pp">|</span></span>
<span id="cb67-1369"><a href="#cb67-1369" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 2    <span class="pp">|</span> 0.50         <span class="pp">|</span> 0.52         <span class="pp">|</span></span>
<span id="cb67-1370"><a href="#cb67-1370" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 3    <span class="pp">|</span> 0.50         <span class="pp">|</span> 0.47         <span class="pp">|</span></span>
<span id="cb67-1371"><a href="#cb67-1371" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 4    <span class="pp">|</span> 0.50         <span class="pp">|</span> 0.53         <span class="pp">|</span></span>
<span id="cb67-1372"><a href="#cb67-1372" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 5    <span class="pp">|</span> 0.50         <span class="pp">|</span> 0.49         <span class="pp">|</span></span>
<span id="cb67-1373"><a href="#cb67-1373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1374"><a href="#cb67-1374" aria-hidden="true" tabindex="-1"></a>The **standard deviation** of G among full-siblings is typically ~0.03-0.04. This small variation is enough to improve genomic predictions significantly, because it captures which siblings inherited more favorable alleles.</span>
<span id="cb67-1375"><a href="#cb67-1375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1376"><a href="#cb67-1376" aria-hidden="true" tabindex="-1"></a><span class="fu">### R Demonstration: Comparing A and G Matrices</span></span>
<span id="cb67-1377"><a href="#cb67-1377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1378"><a href="#cb67-1378" aria-hidden="true" tabindex="-1"></a>Let's simulate a small pedigree, calculate both A and G matrices, and visualize the differences.</span>
<span id="cb67-1379"><a href="#cb67-1379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1382"><a href="#cb67-1382" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb67-1383"><a href="#cb67-1383" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb67-1384"><a href="#cb67-1384" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb67-1385"><a href="#cb67-1385" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb67-1386"><a href="#cb67-1386" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.width: 12</span></span>
<span id="cb67-1387"><a href="#cb67-1387" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.height: 10</span></span>
<span id="cb67-1388"><a href="#cb67-1388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1389"><a href="#cb67-1389" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb67-1390"><a href="#cb67-1390" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)  <span class="co"># For melting matrices</span></span>
<span id="cb67-1391"><a href="#cb67-1391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1392"><a href="#cb67-1392" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">54321</span>)</span>
<span id="cb67-1393"><a href="#cb67-1393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1394"><a href="#cb67-1394" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate a pedigree: 2 parents, 8 full-sib offspring</span></span>
<span id="cb67-1395"><a href="#cb67-1395" aria-hidden="true" tabindex="-1"></a>n_offspring <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb67-1396"><a href="#cb67-1396" aria-hidden="true" tabindex="-1"></a>n_animals <span class="ot">&lt;-</span> <span class="dv">10</span>  <span class="co"># 2 parents + 8 offspring</span></span>
<span id="cb67-1397"><a href="#cb67-1397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1398"><a href="#cb67-1398" aria-hidden="true" tabindex="-1"></a>pedigree_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb67-1399"><a href="#cb67-1399" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span>n_animals,</span>
<span id="cb67-1400"><a href="#cb67-1400" aria-hidden="true" tabindex="-1"></a>  <span class="at">sire =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="fu">rep</span>(<span class="dv">1</span>, n_offspring)),   <span class="co"># Parent 1 is sire</span></span>
<span id="cb67-1401"><a href="#cb67-1401" aria-hidden="true" tabindex="-1"></a>  <span class="at">dam =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="fu">rep</span>(<span class="dv">2</span>, n_offspring))     <span class="co"># Parent 2 is dam</span></span>
<span id="cb67-1402"><a href="#cb67-1402" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb67-1403"><a href="#cb67-1403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1404"><a href="#cb67-1404" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Pedigree structure:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb67-1405"><a href="#cb67-1405" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pedigree_data)</span>
<span id="cb67-1406"><a href="#cb67-1406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1407"><a href="#cb67-1407" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate pedigree relationship matrix (A) manually</span></span>
<span id="cb67-1408"><a href="#cb67-1408" aria-hidden="true" tabindex="-1"></a><span class="co"># For this simple pedigree (2 unrelated parents, 8 full-sib offspring)</span></span>
<span id="cb67-1409"><a href="#cb67-1409" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> n_animals, <span class="at">ncol =</span> n_animals)</span>
<span id="cb67-1410"><a href="#cb67-1410" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(A) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(A) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Anim_"</span>, <span class="dv">1</span><span class="sc">:</span>n_animals)</span>
<span id="cb67-1411"><a href="#cb67-1411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1412"><a href="#cb67-1412" aria-hidden="true" tabindex="-1"></a><span class="co"># Diagonal elements (self-relationships) = 1</span></span>
<span id="cb67-1413"><a href="#cb67-1413" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(A) <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb67-1414"><a href="#cb67-1414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1415"><a href="#cb67-1415" aria-hidden="true" tabindex="-1"></a><span class="co"># Parents are unrelated to each other (A[1,2] = A[2,1] = 0)</span></span>
<span id="cb67-1416"><a href="#cb67-1416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1417"><a href="#cb67-1417" aria-hidden="true" tabindex="-1"></a><span class="co"># Parent-offspring relationships = 0.5</span></span>
<span id="cb67-1418"><a href="#cb67-1418" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">3</span><span class="sc">:</span>n_animals) {</span>
<span id="cb67-1419"><a href="#cb67-1419" aria-hidden="true" tabindex="-1"></a>  A[<span class="dv">1</span>, i] <span class="ot">&lt;-</span> A[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fl">0.5</span>  <span class="co"># Sire to offspring</span></span>
<span id="cb67-1420"><a href="#cb67-1420" aria-hidden="true" tabindex="-1"></a>  A[<span class="dv">2</span>, i] <span class="ot">&lt;-</span> A[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fl">0.5</span>  <span class="co"># Dam to offspring</span></span>
<span id="cb67-1421"><a href="#cb67-1421" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb67-1422"><a href="#cb67-1422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1423"><a href="#cb67-1423" aria-hidden="true" tabindex="-1"></a><span class="co"># Full-sib relationships = 0.5</span></span>
<span id="cb67-1424"><a href="#cb67-1424" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">3</span><span class="sc">:</span>n_animals) {</span>
<span id="cb67-1425"><a href="#cb67-1425" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">3</span><span class="sc">:</span>n_animals) {</span>
<span id="cb67-1426"><a href="#cb67-1426" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (i <span class="sc">!=</span> j) {</span>
<span id="cb67-1427"><a href="#cb67-1427" aria-hidden="true" tabindex="-1"></a>      A[i, j] <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb67-1428"><a href="#cb67-1428" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb67-1429"><a href="#cb67-1429" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb67-1430"><a href="#cb67-1430" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb67-1431"><a href="#cb67-1431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1432"><a href="#cb67-1432" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Pedigree relationship matrix (A):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb67-1433"><a href="#cb67-1433" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(A, <span class="dv">3</span>))</span>
<span id="cb67-1434"><a href="#cb67-1434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1435"><a href="#cb67-1435" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate genotypes for all 10 animals (1000 SNPs)</span></span>
<span id="cb67-1436"><a href="#cb67-1436" aria-hidden="true" tabindex="-1"></a>n_snps <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb67-1437"><a href="#cb67-1437" aria-hidden="true" tabindex="-1"></a>allele_freqs <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_snps, <span class="fl">0.2</span>, <span class="fl">0.8</span>)</span>
<span id="cb67-1438"><a href="#cb67-1438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1439"><a href="#cb67-1439" aria-hidden="true" tabindex="-1"></a><span class="co"># Parents: random genotypes</span></span>
<span id="cb67-1440"><a href="#cb67-1440" aria-hidden="true" tabindex="-1"></a>parent1_geno <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n_snps, <span class="dv">2</span>, allele_freqs)</span>
<span id="cb67-1441"><a href="#cb67-1441" aria-hidden="true" tabindex="-1"></a>parent2_geno <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n_snps, <span class="dv">2</span>, allele_freqs)</span>
<span id="cb67-1442"><a href="#cb67-1442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1443"><a href="#cb67-1443" aria-hidden="true" tabindex="-1"></a><span class="co"># Offspring: inherit from parents (Mendelian segregation)</span></span>
<span id="cb67-1444"><a href="#cb67-1444" aria-hidden="true" tabindex="-1"></a>offspring_geno <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> n_offspring, <span class="at">ncol =</span> n_snps)</span>
<span id="cb67-1445"><a href="#cb67-1445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1446"><a href="#cb67-1446" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_offspring) {</span>
<span id="cb67-1447"><a href="#cb67-1447" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_snps) {</span>
<span id="cb67-1448"><a href="#cb67-1448" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Each offspring gets one allele from each parent</span></span>
<span id="cb67-1449"><a href="#cb67-1449" aria-hidden="true" tabindex="-1"></a>    allele_from_parent1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dv">1</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="dv">2</span> <span class="sc">-</span> parent1_geno[j], parent1_geno[j]) <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb67-1450"><a href="#cb67-1450" aria-hidden="true" tabindex="-1"></a>    allele_from_parent2 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dv">1</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="dv">2</span> <span class="sc">-</span> parent2_geno[j], parent2_geno[j]) <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb67-1451"><a href="#cb67-1451" aria-hidden="true" tabindex="-1"></a>    offspring_geno[i, j] <span class="ot">&lt;-</span> allele_from_parent1 <span class="sc">+</span> allele_from_parent2</span>
<span id="cb67-1452"><a href="#cb67-1452" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb67-1453"><a href="#cb67-1453" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb67-1454"><a href="#cb67-1454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1455"><a href="#cb67-1455" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine into full genotype matrix</span></span>
<span id="cb67-1456"><a href="#cb67-1456" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">rbind</span>(parent1_geno, parent2_geno, offspring_geno)</span>
<span id="cb67-1457"><a href="#cb67-1457" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(M) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Anim_"</span>, <span class="dv">1</span><span class="sc">:</span>n_animals)</span>
<span id="cb67-1458"><a href="#cb67-1458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1459"><a href="#cb67-1459" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate genomic relationship matrix (G) using VanRaden's method</span></span>
<span id="cb67-1460"><a href="#cb67-1460" aria-hidden="true" tabindex="-1"></a>p_j <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(M) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb67-1461"><a href="#cb67-1461" aria-hidden="true" tabindex="-1"></a>P <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="dv">2</span> <span class="sc">*</span> p_j, <span class="at">each =</span> n_animals), <span class="at">nrow =</span> n_animals)</span>
<span id="cb67-1462"><a href="#cb67-1462" aria-hidden="true" tabindex="-1"></a>Z <span class="ot">&lt;-</span> M <span class="sc">-</span> P</span>
<span id="cb67-1463"><a href="#cb67-1463" aria-hidden="true" tabindex="-1"></a>denom <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">sum</span>(p_j <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p_j))</span>
<span id="cb67-1464"><a href="#cb67-1464" aria-hidden="true" tabindex="-1"></a>G <span class="ot">&lt;-</span> (Z <span class="sc">%*%</span> <span class="fu">t</span>(Z)) <span class="sc">/</span> denom</span>
<span id="cb67-1465"><a href="#cb67-1465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1466"><a href="#cb67-1466" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Genomic relationship matrix (G):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb67-1467"><a href="#cb67-1467" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(G, <span class="dv">3</span>))</span>
<span id="cb67-1468"><a href="#cb67-1468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1469"><a href="#cb67-1469" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare A and G for full-sibs (offspring only, rows/cols 3-10)</span></span>
<span id="cb67-1470"><a href="#cb67-1470" aria-hidden="true" tabindex="-1"></a>fullsib_indices <span class="ot">&lt;-</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb67-1471"><a href="#cb67-1471" aria-hidden="true" tabindex="-1"></a>A_fullsibs <span class="ot">&lt;-</span> A[fullsib_indices, fullsib_indices]</span>
<span id="cb67-1472"><a href="#cb67-1472" aria-hidden="true" tabindex="-1"></a>G_fullsibs <span class="ot">&lt;-</span> G[fullsib_indices, fullsib_indices]</span>
<span id="cb67-1473"><a href="#cb67-1473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1474"><a href="#cb67-1474" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract off-diagonal elements (pairwise relationships)</span></span>
<span id="cb67-1475"><a href="#cb67-1475" aria-hidden="true" tabindex="-1"></a>A_offd <span class="ot">&lt;-</span> A_fullsibs[<span class="fu">lower.tri</span>(A_fullsibs)]</span>
<span id="cb67-1476"><a href="#cb67-1476" aria-hidden="true" tabindex="-1"></a>G_offd <span class="ot">&lt;-</span> G_fullsibs[<span class="fu">lower.tri</span>(G_fullsibs)]</span>
<span id="cb67-1477"><a href="#cb67-1477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1478"><a href="#cb67-1478" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Full-sibling relationships (off-diagonal):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb67-1479"><a href="#cb67-1479" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"A (pedigree): All ="</span>, <span class="fu">unique</span>(<span class="fu">round</span>(A_offd, <span class="dv">3</span>)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb67-1480"><a href="#cb67-1480" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"G (genomic): Mean ="</span>, <span class="fu">round</span>(<span class="fu">mean</span>(G_offd), <span class="dv">3</span>),</span>
<span id="cb67-1481"><a href="#cb67-1481" aria-hidden="true" tabindex="-1"></a>    <span class="st">", SD ="</span>, <span class="fu">round</span>(<span class="fu">sd</span>(G_offd), <span class="dv">3</span>),</span>
<span id="cb67-1482"><a href="#cb67-1482" aria-hidden="true" tabindex="-1"></a>    <span class="st">", Range = ["</span>, <span class="fu">round</span>(<span class="fu">min</span>(G_offd), <span class="dv">3</span>), <span class="st">","</span>, <span class="fu">round</span>(<span class="fu">max</span>(G_offd), <span class="dv">3</span>), <span class="st">"]</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb67-1483"><a href="#cb67-1483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1484"><a href="#cb67-1484" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize A and G matrices side-by-side as heatmaps</span></span>
<span id="cb67-1485"><a href="#cb67-1485" aria-hidden="true" tabindex="-1"></a>A_melted <span class="ot">&lt;-</span> <span class="fu">melt</span>(A)</span>
<span id="cb67-1486"><a href="#cb67-1486" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(A_melted) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Animal_1"</span>, <span class="st">"Animal_2"</span>, <span class="st">"Relationship"</span>)</span>
<span id="cb67-1487"><a href="#cb67-1487" aria-hidden="true" tabindex="-1"></a>A_melted<span class="sc">$</span>Matrix <span class="ot">&lt;-</span> <span class="st">"A (Pedigree)"</span></span>
<span id="cb67-1488"><a href="#cb67-1488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1489"><a href="#cb67-1489" aria-hidden="true" tabindex="-1"></a>G_melted <span class="ot">&lt;-</span> <span class="fu">melt</span>(G)</span>
<span id="cb67-1490"><a href="#cb67-1490" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(G_melted) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Animal_1"</span>, <span class="st">"Animal_2"</span>, <span class="st">"Relationship"</span>)</span>
<span id="cb67-1491"><a href="#cb67-1491" aria-hidden="true" tabindex="-1"></a>G_melted<span class="sc">$</span>Matrix <span class="ot">&lt;-</span> <span class="st">"G (Genomic)"</span></span>
<span id="cb67-1492"><a href="#cb67-1492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1493"><a href="#cb67-1493" aria-hidden="true" tabindex="-1"></a>combined_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(A_melted, G_melted)</span>
<span id="cb67-1494"><a href="#cb67-1494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1495"><a href="#cb67-1495" aria-hidden="true" tabindex="-1"></a>p_heatmap <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(combined_data, <span class="fu">aes</span>(<span class="at">x =</span> Animal_1, <span class="at">y =</span> Animal_2, <span class="at">fill =</span> Relationship)) <span class="sc">+</span></span>
<span id="cb67-1496"><a href="#cb67-1496" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb67-1497"><a href="#cb67-1497" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Matrix, <span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb67-1498"><a href="#cb67-1498" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">mid =</span> <span class="st">"white"</span>, <span class="at">high =</span> <span class="st">"red"</span>,</span>
<span id="cb67-1499"><a href="#cb67-1499" aria-hidden="true" tabindex="-1"></a>                       <span class="at">midpoint =</span> <span class="dv">0</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.2</span>, <span class="fl">1.2</span>), <span class="at">name =</span> <span class="st">"Relationship"</span>) <span class="sc">+</span></span>
<span id="cb67-1500"><a href="#cb67-1500" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Comparison of Pedigree (A) and Genomic (G) Relationship Matrices"</span>,</span>
<span id="cb67-1501"><a href="#cb67-1501" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"2 parents + 8 full-sib offspring"</span>) <span class="sc">+</span></span>
<span id="cb67-1502"><a href="#cb67-1502" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb67-1503"><a href="#cb67-1503" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb67-1504"><a href="#cb67-1504" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb67-1505"><a href="#cb67-1505" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span>
<span id="cb67-1506"><a href="#cb67-1506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1507"><a href="#cb67-1507" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p_heatmap)</span>
<span id="cb67-1508"><a href="#cb67-1508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1509"><a href="#cb67-1509" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot: A vs. G relationships (off-diagonal only)</span></span>
<span id="cb67-1510"><a href="#cb67-1510" aria-hidden="true" tabindex="-1"></a>comparison_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb67-1511"><a href="#cb67-1511" aria-hidden="true" tabindex="-1"></a>  <span class="at">A_relationship =</span> A[<span class="fu">lower.tri</span>(A)],</span>
<span id="cb67-1512"><a href="#cb67-1512" aria-hidden="true" tabindex="-1"></a>  <span class="at">G_relationship =</span> G[<span class="fu">lower.tri</span>(G)]</span>
<span id="cb67-1513"><a href="#cb67-1513" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb67-1514"><a href="#cb67-1514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1515"><a href="#cb67-1515" aria-hidden="true" tabindex="-1"></a>p_scatter <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(comparison_df, <span class="fu">aes</span>(<span class="at">x =</span> A_relationship, <span class="at">y =</span> G_relationship)) <span class="sc">+</span></span>
<span id="cb67-1516"><a href="#cb67-1516" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb67-1517"><a href="#cb67-1517" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb67-1518"><a href="#cb67-1518" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Pedigree (A) vs. Genomic (G) Relationships"</span>,</span>
<span id="cb67-1519"><a href="#cb67-1519" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"Points on red line = perfect agreement; scatter = Mendelian sampling variation"</span>,</span>
<span id="cb67-1520"><a href="#cb67-1520" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Pedigree Relationship (A)"</span>,</span>
<span id="cb67-1521"><a href="#cb67-1521" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Genomic Relationship (G)"</span>) <span class="sc">+</span></span>
<span id="cb67-1522"><a href="#cb67-1522" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb67-1523"><a href="#cb67-1523" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="at">ratio =</span> <span class="dv">1</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="dv">1</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="dv">1</span>))</span>
<span id="cb67-1524"><a href="#cb67-1524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1525"><a href="#cb67-1525" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p_scatter)</span>
<span id="cb67-1526"><a href="#cb67-1526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1527"><a href="#cb67-1527" aria-hidden="true" tabindex="-1"></a><span class="co"># Highlight full-sib variation</span></span>
<span id="cb67-1528"><a href="#cb67-1528" aria-hidden="true" tabindex="-1"></a>fullsib_comparison <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb67-1529"><a href="#cb67-1529" aria-hidden="true" tabindex="-1"></a>  <span class="at">Pair =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(G_offd),</span>
<span id="cb67-1530"><a href="#cb67-1530" aria-hidden="true" tabindex="-1"></a>  <span class="at">A =</span> A_offd,</span>
<span id="cb67-1531"><a href="#cb67-1531" aria-hidden="true" tabindex="-1"></a>  <span class="at">G =</span> G_offd,</span>
<span id="cb67-1532"><a href="#cb67-1532" aria-hidden="true" tabindex="-1"></a>  <span class="at">Difference =</span> G_offd <span class="sc">-</span> A_offd</span>
<span id="cb67-1533"><a href="#cb67-1533" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb67-1534"><a href="#cb67-1534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1535"><a href="#cb67-1535" aria-hidden="true" tabindex="-1"></a>p_fullsibs <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(fullsib_comparison, <span class="fu">aes</span>(<span class="at">x =</span> Pair)) <span class="sc">+</span></span>
<span id="cb67-1536"><a href="#cb67-1536" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> A, <span class="at">color =</span> <span class="st">"Expected (A)"</span>), <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb67-1537"><a href="#cb67-1537" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> G, <span class="at">color =</span> <span class="st">"Realized (G)"</span>), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb67-1538"><a href="#cb67-1538" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> G, <span class="at">color =</span> <span class="st">"Realized (G)"</span>), <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb67-1539"><a href="#cb67-1539" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Expected (A)"</span> <span class="ot">=</span> <span class="st">"black"</span>, <span class="st">"Realized (G)"</span> <span class="ot">=</span> <span class="st">"steelblue"</span>),</span>
<span id="cb67-1540"><a href="#cb67-1540" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name =</span> <span class="st">"Relationship"</span>) <span class="sc">+</span></span>
<span id="cb67-1541"><a href="#cb67-1541" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Full-Sibling Relationships: Expected vs. Realized"</span>,</span>
<span id="cb67-1542"><a href="#cb67-1542" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"All pairs are full-sibs (same parents), but realized relationships vary"</span>,</span>
<span id="cb67-1543"><a href="#cb67-1543" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Sibling Pair"</span>,</span>
<span id="cb67-1544"><a href="#cb67-1544" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Relationship"</span>) <span class="sc">+</span></span>
<span id="cb67-1545"><a href="#cb67-1545" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb67-1546"><a href="#cb67-1546" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb67-1547"><a href="#cb67-1547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1548"><a href="#cb67-1548" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p_fullsibs)</span>
<span id="cb67-1549"><a href="#cb67-1549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1550"><a href="#cb67-1550" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Key observation: G captures Mendelian sampling variation that A cannot.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb67-1551"><a href="#cb67-1551" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"This variation improves genomic prediction accuracy.</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb67-1552"><a href="#cb67-1552" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb67-1553"><a href="#cb67-1553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1554"><a href="#cb67-1554" aria-hidden="true" tabindex="-1"></a>**Interpretation**:</span>
<span id="cb67-1555"><a href="#cb67-1555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1556"><a href="#cb67-1556" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Heatmaps**: The A matrix shows perfect symmetry and fixed values (all full-sibs = 0.50). The G matrix shows variation around those expected values—some pairs share more genome, others less.</span>
<span id="cb67-1557"><a href="#cb67-1557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1558"><a href="#cb67-1558" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Scatter plot**: Points scatter around the y = x line. The scatter represents **Mendelian sampling**—the realized sharing of genome differs from the expected sharing. This scatter is genetic information that improves predictions.</span>
<span id="cb67-1559"><a href="#cb67-1559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1560"><a href="#cb67-1560" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Full-sib variation**: Even though all offspring pairs are full-siblings (same parents), their genomic relationships range from ~0.46 to 0.54. The animals with G &gt; 0.50 inherited more similar chromosome segments; those with G &lt; 0.50 inherited more different segments.</span>
<span id="cb67-1561"><a href="#cb67-1561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1562"><a href="#cb67-1562" aria-hidden="true" tabindex="-1"></a>**Why this matters for genomic selection**:</span>
<span id="cb67-1563"><a href="#cb67-1563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1564"><a href="#cb67-1564" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>G differentiates among relatives who A treats identically</span>
<span id="cb67-1565"><a href="#cb67-1565" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>This extra information increases accuracy of genomic predictions</span>
<span id="cb67-1566"><a href="#cb67-1566" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Example**: Two full-sib bulls might have A = 0.50 (identical), but G = 0.48 vs. 0.52. The bull with G = 0.52 is more similar to his high-producing sisters, so his GEBV for milk yield will be higher—even though they have the same pedigree!</span>
<span id="cb67-1567"><a href="#cb67-1567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1568"><a href="#cb67-1568" aria-hidden="true" tabindex="-1"></a>This is the essence of why genomic selection works better than pedigree-based selection.</span>
<span id="cb67-1569"><a href="#cb67-1569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1570"><a href="#cb67-1570" aria-hidden="true" tabindex="-1"></a><span class="fu">## Impact of Genomic Selection on Livestock Breeding</span></span>
<span id="cb67-1571"><a href="#cb67-1571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1572"><a href="#cb67-1572" aria-hidden="true" tabindex="-1"></a>Genomic selection has transformed livestock breeding in ways that would have seemed impossible two decades ago. The speed and scale of genetic improvement have accelerated dramatically, creating economic value and addressing food security challenges. Let's examine the impact in major livestock species.</span>
<span id="cb67-1573"><a href="#cb67-1573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1574"><a href="#cb67-1574" aria-hidden="true" tabindex="-1"></a><span class="fu">### Dairy Cattle: The Genomic Revolution</span></span>
<span id="cb67-1575"><a href="#cb67-1575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1576"><a href="#cb67-1576" aria-hidden="true" tabindex="-1"></a>**Before genomics** (pre-2009):</span>
<span id="cb67-1577"><a href="#cb67-1577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1578"><a href="#cb67-1578" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Young bulls underwent **progeny testing**: mated to hundreds of cows, wait for daughters to lactate, measure milk production</span>
<span id="cb67-1579"><a href="#cb67-1579" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Generation interval**: 6-7 years (birth → daughters born → daughters mature → daughters produce milk → bull evaluated)</span>
<span id="cb67-1580"><a href="#cb67-1580" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Accuracy**: Very high (r ≈ 0.85-0.90) after 50-100 daughters, but slow</span>
<span id="cb67-1581"><a href="#cb67-1581" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Cost**: $25,000-$50,000 per bull for progeny testing</span>
<span id="cb67-1582"><a href="#cb67-1582" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Genetic gain**: ~100-120 kg milk per year</span>
<span id="cb67-1583"><a href="#cb67-1583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1584"><a href="#cb67-1584" aria-hidden="true" tabindex="-1"></a>**After genomics** (2009-present):</span>
<span id="cb67-1585"><a href="#cb67-1585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1586"><a href="#cb67-1586" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Young bulls **genotyped at birth**, GEBVs calculated immediately</span>
<span id="cb67-1587"><a href="#cb67-1587" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Generation interval**: 2.5-3 years (bulls used at 1-2 years of age)</span>
<span id="cb67-1588"><a href="#cb67-1588" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Accuracy**: Moderate to high (r ≈ 0.65-0.75) for genomic young bulls, without any daughters</span>
<span id="cb67-1589"><a href="#cb67-1589" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Cost**: $50-$100 for genotyping (1000× cheaper than progeny testing!)</span>
<span id="cb67-1590"><a href="#cb67-1590" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Genetic gain**: ~230-250 kg milk per year (**doubled** compared to pre-genomics)</span>
<span id="cb67-1591"><a href="#cb67-1591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1592"><a href="#cb67-1592" aria-hidden="true" tabindex="-1"></a>**Key statistics (U.S. Holsteins)**:</span>
<span id="cb67-1593"><a href="#cb67-1593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1594"><a href="#cb67-1594" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Annual genetic gain for milk yield increased from 120 kg/year (2000-2008) to 250 kg/year (2010-2020)</span>
<span id="cb67-1595"><a href="#cb67-1595" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Generation interval decreased from 6.5 years to 2.8 years</span>
<span id="cb67-1596"><a href="#cb67-1596" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Proportion of bulls progeny-tested dropped from 100% to &lt;10% (only elite sires are progeny-tested now)</span>
<span id="cb67-1597"><a href="#cb67-1597" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Genomic breeding values now standard for all traits (milk, fat, protein, fertility, health, longevity)</span>
<span id="cb67-1598"><a href="#cb67-1598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1599"><a href="#cb67-1599" aria-hidden="true" tabindex="-1"></a>**Economic impact**:</span>
<span id="cb67-1600"><a href="#cb67-1600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1601"><a href="#cb67-1601" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>U.S. dairy industry saves &gt;$100 million/year in progeny testing costs</span>
<span id="cb67-1602"><a href="#cb67-1602" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Faster genetic gain adds ~$300 million/year in productivity improvements</span>
<span id="cb67-1603"><a href="#cb67-1603" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Total economic benefit: ~$400 million/year</span>
<span id="cb67-1604"><a href="#cb67-1604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1605"><a href="#cb67-1605" aria-hidden="true" tabindex="-1"></a><span class="fu">### Swine: Precision Breeding at Scale</span></span>
<span id="cb67-1606"><a href="#cb67-1606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1607"><a href="#cb67-1607" aria-hidden="true" tabindex="-1"></a>**Key applications**:</span>
<span id="cb67-1608"><a href="#cb67-1608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1609"><a href="#cb67-1609" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Feed efficiency**: Genomic selection enables accurate evaluation without expensive individual feed intake measurement</span>
<span id="cb67-1610"><a href="#cb67-1610" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Before genomics: Feed efficiency required individual intake recording (expensive, labor-intensive)</span>
<span id="cb67-1611"><a href="#cb67-1611" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>With genomics: Select for feed efficiency using GEBVs (r ≈ 0.50-0.60), measure only a training population</span>
<span id="cb67-1612"><a href="#cb67-1612" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Result: Genetic gain for feed efficiency increased 2-3×</span>
<span id="cb67-1613"><a href="#cb67-1613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1614"><a href="#cb67-1614" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Litter size**: Low heritability (h² ≈ 0.10-0.15) trait benefits greatly from genomics</span>
<span id="cb67-1615"><a href="#cb67-1615" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Genomic selection improves accuracy by 30-50% compared to pedigree</span>
<span id="cb67-1616"><a href="#cb67-1616" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Faster improvement in number of pigs born alive and weaned</span>
<span id="cb67-1617"><a href="#cb67-1617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1618"><a href="#cb67-1618" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Crossbred performance**: Genomic evaluations now predict crossbred performance directly</span>
<span id="cb67-1619"><a href="#cb67-1619" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Purebred selection doesn't always improve crossbred performance</span>
<span id="cb67-1620"><a href="#cb67-1620" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Genomic models trained on crossbred data improve crossbred outcomes</span>
<span id="cb67-1621"><a href="#cb67-1621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1622"><a href="#cb67-1622" aria-hidden="true" tabindex="-1"></a>**Timeline**:</span>
<span id="cb67-1623"><a href="#cb67-1623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1624"><a href="#cb67-1624" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>2011-2014: Major breeding companies (PIC, Topigs Norsvin, Genesus) adopt genomic selection</span>
<span id="cb67-1625"><a href="#cb67-1625" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>2015-present: Single-step genomic BLUP becomes standard</span>
<span id="cb67-1626"><a href="#cb67-1626" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Training populations now exceed 20,000-50,000 animals in major companies</span>
<span id="cb67-1627"><a href="#cb67-1627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1628"><a href="#cb67-1628" aria-hidden="true" tabindex="-1"></a>**Impact**:</span>
<span id="cb67-1629"><a href="#cb67-1629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1630"><a href="#cb67-1630" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Generation interval reduced from 1.8 years to 1.2 years</span>
<span id="cb67-1631"><a href="#cb67-1631" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Genetic gain increased by 30-50% for most traits</span>
<span id="cb67-1632"><a href="#cb67-1632" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Enabled selection for novel traits (disease resistance, welfare indicators)</span>
<span id="cb67-1633"><a href="#cb67-1633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1634"><a href="#cb67-1634" aria-hidden="true" tabindex="-1"></a><span class="fu">### Poultry: Extreme Selection Intensity</span></span>
<span id="cb67-1635"><a href="#cb67-1635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1636"><a href="#cb67-1636" aria-hidden="true" tabindex="-1"></a>**Unique advantages for genomics in poultry**:</span>
<span id="cb67-1637"><a href="#cb67-1637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1638"><a href="#cb67-1638" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Huge training populations**: 20,000-100,000 birds genotyped (low genotyping cost, high bird numbers)</span>
<span id="cb67-1639"><a href="#cb67-1639" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**High selection intensity**: Thousands of candidates evaluated, top 1-5% selected</span>
<span id="cb67-1640"><a href="#cb67-1640" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Family-based structure**: Pedigree hatching allows family evaluation with genomic data</span>
<span id="cb67-1641"><a href="#cb67-1641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1642"><a href="#cb67-1642" aria-hidden="true" tabindex="-1"></a>**Applications**:</span>
<span id="cb67-1643"><a href="#cb67-1643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1644"><a href="#cb67-1644" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Growth rate**: Already high h², but genomics reduces generation interval</span>
<span id="cb67-1645"><a href="#cb67-1645" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Feed efficiency**: Expensive to measure individually, genomics enables accurate selection</span>
<span id="cb67-1646"><a href="#cb67-1646" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Leg health**: Low h², improved dramatically with genomics (welfare benefit)</span>
<span id="cb67-1647"><a href="#cb67-1647" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Disease resistance**: Genomic selection for specific pathogen resistance (e.g., Marek's disease, Salmonella)</span>
<span id="cb67-1648"><a href="#cb67-1648" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Egg production and quality**: Maintained high production while improving shell strength, egg size uniformity</span>
<span id="cb67-1649"><a href="#cb67-1649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1650"><a href="#cb67-1650" aria-hidden="true" tabindex="-1"></a>**Impact**:</span>
<span id="cb67-1651"><a href="#cb67-1651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1652"><a href="#cb67-1652" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Genetic gain increased 20-40% for most traits</span>
<span id="cb67-1653"><a href="#cb67-1653" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Generation interval: already short (9-12 months), but genomics allows earlier selection (select at hatch based on parents' GEBVs)</span>
<span id="cb67-1654"><a href="#cb67-1654" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Accuracy for young birds: r ≈ 0.60-0.75 (very high due to large training populations)</span>
<span id="cb67-1655"><a href="#cb67-1655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1656"><a href="#cb67-1656" aria-hidden="true" tabindex="-1"></a>**Example**: Broiler body weight at 6 weeks increased from ~2.5 kg (2000) to ~3.0 kg (2020), with much of the acceleration post-2010 due to genomics.</span>
<span id="cb67-1657"><a href="#cb67-1657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1658"><a href="#cb67-1658" aria-hidden="true" tabindex="-1"></a><span class="fu">### Beef Cattle: Decentralized Adoption</span></span>
<span id="cb67-1659"><a href="#cb67-1659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1660"><a href="#cb67-1660" aria-hidden="true" tabindex="-1"></a>**Challenges unique to beef**:</span>
<span id="cb67-1661"><a href="#cb67-1661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1662"><a href="#cb67-1662" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Decentralized industry (many independent breeders)</span>
<span id="cb67-1663"><a href="#cb67-1663" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Smaller training populations than dairy</span>
<span id="cb67-1664"><a href="#cb67-1664" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Phenotypes harder to collect (carcass traits measured post-slaughter)</span>
<span id="cb67-1665"><a href="#cb67-1665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1666"><a href="#cb67-1666" aria-hidden="true" tabindex="-1"></a>**Progress**:</span>
<span id="cb67-1667"><a href="#cb67-1667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1668"><a href="#cb67-1668" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Genomic EPDs** available since 2012-2015 for major breeds</span>
<span id="cb67-1669"><a href="#cb67-1669" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**American Angus Association** implemented single-step GBLUP in 2017</span>
<span id="cb67-1670"><a href="#cb67-1670" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Now standard for young bull selection in seedstock herds</span>
<span id="cb67-1671"><a href="#cb67-1671" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Particularly valuable for:</span>
<span id="cb67-1672"><a href="#cb67-1672" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**Carcass traits** (marbling, ribeye area): Can't measure on live animals, genomics enables selection without progeny slaughter</span>
<span id="cb67-1673"><a href="#cb67-1673" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**Feed efficiency**: Expensive to measure, genomics reduces cost</span>
<span id="cb67-1674"><a href="#cb67-1674" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>**Docility and calving ease**: Low h², genomics improves accuracy</span>
<span id="cb67-1675"><a href="#cb67-1675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1676"><a href="#cb67-1676" aria-hidden="true" tabindex="-1"></a>**Adoption**:</span>
<span id="cb67-1677"><a href="#cb67-1677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1678"><a href="#cb67-1678" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>~40-60% of young bulls in major breeds are now genomically evaluated</span>
<span id="cb67-1679"><a href="#cb67-1679" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Smaller uptake than dairy (less integration, lower ROI for small breeders)</span>
<span id="cb67-1680"><a href="#cb67-1680" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Rapidly growing as genotyping costs decrease</span>
<span id="cb67-1681"><a href="#cb67-1681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1682"><a href="#cb67-1682" aria-hidden="true" tabindex="-1"></a>**Impact**:</span>
<span id="cb67-1683"><a href="#cb67-1683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1684"><a href="#cb67-1684" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Young bull accuracy increased from r ≈ 0.30 (parent average) to r ≈ 0.45-0.55 (genomic)</span>
<span id="cb67-1685"><a href="#cb67-1685" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Genetic gain increased 15-30% (less dramatic than dairy, but significant)</span>
<span id="cb67-1686"><a href="#cb67-1686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1687"><a href="#cb67-1687" aria-hidden="true" tabindex="-1"></a><span class="fu">### Sheep: Emerging Adoption</span></span>
<span id="cb67-1688"><a href="#cb67-1688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1689"><a href="#cb67-1689" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>LAMBPLAN (Australia) and NSIP (US) offer genomic evaluations</span>
<span id="cb67-1690"><a href="#cb67-1690" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Smaller training populations (5,000-15,000 animals)</span>
<span id="cb67-1691"><a href="#cb67-1691" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Accuracy improvements modest but valuable</span>
<span id="cb67-1692"><a href="#cb67-1692" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Cost-benefit still being established for commercial producers</span>
<span id="cb67-1693"><a href="#cb67-1693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1694"><a href="#cb67-1694" aria-hidden="true" tabindex="-1"></a><span class="fu">### Summary of Industry Impact</span></span>
<span id="cb67-1695"><a href="#cb67-1695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1696"><a href="#cb67-1696" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Species <span class="pp">|</span> Adoption Year <span class="pp">|</span> Genetic Gain Increase <span class="pp">|</span> Generation Interval Change <span class="pp">|</span> Key Benefit <span class="pp">|</span></span>
<span id="cb67-1697"><a href="#cb67-1697" aria-hidden="true" tabindex="-1"></a><span class="pp">|---------|---------------|----------------------|----------------------------|-------------|</span></span>
<span id="cb67-1698"><a href="#cb67-1698" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Dairy** <span class="pp">|</span> 2009 <span class="pp">|</span> 2× (doubled) <span class="pp">|</span> 6.5 yr → 2.8 yr <span class="pp">|</span> Eliminated progeny testing <span class="pp">|</span></span>
<span id="cb67-1699"><a href="#cb67-1699" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Swine** <span class="pp">|</span> 2011-2014 <span class="pp">|</span> 1.3-1.5× <span class="pp">|</span> 1.8 yr → 1.2 yr <span class="pp">|</span> Feed efficiency, crossbred performance <span class="pp">|</span></span>
<span id="cb67-1700"><a href="#cb67-1700" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Poultry** <span class="pp">|</span> 2010-2015 <span class="pp">|</span> 1.2-1.4× <span class="pp">|</span> Minimal change (already short) <span class="pp">|</span> Leg health, disease resistance <span class="pp">|</span></span>
<span id="cb67-1701"><a href="#cb67-1701" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Beef** <span class="pp">|</span> 2012-2017 <span class="pp">|</span> 1.15-1.30× <span class="pp">|</span> Moderate decrease <span class="pp">|</span> Carcass traits, young bull accuracy <span class="pp">|</span></span>
<span id="cb67-1702"><a href="#cb67-1702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1703"><a href="#cb67-1703" aria-hidden="true" tabindex="-1"></a>Genomic selection is now the **industry standard** in all major livestock species. The technology has matured from experimental (2008-2010) to routine (2015+), delivering sustained economic value and accelerating genetic progress worldwide.</span>
<span id="cb67-1704"><a href="#cb67-1704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1705"><a href="#cb67-1705" aria-hidden="true" tabindex="-1"></a><span class="fu">## Summary</span></span>
<span id="cb67-1706"><a href="#cb67-1706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1707"><a href="#cb67-1707" aria-hidden="true" tabindex="-1"></a>Genomic selection has revolutionized animal breeding by enabling accurate prediction of breeding values using genome-wide SNP data. This chapter covered the foundational concepts, methods, and industry impact of genomic selection.</span>
<span id="cb67-1708"><a href="#cb67-1708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1709"><a href="#cb67-1709" aria-hidden="true" tabindex="-1"></a><span class="fu">### Key Concepts</span></span>
<span id="cb67-1710"><a href="#cb67-1710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1711"><a href="#cb67-1711" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Genomic selection** predicts breeding values (GEBVs) from SNP genotypes, providing moderate to high accuracy for young animals without phenotypes or progeny data</span>
<span id="cb67-1712"><a href="#cb67-1712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1713"><a href="#cb67-1713" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Two approaches** to genomic prediction:</span>
<span id="cb67-1714"><a href="#cb67-1714" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>**Animal model (GBLUP)**: Estimates breeding values using genomic relationship matrix (G)</span>
<span id="cb67-1715"><a href="#cb67-1715" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>**Marker effects model (SNP-BLUP, Bayesian)**: Estimates effects of individual SNPs, then sums to get GEBVs</span>
<span id="cb67-1716"><a href="#cb67-1716" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>These approaches are mathematically equivalent under certain assumptions</span>
<span id="cb67-1717"><a href="#cb67-1717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1718"><a href="#cb67-1718" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**GBLUP** uses the genomic relationship matrix (G) to capture realized relationships between animals, accounting for Mendelian sampling that pedigree (A) cannot</span>
<span id="cb67-1719"><a href="#cb67-1719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1720"><a href="#cb67-1720" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Bayesian methods** (BayesA, B, C, Cπ, Lasso) allow SNPs to have different effect sizes and can improve accuracy for traits with major QTL</span>
<span id="cb67-1721"><a href="#cb67-1721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1722"><a href="#cb67-1722" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**Single-step GBLUP (ssGBLUP)** combines pedigree and genomic information in one unified analysis, making it the industry standard for routine evaluations</span>
<span id="cb67-1723"><a href="#cb67-1723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1724"><a href="#cb67-1724" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>**Accuracy** of genomic predictions depends on training population size (N), heritability (h²), effective population size (N_e), SNP density, and relationships between training and selection candidates</span>
<span id="cb67-1725"><a href="#cb67-1725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1726"><a href="#cb67-1726" aria-hidden="true" tabindex="-1"></a><span class="ss">7. </span>**Pedigree (A) vs. genomic (G)** relationships: G captures Mendelian sampling variation that A treats as constant, providing extra genetic information that improves predictions</span>
<span id="cb67-1727"><a href="#cb67-1727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1728"><a href="#cb67-1728" aria-hidden="true" tabindex="-1"></a><span class="ss">8. </span>**Industry impact**: Genomic selection has doubled genetic gain in dairy cattle, increased gain by 30-50% in swine and poultry, and transformed breeding programs across all major livestock species</span>
<span id="cb67-1729"><a href="#cb67-1729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1730"><a href="#cb67-1730" aria-hidden="true" tabindex="-1"></a><span class="fu">### The Big Picture</span></span>
<span id="cb67-1731"><a href="#cb67-1731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1732"><a href="#cb67-1732" aria-hidden="true" tabindex="-1"></a>Genomic selection broke the trade-off between accuracy and generation interval that constrained animal breeding for a century. By providing accurate breeding values at birth, genomic selection:</span>
<span id="cb67-1733"><a href="#cb67-1733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1734"><a href="#cb67-1734" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Reduces generation interval** (L) by eliminating progeny testing</span>
<span id="cb67-1735"><a href="#cb67-1735" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Increases accuracy** (r) for young animals without phenotypes</span>
<span id="cb67-1736"><a href="#cb67-1736" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Enables selection** for expensive-to-measure traits (feed efficiency, disease resistance, carcass quality)</span>
<span id="cb67-1737"><a href="#cb67-1737" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Accelerates genetic progress**: $R = i \times r \times \sigma_A / L$ increases due to higher r and lower L</span>
<span id="cb67-1738"><a href="#cb67-1738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1739"><a href="#cb67-1739" aria-hidden="true" tabindex="-1"></a>The result is faster, cheaper, and more effective genetic improvement—benefiting producers, consumers, and animal welfare.</span>
<span id="cb67-1740"><a href="#cb67-1740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1741"><a href="#cb67-1741" aria-hidden="true" tabindex="-1"></a><span class="fu">## Practice Problems</span></span>
<span id="cb67-1742"><a href="#cb67-1742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1743"><a href="#cb67-1743" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Conceptual understanding**: Explain why genomic selection is particularly beneficial for traits with low heritability (e.g., fertility, disease resistance). Why does genomic selection help more for these traits than for high-heritability traits?</span>
<span id="cb67-1744"><a href="#cb67-1744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1745"><a href="#cb67-1745" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Accuracy calculation**: A dairy breeding program has a training population of 5,000 bulls with phenotypes and genotypes. For a trait with h² = 0.25 and M_e = 1,200, estimate the accuracy of genomic predictions using the Daetwyler formula:</span>
<span id="cb67-1746"><a href="#cb67-1746" aria-hidden="true" tabindex="-1"></a>   $$r = \sqrt{\frac{N h^2}{N h^2 + M_e}}$$</span>
<span id="cb67-1747"><a href="#cb67-1747" aria-hidden="true" tabindex="-1"></a>   How does this compare to the parent average accuracy (r ≈ 0.35)?</span>
<span id="cb67-1748"><a href="#cb67-1748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1749"><a href="#cb67-1749" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Methods comparison**: Compare GBLUP, SNP-BLUP, and Bayesian methods (BayesB). When would you choose each approach? Give specific examples of traits where each method would be most appropriate.</span>
<span id="cb67-1750"><a href="#cb67-1750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1751"><a href="#cb67-1751" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Single-step GBLUP**: Explain how single-step GBLUP (ssGBLUP) combines pedigree and genomic information. What are the advantages of ssGBLUP over multi-step approaches? Why has ssGBLUP become the industry standard?</span>
<span id="cb67-1752"><a href="#cb67-1752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1753"><a href="#cb67-1753" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**G matrix interpretation**: In a genomic relationship matrix (G), you observe that two full-sibling bulls have G_12 = 0.47 while two other full-sibling bulls have G_34 = 0.53. Their pedigree relationships are both A_12 = A_34 = 0.50. Explain why G values differ, and what this means for genomic selection.</span>
<span id="cb67-1754"><a href="#cb67-1754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1755"><a href="#cb67-1755" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>**Training population size**: A swine breeding company is deciding whether to genotype 2,000 or 10,000 animals for their training population. For a trait with h² = 0.30 and M_e = 1,400:</span>
<span id="cb67-1756"><a href="#cb67-1756" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Calculate the expected accuracy for each training population size</span>
<span id="cb67-1757"><a href="#cb67-1757" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>How much does accuracy improve by increasing from 2,000 to 10,000?</span>
<span id="cb67-1758"><a href="#cb67-1758" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Discuss the cost-benefit trade-off of the larger training population</span>
<span id="cb67-1759"><a href="#cb67-1759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1760"><a href="#cb67-1760" aria-hidden="true" tabindex="-1"></a><span class="ss">7. </span>**Impact on genetic gain**: Before genomic selection, a dairy breeding program had:</span>
<span id="cb67-1761"><a href="#cb67-1761" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Selection intensity: i = 2.0</span>
<span id="cb67-1762"><a href="#cb67-1762" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Accuracy: r = 0.40 (parent average for young bulls)</span>
<span id="cb67-1763"><a href="#cb67-1763" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Genetic standard deviation: σ_A = 600 kg</span>
<span id="cb67-1764"><a href="#cb67-1764" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Generation interval: L = 6 years</span>
<span id="cb67-1765"><a href="#cb67-1765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1766"><a href="#cb67-1766" aria-hidden="true" tabindex="-1"></a>   After implementing genomic selection:</span>
<span id="cb67-1767"><a href="#cb67-1767" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Selection intensity: i = 2.5 (can evaluate more candidates)</span>
<span id="cb67-1768"><a href="#cb67-1768" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Accuracy: r = 0.65 (genomic predictions)</span>
<span id="cb67-1769"><a href="#cb67-1769" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Genetic standard deviation: σ_A = 600 kg (unchanged)</span>
<span id="cb67-1770"><a href="#cb67-1770" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Generation interval: L = 2.5 years</span>
<span id="cb67-1771"><a href="#cb67-1771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1772"><a href="#cb67-1772" aria-hidden="true" tabindex="-1"></a>   Calculate the annual genetic gain before and after genomic selection. By what factor did genetic gain increase?</span>
<span id="cb67-1773"><a href="#cb67-1773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1774"><a href="#cb67-1774" aria-hidden="true" tabindex="-1"></a><span class="fu">## Further Reading</span></span>
<span id="cb67-1775"><a href="#cb67-1775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1776"><a href="#cb67-1776" aria-hidden="true" tabindex="-1"></a><span class="fu">### Foundational Papers</span></span>
<span id="cb67-1777"><a href="#cb67-1777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1778"><a href="#cb67-1778" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Meuwissen, T.H.E., Hayes, B.J., and Goddard, M.E. (2001)**. "Prediction of Total Genetic Value Using Genome-Wide Dense Marker Maps." *Genetics* 157(4):1819-1829.</span>
<span id="cb67-1779"><a href="#cb67-1779" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>The landmark paper that proposed genomic selection</span>
<span id="cb67-1780"><a href="#cb67-1780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1781"><a href="#cb67-1781" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**VanRaden, P.M. (2008)**. "Efficient Methods to Compute Genomic Predictions." *Journal of Dairy Science* 91(11):4414-4423.</span>
<span id="cb67-1782"><a href="#cb67-1782" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Introduced the G matrix and made GBLUP computationally feasible</span>
<span id="cb67-1783"><a href="#cb67-1783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1784"><a href="#cb67-1784" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Goddard, M.E., and Hayes, B.J. (2009)**. "Mapping Genes for Complex Traits in Domestic Animals and Their Use in Breeding Programmes." *Nature Reviews Genetics* 10:381-391.</span>
<span id="cb67-1785"><a href="#cb67-1785" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Excellent review of genomic selection principles</span>
<span id="cb67-1786"><a href="#cb67-1786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1787"><a href="#cb67-1787" aria-hidden="true" tabindex="-1"></a><span class="fu">### Bayesian Methods</span></span>
<span id="cb67-1788"><a href="#cb67-1788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1789"><a href="#cb67-1789" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Gianola, D., et al. (2009)**. "Additive Genetic Variability and the Bayesian Alphabet." *Genetics* 183(1):347-363.</span>
<span id="cb67-1790"><a href="#cb67-1790" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Comprehensive overview of Bayesian methods for genomic prediction</span>
<span id="cb67-1791"><a href="#cb67-1791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1792"><a href="#cb67-1792" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Habier, D., et al. (2011)**. "Extension of the Bayesian Alphabet for Genomic Selection." *BMC Bioinformatics* 12:186.</span>
<span id="cb67-1793"><a href="#cb67-1793" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Describes BayesCπ and extensions</span>
<span id="cb67-1794"><a href="#cb67-1794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1795"><a href="#cb67-1795" aria-hidden="true" tabindex="-1"></a><span class="fu">### Single-Step GBLUP</span></span>
<span id="cb67-1796"><a href="#cb67-1796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1797"><a href="#cb67-1797" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Legarra, A., Aguilar, I., and Misztal, I. (2009)**. "A Relationship Matrix Including Full Pedigree and Genomic Information." *Journal of Dairy Science* 92(9):4656-4663.</span>
<span id="cb67-1798"><a href="#cb67-1798" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Original single-step GBLUP paper</span>
<span id="cb67-1799"><a href="#cb67-1799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1800"><a href="#cb67-1800" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Christensen, O.F., and Lund, M.S. (2010)**. "Genomic Prediction When Some Animals Are Not Genotyped." *Genetics Selection Evolution* 42:2.</span>
<span id="cb67-1801"><a href="#cb67-1801" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Alternative formulation of single-step GBLUP</span>
<span id="cb67-1802"><a href="#cb67-1802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1803"><a href="#cb67-1803" aria-hidden="true" tabindex="-1"></a><span class="fu">### Accuracy and Prediction</span></span>
<span id="cb67-1804"><a href="#cb67-1804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1805"><a href="#cb67-1805" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Daetwyler, H.D., et al. (2008)**. "Accuracy of Predicting the Genetic Risk of Disease Using a Genome-Wide Approach." *PLOS ONE* 3(10):e3395.</span>
<span id="cb67-1806"><a href="#cb67-1806" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Deterministic formula for genomic prediction accuracy</span>
<span id="cb67-1807"><a href="#cb67-1807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1808"><a href="#cb67-1808" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Goddard, M.E. (2009)**. "Genomic Selection: Prediction of Accuracy and Maximisation of Long Term Response." *Genetica* 136:245-257.</span>
<span id="cb67-1809"><a href="#cb67-1809" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Theory of accuracy and long-term response to genomic selection</span>
<span id="cb67-1810"><a href="#cb67-1810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1811"><a href="#cb67-1811" aria-hidden="true" tabindex="-1"></a><span class="fu">### Reviews by Species</span></span>
<span id="cb67-1812"><a href="#cb67-1812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1813"><a href="#cb67-1813" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Wiggans, G.R., et al. (2017)**. "Genomic Selection in Dairy Cattle: Progress and Challenges." *Journal of Dairy Science* 100(2):10-14.</span>
<span id="cb67-1814"><a href="#cb67-1814" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Comprehensive review of dairy genomic selection</span>
<span id="cb67-1815"><a href="#cb67-1815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1816"><a href="#cb67-1816" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Dekkers, J.C.M., et al. (2012)**. "Commercial Application of Marker- and Gene-Assisted Selection in Livestock: Strategies and Lessons." *Journal of Animal Science* 90(5):1585-1594.</span>
<span id="cb67-1817"><a href="#cb67-1817" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Practical implementation of genomic selection in swine</span>
<span id="cb67-1818"><a href="#cb67-1818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1819"><a href="#cb67-1819" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Wolc, A., et al. (2016)**. "Genome-Wide Association Analysis and Genetic Architecture of Egg Weight and Egg Uniformity in Layer Chickens." *Animal Genetics* 47(4):488-497.</span>
<span id="cb67-1820"><a href="#cb67-1820" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Genomic selection in poultry</span>
<span id="cb67-1821"><a href="#cb67-1821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1822"><a href="#cb67-1822" aria-hidden="true" tabindex="-1"></a><span class="fu">### Textbooks</span></span>
<span id="cb67-1823"><a href="#cb67-1823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1824"><a href="#cb67-1824" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Mrode, R.A. (2014)**. *Linear Models for the Prediction of Animal Breeding Values*, 3rd Edition. CAB International.</span>
<span id="cb67-1825"><a href="#cb67-1825" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Chapters on GBLUP and genomic evaluations</span>
<span id="cb67-1826"><a href="#cb67-1826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1827"><a href="#cb67-1827" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Lynch, M., and Walsh, B. (1998)**. *Genetics and Analysis of Quantitative Traits*. Sinauer Associates.</span>
<span id="cb67-1828"><a href="#cb67-1828" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Foundational quantitative genetics (predates genomics, but essential background)</span>
<span id="cb67-1829"><a href="#cb67-1829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1830"><a href="#cb67-1830" aria-hidden="true" tabindex="-1"></a><span class="fu">### Online Resources</span></span>
<span id="cb67-1831"><a href="#cb67-1831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1832"><a href="#cb67-1832" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Council on Dairy Cattle Breeding (CDCB)**: https://www.uscdcb.com/</span>
<span id="cb67-1833"><a href="#cb67-1833" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>U.S. dairy genomic evaluations, documentation, and genetic trends</span>
<span id="cb67-1834"><a href="#cb67-1834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1835"><a href="#cb67-1835" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**BLUPF90 Software**: http://nce.ads.uga.edu/wiki/doku.php</span>
<span id="cb67-1836"><a href="#cb67-1836" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Free software for single-step GBLUP (widely used in industry)</span>
<span id="cb67-1837"><a href="#cb67-1837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-1838"><a href="#cb67-1838" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Beef Improvement Federation Guidelines**: https://beefimprovement.org/</span>
<span id="cb67-1839"><a href="#cb67-1839" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Guidelines for genomic EPDs in beef cattle</span>
</code></pre></div><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></div>
</div></div></div></div></div>
</div> <!-- /content -->



<script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>