<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.24">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>12&nbsp; Introduction to Genomics – Fundamentals of Animal Breeding: Principles and Practice</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../chapters/13-genomic-selection.html" rel="next">
<link href="../chapters/11-crossbreeding.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dd8fe44f7e8d2a1c1a36222b42c75f52.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-f29d4b558c027fdd1c8e949aa5364f62.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><style>html{ scroll-behavior: smooth; }</style>
<link href="../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="../site_libs/pagedtable-1.1/js/pagedtable.js"></script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script><link rel="stylesheet" href="../styles.css">
</head>
<body class="nav-sidebar docked quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/12-genomics-intro.html">PART 3: GENOMICS</a></li><li class="breadcrumb-item"><a href="../chapters/12-genomics-intro.html"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Introduction to Genomics</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../index.html" class="sidebar-logo-link">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Fundamentals of Animal Breeding: Principles and Practice</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">PART 1: FUNDAMENTALS</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/01-introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">The Role and Tools of the Modern Animal Breeder</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/02-selection-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Selection Basics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/03-genetic-model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">The Basic Genetic Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/04-quantitative-traits.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Quantitative vs.&nbsp;Simply Inherited Traits</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/05-heritability-repeatability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Heritability and Repeatability</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">PART 2: SELECTION AND BREEDING STRATEGIES</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/06-breeders-equation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">The Breeder’s Equation and Selection Response</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/07-breeding-values.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Estimating Breeding Values</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/08-genetic-correlations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Genetic Correlations and Correlated Response</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/09-selection-index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Multiple Trait Selection and Selection Index</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/10-mating-strategies.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Mating Strategies and Optimum Contribution Selection</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/11-crossbreeding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Crossbreeding and Hybrid Vigor</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">PART 3: GENOMICS</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/12-genomics-intro.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Introduction to Genomics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/13-genomic-selection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Genomic Selection</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">PART 4: PRACTICAL SKILLS</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/14-practical-skills.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Practical Animal Breeding and Data Skills</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">PART 5: SPECIES-SPECIFIC BREEDING</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/15-swine-breeding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Swine Breeding</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/16-poultry-breeding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Poultry Breeding</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/17-dairy-cattle-breeding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Dairy Cattle Breeding</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/18-beef-cattle-breeding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Beef Cattle Breeding</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/19-sheep-breeding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Sheep Breeding</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/20-camelidae-breeding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Camelidae Breeding</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/21-aquaculture-breeding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Aquaculture Breeding</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/22-companion-animal-breeding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Companion Animal Breeding</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">PART 6: PRECISION LIVESTOCK FARMING</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/23-plf-introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Introduction to Precision Livestock Farming</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/24-wearable-technologies.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Wearable Technologies in Livestock</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/25-computer-vision.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Computer Vision and Camera Technologies</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendices/datasets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Datasets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendices/r-resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R Resources for Animal Breeding</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendices/glossary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Glossary of Genetic Terms</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Contents</h2>
   
  <ul>
<li><a href="#learning-objectives" id="toc-learning-objectives" class="nav-link active" data-scroll-target="#learning-objectives">Learning Objectives</a></li>
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction"><span class="header-section-number">12.1</span> Introduction</a></li>
  <li>
<a href="#what-is-genomics-in-breeding" id="toc-what-is-genomics-in-breeding" class="nav-link" data-scroll-target="#what-is-genomics-in-breeding"><span class="header-section-number">12.2</span> What is Genomics in Breeding?</a>
  <ul class="collapse">
<li><a href="#three-key-advantages-of-genomics" id="toc-three-key-advantages-of-genomics" class="nav-link" data-scroll-target="#three-key-advantages-of-genomics"><span class="header-section-number">12.2.1</span> Three Key Advantages of Genomics</a></li>
  <li><a href="#before-and-after-genomics" id="toc-before-and-after-genomics" class="nav-link" data-scroll-target="#before-and-after-genomics"><span class="header-section-number">12.2.2</span> Before and After Genomics</a></li>
  <li><a href="#timeline-of-genomics-in-livestock" id="toc-timeline-of-genomics-in-livestock" class="nav-link" data-scroll-target="#timeline-of-genomics-in-livestock"><span class="header-section-number">12.2.3</span> Timeline of Genomics in Livestock</a></li>
  </ul>
</li>
  <li>
<a href="#dna-markers-single-nucleotide-polymorphisms-snps" id="toc-dna-markers-single-nucleotide-polymorphisms-snps" class="nav-link" data-scroll-target="#dna-markers-single-nucleotide-polymorphisms-snps"><span class="header-section-number">12.3</span> DNA Markers: Single Nucleotide Polymorphisms (SNPs)</a>
  <ul class="collapse">
<li><a href="#what-is-a-snp" id="toc-what-is-a-snp" class="nav-link" data-scroll-target="#what-is-a-snp"><span class="header-section-number">12.3.1</span> What is a SNP?</a></li>
  <li><a href="#snp-genotypes" id="toc-snp-genotypes" class="nav-link" data-scroll-target="#snp-genotypes"><span class="header-section-number">12.3.2</span> SNP Genotypes</a></li>
  <li><a href="#allele-frequency" id="toc-allele-frequency" class="nav-link" data-scroll-target="#allele-frequency"><span class="header-section-number">12.3.3</span> Allele Frequency</a></li>
  <li><a href="#why-snps-are-useful-for-breeding" id="toc-why-snps-are-useful-for-breeding" class="nav-link" data-scroll-target="#why-snps-are-useful-for-breeding"><span class="header-section-number">12.3.4</span> Why SNPs are Useful for Breeding</a></li>
  </ul>
</li>
  <li>
<a href="#snp-chips-arrays" id="toc-snp-chips-arrays" class="nav-link" data-scroll-target="#snp-chips-arrays"><span class="header-section-number">12.4</span> SNP Chips (Arrays)</a>
  <ul class="collapse">
<li><a href="#what-is-a-snp-chip" id="toc-what-is-a-snp-chip" class="nav-link" data-scroll-target="#what-is-a-snp-chip"><span class="header-section-number">12.4.1</span> What is a SNP Chip?</a></li>
  <li><a href="#how-snp-chips-work-simplified" id="toc-how-snp-chips-work-simplified" class="nav-link" data-scroll-target="#how-snp-chips-work-simplified"><span class="header-section-number">12.4.2</span> How SNP Chips Work (Simplified)</a></li>
  <li><a href="#common-snp-chips-by-species" id="toc-common-snp-chips-by-species" class="nav-link" data-scroll-target="#common-snp-chips-by-species"><span class="header-section-number">12.4.3</span> Common SNP Chips by Species</a></li>
  <li><a href="#density-trade-offs-when-to-use-which-chip" id="toc-density-trade-offs-when-to-use-which-chip" class="nav-link" data-scroll-target="#density-trade-offs-when-to-use-which-chip"><span class="header-section-number">12.4.4</span> Density Trade-offs: When to Use Which Chip?</a></li>
  <li><a href="#cost-trends-the-genomic-revolution-became-affordable" id="toc-cost-trends-the-genomic-revolution-became-affordable" class="nav-link" data-scroll-target="#cost-trends-the-genomic-revolution-became-affordable"><span class="header-section-number">12.4.5</span> Cost Trends: The Genomic Revolution Became Affordable</a></li>
  </ul>
</li>
  <li>
<a href="#bioinformatics-basics-quality-control-and-imputation" id="toc-bioinformatics-basics-quality-control-and-imputation" class="nav-link" data-scroll-target="#bioinformatics-basics-quality-control-and-imputation"><span class="header-section-number">12.5</span> Bioinformatics Basics: Quality Control and Imputation</a>
  <ul class="collapse">
<li><a href="#genotype-quality-control-qc" id="toc-genotype-quality-control-qc" class="nav-link" data-scroll-target="#genotype-quality-control-qc"><span class="header-section-number">12.5.1</span> Genotype Quality Control (QC)</a></li>
  <li><a href="#imputation" id="toc-imputation" class="nav-link" data-scroll-target="#imputation"><span class="header-section-number">12.5.2</span> Imputation</a></li>
  </ul>
</li>
  <li>
<a href="#whole-genome-sequencing-wgs" id="toc-whole-genome-sequencing-wgs" class="nav-link" data-scroll-target="#whole-genome-sequencing-wgs"><span class="header-section-number">12.6</span> Whole Genome Sequencing (WGS)</a>
  <ul class="collapse">
<li><a href="#what-is-whole-genome-sequencing" id="toc-what-is-whole-genome-sequencing" class="nav-link" data-scroll-target="#what-is-whole-genome-sequencing"><span class="header-section-number">12.6.1</span> What is Whole Genome Sequencing?</a></li>
  <li><a href="#wgs-vs.-snp-chips" id="toc-wgs-vs.-snp-chips" class="nav-link" data-scroll-target="#wgs-vs.-snp-chips"><span class="header-section-number">12.6.2</span> WGS vs.&nbsp;SNP Chips</a></li>
  <li><a href="#uses-of-whole-genome-sequencing" id="toc-uses-of-whole-genome-sequencing" class="nav-link" data-scroll-target="#uses-of-whole-genome-sequencing"><span class="header-section-number">12.6.3</span> Uses of Whole Genome Sequencing</a></li>
  <li><a href="#wgs-in-practice-cost-effective-strategies" id="toc-wgs-in-practice-cost-effective-strategies" class="nav-link" data-scroll-target="#wgs-in-practice-cost-effective-strategies"><span class="header-section-number">12.6.4</span> WGS in Practice: Cost-Effective Strategies</a></li>
  </ul>
</li>
  <li>
<a href="#from-genotypes-to-genomic-predictions" id="toc-from-genotypes-to-genomic-predictions" class="nav-link" data-scroll-target="#from-genotypes-to-genomic-predictions"><span class="header-section-number">12.7</span> From Genotypes to Genomic Predictions</a>
  <ul class="collapse">
<li><a href="#genomic-relationship-matrix-preview" id="toc-genomic-relationship-matrix-preview" class="nav-link" data-scroll-target="#genomic-relationship-matrix-preview"><span class="header-section-number">12.7.1</span> Genomic Relationship Matrix (Preview)</a></li>
  </ul>
</li>
  <li>
<a href="#applications-of-genomics-in-animal-breeding" id="toc-applications-of-genomics-in-animal-breeding" class="nav-link" data-scroll-target="#applications-of-genomics-in-animal-breeding"><span class="header-section-number">12.8</span> Applications of Genomics in Animal Breeding</a>
  <ul class="collapse">
<li><a href="#genomic-selection" id="toc-genomic-selection" class="nav-link" data-scroll-target="#genomic-selection"><span class="header-section-number">12.8.1</span> 1. Genomic Selection</a></li>
  <li><a href="#parentage-verification-and-pedigree-correction" id="toc-parentage-verification-and-pedigree-correction" class="nav-link" data-scroll-target="#parentage-verification-and-pedigree-correction"><span class="header-section-number">12.8.2</span> 2. Parentage Verification and Pedigree Correction</a></li>
  <li><a href="#genome-wide-association-studies-gwas" id="toc-genome-wide-association-studies-gwas" class="nav-link" data-scroll-target="#genome-wide-association-studies-gwas"><span class="header-section-number">12.8.3</span> 3. Genome-Wide Association Studies (GWAS)</a></li>
  <li><a href="#genomic-management-of-inbreeding" id="toc-genomic-management-of-inbreeding" class="nav-link" data-scroll-target="#genomic-management-of-inbreeding"><span class="header-section-number">12.8.4</span> 4. Genomic Management of Inbreeding</a></li>
  <li><a href="#identification-of-genetic-defects-and-disease-mutations" id="toc-identification-of-genetic-defects-and-disease-mutations" class="nav-link" data-scroll-target="#identification-of-genetic-defects-and-disease-mutations"><span class="header-section-number">12.8.5</span> 5. Identification of Genetic Defects and Disease Mutations</a></li>
  <li><a href="#crossbred-performance-and-breed-composition" id="toc-crossbred-performance-and-breed-composition" class="nav-link" data-scroll-target="#crossbred-performance-and-breed-composition"><span class="header-section-number">12.8.6</span> 6. Crossbred Performance and Breed Composition</a></li>
  </ul>
</li>
  <li>
<a href="#r-demonstrations-working-with-genotype-data" id="toc-r-demonstrations-working-with-genotype-data" class="nav-link" data-scroll-target="#r-demonstrations-working-with-genotype-data"><span class="header-section-number">12.9</span> R Demonstrations: Working with Genotype Data</a>
  <ul class="collapse">
<li><a href="#demo-1-simulating-and-exploring-snp-genotype-data" id="toc-demo-1-simulating-and-exploring-snp-genotype-data" class="nav-link" data-scroll-target="#demo-1-simulating-and-exploring-snp-genotype-data"><span class="header-section-number">12.9.1</span> Demo 1: Simulating and Exploring SNP Genotype Data</a></li>
  <li><a href="#demo-2-calculate-and-visualize-allele-frequencies" id="toc-demo-2-calculate-and-visualize-allele-frequencies" class="nav-link" data-scroll-target="#demo-2-calculate-and-visualize-allele-frequencies"><span class="header-section-number">12.9.2</span> Demo 2: Calculate and Visualize Allele Frequencies</a></li>
  <li><a href="#demo-3-quality-control-workflow" id="toc-demo-3-quality-control-workflow" class="nav-link" data-scroll-target="#demo-3-quality-control-workflow"><span class="header-section-number">12.9.3</span> Demo 3: Quality Control Workflow</a></li>
  <li><a href="#demo-4-calculate-genomic-relationship-matrix-preview" id="toc-demo-4-calculate-genomic-relationship-matrix-preview" class="nav-link" data-scroll-target="#demo-4-calculate-genomic-relationship-matrix-preview"><span class="header-section-number">12.9.4</span> Demo 4: Calculate Genomic Relationship Matrix (Preview)</a></li>
  </ul>
</li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">12.10</span> Summary</a></li>
  <li><a href="#practice-problems" id="toc-practice-problems" class="nav-link" data-scroll-target="#practice-problems"><span class="header-section-number">12.11</span> Practice Problems</a></li>
  <li><a href="#further-reading" id="toc-further-reading" class="nav-link" data-scroll-target="#further-reading"><span class="header-section-number">12.12</span> Further Reading</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/12-genomics-intro.html">PART 3: GENOMICS</a></li><li class="breadcrumb-item"><a href="../chapters/12-genomics-intro.html"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Introduction to Genomics</span></a></li></ol></nav><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="sec-genomics-intro" class="quarto-section-identifier"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Introduction to Genomics</span></span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="learning-objectives" class="level3 unnumbered learning-objectives"><h3 class="unnumbered anchored" data-anchor-id="learning-objectives">Learning Objectives</h3>
<p>By the end of this chapter, you will be able to:</p>
<ol type="1">
<li>Explain what a SNP is and why SNPs are useful genetic markers</li>
<li>Describe SNP chips (arrays) and their use in livestock breeding</li>
<li>Understand the basics of genotype quality control</li>
<li>Distinguish SNP chips from whole genome sequencing</li>
<li>Identify applications of genomics in animal breeding</li>
</ol></section><section id="introduction" class="level2" data-number="12.1"><h2 data-number="12.1" class="anchored" data-anchor-id="introduction">
<span class="header-section-number">12.1</span> Introduction</h2>
<p>In 2009, the dairy cattle breeding industry experienced a revolution. For decades, young bulls required expensive progeny testing—waiting 5-6 years to evaluate daughters’ milk production before widespread use. This changed dramatically when the USDA and dairy breed associations implemented <strong>genomic selection</strong>. Suddenly, a small tissue sample from a newborn calf could predict its genetic merit with remarkable accuracy, without waiting for daughters or even the bull’s own performance records.</p>
<p>This breakthrough stemmed from sequencing animal genomes and developing technologies to measure thousands of DNA variants across the genome simultaneously. The impact was immediate and profound: genetic progress in dairy cattle essentially doubled overnight. Generation intervals dropped from 6-7 years to 2-3 years. Young bulls no longer needed progeny testing. The cost per genetic improvement plummeted.</p>
<p>What happened in dairy cattle has since spread across livestock breeding—swine, poultry, beef cattle, sheep, horses, and even companion animals now routinely use genomic technologies. Commercial breeding companies have restructured their entire operations around genomic selection. The transformation is so complete that today, genomics is simply how modern animal breeding is done.</p>
<p>This chapter introduces the genomic technologies that made this revolution possible. We’ll explore what DNA markers (SNPs) are, how we measure them, how we ensure data quality, and what applications they enable beyond genomic selection. By the end, you’ll understand the foundation on which modern breeding programs are built—and be prepared for Chapter 13, where we’ll dive into genomic selection methods themselves.</p>
</section><section id="what-is-genomics-in-breeding" class="level2" data-number="12.2"><h2 data-number="12.2" class="anchored" data-anchor-id="what-is-genomics-in-breeding">
<span class="header-section-number">12.2</span> What is Genomics in Breeding?</h2>
<p><strong>Genomics in animal breeding</strong> refers to using genome-wide DNA information to improve genetic predictions and make better selection decisions. Instead of relying solely on pedigrees (who the parents are) and phenotypes (what the animal looks like or produces), we can now look directly at an animal’s DNA to predict its genetic merit.</p>
<section id="three-key-advantages-of-genomics" class="level3" data-number="12.2.1"><h3 data-number="12.2.1" class="anchored" data-anchor-id="three-key-advantages-of-genomics">
<span class="header-section-number">12.2.1</span> Three Key Advantages of Genomics</h3>
<p>Genomics provides three major improvements over traditional breeding methods:</p>
<p><strong>1. Direct measurement of genotype</strong> With traditional methods, we infer an animal’s genotype from its relatives’ and own performance. Genomics lets us measure the genotype directly by sequencing DNA. This captures <strong>Mendelian sampling</strong>—the random shuffling of chromosomes during gamete formation that makes full siblings genetically different.</p>
<p><strong>2. Early selection</strong> We can genotype animals at birth (or even as embryos), predict their breeding values immediately, and make selection decisions years before they would express the trait or produce offspring. This dramatically reduces generation intervals.</p>
<p><strong>3. Selection on expensive or sex-limited traits</strong> Some traits are difficult or expensive to measure (e.g., feed efficiency requiring individual intake measurement, or carcass quality requiring slaughter). Others can only be measured in one sex (e.g., milk production in females). Genomics enables accurate selection on these traits using DNA samples and data from relatives.</p>
</section><section id="before-and-after-genomics" class="level3" data-number="12.2.2"><h3 data-number="12.2.2" class="anchored" data-anchor-id="before-and-after-genomics">
<span class="header-section-number">12.2.2</span> Before and After Genomics</h3>
<p>Let’s contrast traditional breeding with genomic breeding using dairy cattle as an example:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 11%">
<col style="width: 45%">
<col style="width: 42%">
</colgroup>
<thead><tr class="header">
<th>Aspect</th>
<th>Traditional Breeding (Pre-2009)</th>
<th>Genomic Breeding (Post-2009)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>Information source</strong></td>
<td>Pedigree + phenotypes from progeny</td>
<td>Pedigree + phenotypes + DNA markers</td>
</tr>
<tr class="even">
<td><strong>Young bull evaluation</strong></td>
<td>Progeny test: 5-6 years, 100+ daughters</td>
<td>Genomic test: birth, no daughters needed</td>
</tr>
<tr class="odd">
<td><strong>Generation interval</strong></td>
<td>6-7 years (waiting for progeny)</td>
<td>2-3 years (select at birth)</td>
</tr>
<tr class="even">
<td><strong>Accuracy for young bull</strong></td>
<td>~0.30 (parent average)</td>
<td>~0.65 (genomic prediction)</td>
</tr>
<tr class="odd">
<td><strong>Cost per evaluation</strong></td>
<td>$25,000-$50,000 (progeny testing)</td>
<td>$50-150 (genomic testing)</td>
</tr>
<tr class="even">
<td><strong>Annual genetic gain</strong></td>
<td>~1% per year</td>
<td>~2% per year (doubled)</td>
</tr>
</tbody>
</table>
<p>The transformation has been similarly dramatic in other species, though the specifics vary. Swine breeding companies now genotype thousands of selection candidates annually. Broiler breeding programs use genomics to improve disease resistance and leg health. Even dog and cat breeders use genomic tools to screen for genetic diseases and verify parentage.</p>
</section><section id="timeline-of-genomics-in-livestock" class="level3" data-number="12.2.3"><h3 data-number="12.2.3" class="anchored" data-anchor-id="timeline-of-genomics-in-livestock">
<span class="header-section-number">12.2.3</span> Timeline of Genomics in Livestock</h3>
<p>The genomic revolution in animal breeding unfolded rapidly:</p>
<ul>
<li>
<strong>2001</strong>: Human genome sequenced (reference for all mammalian genomics)</li>
<li>
<strong>2004-2009</strong>: Livestock genome assemblies completed:
<ul>
<li>Chicken (2004)</li>
<li>Cattle (2009)</li>
<li>Pig (2009)</li>
<li>Sheep (2010)</li>
<li>Horse (2009)</li>
</ul>
</li>
<li>
<strong>2008-2010</strong>: First genomic selection implementations
<ul>
<li>Dairy cattle (2009, USA and Netherlands)</li>
<li>Broiler chickens (~2010)</li>
</ul>
</li>
<li>
<strong>2010s</strong>: Widespread adoption across species
<ul>
<li>Swine breeding companies (2011-2014)</li>
<li>Beef cattle breed associations (2012+)</li>
<li>Salmon breeding (2012+)</li>
</ul>
</li>
<li>
<strong>2015-2020</strong>: Single-step genomic BLUP becomes industry standard</li>
<li>
<strong>2020+</strong>: Whole genome sequencing reference panels, advanced methods</li>
</ul>
<p>Each species’ adoption timeline depended on industry structure, generation interval, and economic incentives. Dairy cattle adopted quickly due to long generation intervals and expensive progeny testing. Poultry breeding companies integrated genomics into existing family-based selection schemes. The common thread: once adopted, genomics transformed every breeding program.</p>
</section></section><section id="dna-markers-single-nucleotide-polymorphisms-snps" class="level2" data-number="12.3"><h2 data-number="12.3" class="anchored" data-anchor-id="dna-markers-single-nucleotide-polymorphisms-snps">
<span class="header-section-number">12.3</span> DNA Markers: Single Nucleotide Polymorphisms (SNPs)</h2>
<p>To use genomics, we need <strong>genetic markers</strong>—specific locations in the genome where individuals differ. The most common and useful type of marker is the SNP (pronounced “snip”).</p>
<section id="what-is-a-snp" class="level3" data-number="12.3.1"><h3 data-number="12.3.1" class="anchored" data-anchor-id="what-is-a-snp">
<span class="header-section-number">12.3.1</span> What is a SNP?</h3>
<p>A <strong>Single Nucleotide Polymorphism (SNP)</strong> is a location in the DNA sequence where a single nucleotide (base pair) differs between individuals in a population.</p>
<p>DNA consists of four nucleotide bases: <strong>A</strong> (adenine), <strong>T</strong> (thymine), <strong>G</strong> (guanine), and <strong>C</strong> (cytosine). At most locations in the genome, all individuals have the same base. But at some locations—roughly 1 in every 1,000 bases—variation exists.</p>
<p><strong>Example SNP:</strong></p>
<p>Animal 1: …ATCG<strong>A</strong>TTGCA… Animal 2: …ATCG<strong>G</strong>TTGCA…</p>
<p>At this SNP position, Animal 1 has an <strong>A</strong> allele and Animal 2 has a <strong>G</strong> allele. This single base difference is a SNP. Mammals have billions of base pairs, so millions of SNPs exist across the genome—far more than we need for breeding applications.</p>
<p><strong>Where do SNPs come from?</strong> SNPs arise from random mutations that occurred in ancestral populations and were passed down through generations. Most SNPs are selectively neutral (don’t affect fitness), but some are located in or near genes and influence traits of interest. Even neutral SNPs are useful because they’re <strong>linked</strong> to causal mutations through linkage disequilibrium (more on this shortly).</p>
</section><section id="snp-genotypes" class="level3" data-number="12.3.2"><h3 data-number="12.3.2" class="anchored" data-anchor-id="snp-genotypes">
<span class="header-section-number">12.3.2</span> SNP Genotypes</h3>
<p>Each animal inherits one copy of each chromosome from its sire and one from its dam. Therefore, at each SNP location, an animal has <strong>two alleles</strong>—one from each parent.</p>
<p>Let’s say a SNP has two possible alleles: <strong>A</strong> and <strong>G</strong>. An individual can have one of three genotypes:</p>
<ol type="1">
<li>
<strong>AA</strong> (homozygous for A)</li>
<li>
<strong>AG</strong> (heterozygous)</li>
<li>
<strong>GG</strong> (homozygous for G)</li>
</ol>
<p>In genomic datasets, we typically code SNP genotypes numerically:</p>
<ul>
<li>
<strong>0</strong> = homozygous for the first allele (AA)</li>
<li>
<strong>1</strong> = heterozygous (AG)</li>
<li>
<strong>2</strong> = homozygous for the second allele (GG)</li>
</ul>
<p><strong>Important:</strong> The choice of which allele is “0” vs.&nbsp;“2” is arbitrary. We usually designate the allele that was more common when the SNP panel was designed as “0” (the reference allele) and the alternative allele as “2.”</p>
<p><strong>Example genotypes for 5 animals at 3 SNPs:</strong></p>
<table class="caption-top table">
<thead><tr class="header">
<th>Animal</th>
<th>SNP1</th>
<th>SNP2</th>
<th>SNP3</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>0</td>
<td>1</td>
<td>2</td>
</tr>
<tr class="even">
<td>2</td>
<td>1</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="odd">
<td>3</td>
<td>2</td>
<td>2</td>
<td>0</td>
</tr>
<tr class="even">
<td>4</td>
<td>0</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="odd">
<td>5</td>
<td>1</td>
<td>2</td>
<td>0</td>
</tr>
</tbody>
</table>
<p>Animal 1 is homozygous AA at SNP1 (genotype = 0), heterozygous at SNP2 (genotype = 1), and homozygous GG at SNP3 (genotype = 2).</p>
</section><section id="allele-frequency" class="level3" data-number="12.3.3"><h3 data-number="12.3.3" class="anchored" data-anchor-id="allele-frequency">
<span class="header-section-number">12.3.3</span> Allele Frequency</h3>
<p>An important property of each SNP is its <strong>allele frequency</strong>—the proportion of chromosomes in the population carrying each allele.</p>
<p>If we have genotype data for many animals, we can calculate the frequency of allele A as:</p>
<p><span class="math display">\[
p = \frac{2 \times n_{AA} + n_{AG}}{2 \times n_{\text{total}}}
\]</span></p>
<p>Where:</p>
<ul>
<li>
<span class="math inline">\(n_{AA}\)</span> = number of animals with genotype AA (coded as 0)</li>
<li>
<span class="math inline">\(n_{AG}\)</span> = number of animals with genotype AG (coded as 1)</li>
<li>
<span class="math inline">\(n_{\text{total}}\)</span> = total number of animals</li>
<li>We multiply by 2 because each animal has 2 alleles</li>
</ul>
<p>The frequency of allele G is simply <span class="math inline">\(q = 1 - p\)</span>.</p>
<p><strong>Example:</strong> Suppose we genotyped 100 cattle at a SNP and observed:</p>
<ul>
<li>25 animals with genotype 0 (AA)</li>
<li>50 animals with genotype 1 (AG)</li>
<li>25 animals with genotype 2 (GG)</li>
</ul>
<p>The frequency of allele A is:</p>
<p><span class="math display">\[
p = \frac{2(25) + 50}{2(100)} = \frac{100}{200} = 0.50
\]</span></p>
<p>So allele A has frequency 50% in this population, and allele G also has frequency 50%.</p>
<p><strong>Minor Allele Frequency (MAF):</strong> The <strong>minor allele frequency</strong> is the frequency of the less common allele. If <span class="math inline">\(p = 0.50\)</span>, MAF = 0.50. If <span class="math inline">\(p = 0.90\)</span>, MAF = 0.10 (the G allele is minor). MAF is important for quality control (low-MAF SNPs provide less information and may be genotyping errors).</p>
</section><section id="why-snps-are-useful-for-breeding" class="level3" data-number="12.3.4"><h3 data-number="12.3.4" class="anchored" data-anchor-id="why-snps-are-useful-for-breeding">
<span class="header-section-number">12.3.4</span> Why SNPs are Useful for Breeding</h3>
<p>SNPs are the workhorses of genomic selection for several reasons:</p>
<p><strong>1. Abundant across the genome</strong> Millions of SNPs exist in livestock species. We can select thousands to hundreds of thousands that are evenly spaced across chromosomes, ensuring genome-wide coverage.</p>
<p><strong>2. Biallelic (simple)</strong> Most SNPs have only two alleles (A/G, C/T, etc.), making them easy to genotype and analyze. Contrast with older markers like microsatellites, which often had many alleles and were more complex.</p>
<p><strong>3. Stable within an individual</strong> Your genotype at a SNP doesn’t change throughout your life. We can genotype an animal once (at birth) and use that information forever.</p>
<p><strong>4. High-throughput genotyping</strong> Modern SNP chips can genotype 50,000 to 800,000 SNPs simultaneously from a single DNA sample, at low cost. This was impossible with older marker technologies.</p>
<p><strong>5. Linkage disequilibrium (LD) with causal mutations</strong> Most SNPs we genotype are not themselves causing variation in traits. Instead, they are <strong>linked</strong> (physically close on the chromosome) to causal mutations. When SNPs and causal mutations are inherited together (in LD), we can use SNP genotypes to predict breeding values even if we never identify the causal mutations themselves.</p>
<p><strong>Linkage disequilibrium</strong> is the key concept making genomic selection work. LD means certain alleles at different loci are inherited together more often than expected by chance (because they’re close together and recombination is rare between them). By genotyping SNPs across the genome, we effectively “tag” chromosomal segments and their associated genetic effects on traits.</p>
<p><strong>Example: Coat color in horses</strong> The “agouti” gene determines whether a horse is bay (black body with brown points) or black (entirely black). A SNP in the agouti gene is in perfect LD with the causal mutation. By genotyping this SNP, we can predict coat color without sequencing the entire gene. Similarly, thousands of SNPs across the genome tag segments affecting milk production, growth rate, disease resistance, etc.</p>
</section></section><section id="snp-chips-arrays" class="level2" data-number="12.4"><h2 data-number="12.4" class="anchored" data-anchor-id="snp-chips-arrays">
<span class="header-section-number">12.4</span> SNP Chips (Arrays)</h2>
<p>Now that we understand what SNPs are, how do we genotype thousands of them efficiently? The answer is <strong>SNP chips</strong> (also called SNP arrays or bead chips).</p>
<section id="what-is-a-snp-chip" class="level3" data-number="12.4.1"><h3 data-number="12.4.1" class="anchored" data-anchor-id="what-is-a-snp-chip">
<span class="header-section-number">12.4.1</span> What is a SNP Chip?</h3>
<p>A <strong>SNP chip</strong> is a piece of glass or silicon (about the size of a thumbnail) onto which hundreds of thousands of DNA probes have been attached. Each probe corresponds to a specific SNP location in the genome. When DNA from an animal is applied to the chip, it binds to the probes, and a scanner detects which alleles are present at each SNP.</p>
<p><strong>Key features:</strong></p>
<ul>
<li>
<strong>Pre-designed panel:</strong> Each chip genotypes a fixed set of SNPs chosen during chip design</li>
<li>
<strong>High-throughput:</strong> One chip genotypes 50,000 to 800,000 SNPs from one DNA sample</li>
<li>
<strong>Low cost per SNP:</strong> Though the chip itself costs $30-$150, the cost per SNP is often &lt; $0.001</li>
<li>
<strong>Species-specific:</strong> Different chips exist for cattle, swine, poultry, horses, dogs, etc.</li>
</ul></section><section id="how-snp-chips-work-simplified" class="level3" data-number="12.4.2"><h3 data-number="12.4.2" class="anchored" data-anchor-id="how-snp-chips-work-simplified">
<span class="header-section-number">12.4.2</span> How SNP Chips Work (Simplified)</h3>
<p>The genotyping process involves several steps:</p>
<p><strong>1. DNA Extraction</strong> DNA is extracted from a tissue sample—typically blood, hair follicles, ear tissue, or nasal swabs. The sample is processed in a lab to isolate high-quality DNA.</p>
<p><strong>2. DNA Processing and Chip Hybridization</strong> The DNA is fragmented, amplified, and labeled with fluorescent markers. It’s then applied to the chip, where it binds (hybridizes) to probes corresponding to each SNP location.</p>
<p><strong>3. Scanning</strong> A laser scanner excites the fluorescent labels, and the emitted light indicates which alleles are present. Different alleles emit different fluorescence patterns (e.g., red for AA, yellow for AG, green for GG).</p>
<p><strong>4. Genotype Calling</strong> Software analyzes the fluorescence intensities and “calls” genotypes (0, 1, or 2) for each SNP in each animal. Quality scores indicate confidence in each call.</p>
<p>You don’t need to understand the detailed chemistry—the important point is that SNP chips enable cost-effective, accurate, high-throughput genotyping.</p>
</section><section id="common-snp-chips-by-species" class="level3" data-number="12.4.3"><h3 data-number="12.4.3" class="anchored" data-anchor-id="common-snp-chips-by-species">
<span class="header-section-number">12.4.3</span> Common SNP Chips by Species</h3>
<p>Different livestock and companion animal species have breed- and purpose-specific SNP chips. Here’s a comprehensive table of widely used panels:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 12%">
<col style="width: 20%">
<col style="width: 21%">
<col style="width: 27%">
<col style="width: 18%">
</colgroup>
<thead><tr class="header">
<th>Species</th>
<th>SNP Chip Name</th>
<th>Number of SNPs</th>
<th>Typical Cost (USD)</th>
<th>Primary Uses</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>Cattle (Dairy/Beef)</strong></td>
<td>BovineHD</td>
<td>777,962</td>
<td>$100-150</td>
<td>Research, reference panels, high-density</td>
</tr>
<tr class="even">
<td></td>
<td>GGP Bovine 100K</td>
<td>100,000</td>
<td>$35-50</td>
<td>Genomic selection, routine evaluation</td>
</tr>
<tr class="odd">
<td></td>
<td>GGP Bovine 50K</td>
<td>50,000</td>
<td>$30-40</td>
<td>Genomic selection, crossbred animals</td>
</tr>
<tr class="even">
<td></td>
<td>GGP Bovine LD (Low Density)</td>
<td>30,000</td>
<td>$15-25</td>
<td>Females, terminal animals (imputed to HD)</td>
</tr>
<tr class="odd">
<td><strong>Swine</strong></td>
<td>PorcineSNP60 (Illumina)</td>
<td>60,000</td>
<td>$50-80</td>
<td>Genomic selection, parentage</td>
</tr>
<tr class="even">
<td></td>
<td>GGP Porcine 50K</td>
<td>50,000</td>
<td>$40-60</td>
<td>Commercial breeding programs</td>
</tr>
<tr class="odd">
<td></td>
<td>GGP Porcine LD</td>
<td>20,000</td>
<td>$20-30</td>
<td>Crossbred commercial pigs (imputed)</td>
</tr>
<tr class="even">
<td><strong>Poultry</strong></td>
<td>Axiom Chicken HD (custom)</td>
<td>600,000</td>
<td>Proprietary</td>
<td>Broiler and layer breeding (company-specific)</td>
</tr>
<tr class="odd">
<td></td>
<td>Affymetrix 600K</td>
<td>600,000</td>
<td>Proprietary</td>
<td>Research and breeding (custom content)</td>
</tr>
<tr class="even">
<td><strong>Sheep</strong></td>
<td>OvineSNP50</td>
<td>50,000</td>
<td>$50-80</td>
<td>LAMBPLAN, genomic selection</td>
</tr>
<tr class="odd">
<td></td>
<td>Ovine Infinium HD</td>
<td>600,000</td>
<td>$100-150</td>
<td>Research, reference panels</td>
</tr>
<tr class="even">
<td><strong>Goat</strong></td>
<td>GoatSNP50</td>
<td>50,000</td>
<td>$60-90</td>
<td>Genomic selection, research</td>
</tr>
<tr class="odd">
<td><strong>Horse</strong></td>
<td>EquineSNP70</td>
<td>70,000</td>
<td>$70-100</td>
<td>Racing, breeding, parentage, coat color</td>
</tr>
<tr class="even">
<td></td>
<td>Equine Axiom</td>
<td>670,000</td>
<td>$120-180</td>
<td>Research, high-density applications</td>
</tr>
<tr class="odd">
<td><strong>Dog</strong></td>
<td>CanineHD (Illumina)</td>
<td>173,662</td>
<td>$100-200</td>
<td>Breed identification, health screening, research</td>
</tr>
<tr class="even">
<td></td>
<td>Canine LD</td>
<td>20,000</td>
<td>$60-100</td>
<td>Breed-specific health panels, parentage</td>
</tr>
<tr class="odd">
<td><strong>Cat</strong></td>
<td>Feline Infinium iSelect</td>
<td>63,000</td>
<td>$80-150</td>
<td>Breed identification, health testing (PKD, HCM)</td>
</tr>
<tr class="even">
<td><strong>Salmon</strong></td>
<td>Affymetrix Axiom (custom)</td>
<td>200,000-500,000</td>
<td>Proprietary</td>
<td>Disease resistance, growth, commercial breeding</td>
</tr>
<tr class="odd">
<td><strong>Trout</strong></td>
<td>Rainbow Trout Axiom</td>
<td>57,000</td>
<td>Proprietary</td>
<td>Aquaculture breeding programs</td>
</tr>
</tbody>
</table>
<p><strong>Notes:</strong></p>
<ul>
<li>
<strong>GGP</strong> = GeneSeek Genomic Profiler (Neogen), widely used in cattle and swine</li>
<li>
<strong>LD, MD, HD</strong> = Low Density, Medium Density, High Density</li>
<li>Costs are approximate (2024-2025) and vary by volume, region, and service provider</li>
<li>Poultry and some aquaculture arrays are proprietary to breeding companies</li>
<li>Many species have multiple chip options (low vs.&nbsp;high density) for cost-effective imputation strategies</li>
</ul></section><section id="density-trade-offs-when-to-use-which-chip" class="level3" data-number="12.4.4"><h3 data-number="12.4.4" class="anchored" data-anchor-id="density-trade-offs-when-to-use-which-chip">
<span class="header-section-number">12.4.4</span> Density Trade-offs: When to Use Which Chip?</h3>
<p>Breeding programs often genotype animals with different density chips depending on their role:</p>
<p><strong>High-density chips (500K-800K SNPs):</strong></p>
<ul>
<li>
<strong>Reference animals:</strong> Influential sires, elite dams, animals in training populations</li>
<li>
<strong>Research:</strong> Fine-mapping QTL, whole-genome sequencing imputation reference</li>
<li>
<strong>Long-term value:</strong> Animals whose genotypes will be used repeatedly for relationship estimation</li>
</ul>
<p><strong>Medium-density chips (50K-100K SNPs):</strong></p>
<ul>
<li>
<strong>Selection candidates:</strong> Animals being evaluated for breeding decisions</li>
<li>
<strong>Routine genomic evaluations:</strong> Cost-effective, sufficient accuracy when imputed</li>
<li>
<strong>Good balance:</strong> Adequate LD coverage for most populations</li>
</ul>
<p><strong>Low-density chips (10K-30K SNPs):</strong></p>
<ul>
<li>
<strong>Commercial females:</strong> Replacement females not expected to be top-tier breeders</li>
<li>
<strong>Crossbred animals:</strong> Terminal market animals if breed composition is of interest</li>
<li>
<strong>Cost savings:</strong> Can be imputed to higher density with modest accuracy loss</li>
</ul>
<p><strong>Imputation strategy:</strong> Most programs genotype key animals (e.g., top 10%) with high-density chips, most selection candidates with medium-density, and commercial animals (if genotyped at all) with low-density. Missing genotypes are imputed using the high-density reference panel. This maximizes information while minimizing cost.</p>
<p><strong>Example: Dairy cattle genomic strategy</strong> A typical dairy breeding program might:</p>
<ul>
<li>Genotype elite bulls with BovineHD (777K) or sequence them → reference panel</li>
<li>Genotype bull calves (selection candidates) with GGP 50K → impute to HD</li>
<li>Genotype females with GGP-LD (30K) → impute to 50K or HD</li>
<li>Total cost per bull calf: ~$35, vs.&nbsp;$25,000+ for progeny testing</li>
</ul></section><section id="cost-trends-the-genomic-revolution-became-affordable" class="level3" data-number="12.4.5"><h3 data-number="12.4.5" class="anchored" data-anchor-id="cost-trends-the-genomic-revolution-became-affordable">
<span class="header-section-number">12.4.5</span> Cost Trends: The Genomic Revolution Became Affordable</h3>
<p>One reason genomics spread so rapidly is that genotyping costs plummeted.</p>
<p><strong>SNP chip cost trends (per animal):</strong></p>
<ul>
<li>
<strong>2008:</strong> BovineHD chip = $250</li>
<li>
<strong>2010:</strong> Bovine50K chip = $150</li>
<li>
<strong>2015:</strong> GGP 50K = $40</li>
<li>
<strong>2020:</strong> GGP 50K = $30, GGP-LD = $15</li>
<li>
<strong>2025:</strong> GGP 50K = $30-35, GGP-LD = $15-20</li>
</ul>
<p>This dramatic cost reduction—nearly 10-fold for routine genotyping—made genomics economically viable even for traits with modest economic value. Combined with imputation, programs can now genotype thousands of animals per year at costs far below traditional phenotyping and progeny testing.</p>
<p><strong>Whole genome sequencing</strong> (discussed next) is also declining in cost but remains more expensive (~$500-$2000/animal), so it’s reserved for key reference animals.</p>
</section></section><section id="bioinformatics-basics-quality-control-and-imputation" class="level2" data-number="12.5"><h2 data-number="12.5" class="anchored" data-anchor-id="bioinformatics-basics-quality-control-and-imputation">
<span class="header-section-number">12.5</span> Bioinformatics Basics: Quality Control and Imputation</h2>
<p>Once animals are genotyped, raw data must be processed and quality-controlled before use in genetic evaluations. <strong>Bioinformatics</strong> pipelines handle these steps.</p>
<section id="genotype-quality-control-qc" class="level3" data-number="12.5.1"><h3 data-number="12.5.1" class="anchored" data-anchor-id="genotype-quality-control-qc">
<span class="header-section-number">12.5.1</span> Genotype Quality Control (QC)</h3>
<p>Not all genotypes are called correctly. Poor-quality DNA, technical errors, or rare variants can lead to incorrect genotype calls. Quality control filters remove unreliable SNPs and samples before analysis.</p>
<section id="call-rate" class="level4"><h4 class="anchored" data-anchor-id="call-rate">Call Rate</h4>
<p><strong>Call rate</strong> measures the proportion of SNPs (or animals) successfully genotyped.</p>
<ul>
<li>
<strong>Animal call rate:</strong> Percentage of SNPs with successful genotype calls for a given animal</li>
<li>
<strong>SNP call rate:</strong> Percentage of animals with successful genotype calls for a given SNP</li>
</ul>
<p><strong>Thresholds (typical):</strong></p>
<ul>
<li>
<strong>Animal call rate:</strong> ≥ 90% (remove animals below this)</li>
<li>
<strong>SNP call rate:</strong> ≥ 95-98% (remove SNPs below this)</li>
</ul>
<p><strong>Why filter by call rate?</strong> Low call rates indicate poor DNA quality (for animals) or problematic SNP assays (for SNPs). Including them adds noise and can bias estimates.</p>
<p><strong>Example:</strong> You genotype 1,000 pigs on a 60K SNP chip:</p>
<ul>
<li>One pig has genotypes called for only 48,000 SNPs (call rate = 80%). → Remove this animal.</li>
<li>One SNP is successfully called in only 850 animals (call rate = 85%). → Remove this SNP.</li>
</ul>
<p>After filtering, you have ~995 pigs and ~58,000 SNPs remaining.</p>
</section><section id="minor-allele-frequency-maf" class="level4"><h4 class="anchored" data-anchor-id="minor-allele-frequency-maf">Minor Allele Frequency (MAF)</h4>
<p><strong>Minor allele frequency (MAF)</strong> is the frequency of the rarer allele at a SNP. Very low-MAF SNPs provide little information for genomic selection and are often genotyping errors or rare mutations.</p>
<p><strong>Typical MAF thresholds:</strong></p>
<ul>
<li>
<strong>MAF &lt; 0.01 or 0.05:</strong> Remove SNP</li>
<li>Rationale: Rare alleles contribute little to accuracy and increase computational burden</li>
</ul>
<p><strong>Why low-MAF SNPs are problematic:</strong></p>
<ol type="1">
<li>Low information content (most animals have the same genotype)</li>
<li>Potentially genotyping errors (singletons or doubletons)</li>
<li>Poor imputation accuracy (rare alleles hard to impute)</li>
</ol>
<p><strong>Example:</strong> A SNP in Holstein cattle has the following genotypes in 1,000 animals:</p>
<ul>
<li>Genotype 0 (AA): 980 animals</li>
<li>Genotype 1 (AG): 18 animals</li>
<li>Genotype 2 (GG): 2 animals</li>
</ul>
<p>Allele frequency for G: <span class="math inline">\(q = \frac{2(2) + 18}{2(1000)} = \frac{22}{2000} = 0.011\)</span></p>
<p>MAF = 0.011 (1.1%). This SNP would be removed if we use a MAF &gt; 0.05 threshold.</p>
</section><section id="hardy-weinberg-equilibrium-hwe" class="level4"><h4 class="anchored" data-anchor-id="hardy-weinberg-equilibrium-hwe">Hardy-Weinberg Equilibrium (HWE)</h4>
<p><strong>Hardy-Weinberg Equilibrium</strong> is a principle from population genetics stating that, under random mating and no selection or mutation, genotype frequencies should follow:</p>
<p><span class="math display">\[
P(AA) = p^2, \quad P(AG) = 2pq, \quad P(GG) = q^2
\]</span></p>
<p>Where <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span> are allele frequencies.</p>
<p><strong>Why test for HWE?</strong> Large deviations from HWE can indicate:</p>
<ul>
<li>Genotyping errors (e.g., heterozygotes miscalled as homozygotes)</li>
<li>Population substructure (non-random mating)</li>
<li>Selection at the locus</li>
</ul>
<p><strong>HWE filtering:</strong> SNPs with extreme HWE p-values (e.g., <span class="math inline">\(p &lt; 10^{-6}\)</span>) are often removed. However, some deviation is expected in selected populations, so thresholds must be chosen carefully.</p>
<p><strong>Example:</strong> Suppose we observe 100 animals with:</p>
<ul>
<li>Genotype 0: 50 animals</li>
<li>Genotype 1: 20 animals</li>
<li>Genotype 2: 30 animals</li>
</ul>
<p>Expected under HWE (if <span class="math inline">\(p = 0.60\)</span>):</p>
<ul>
<li>
<span class="math inline">\(P(AA) = 0.36\)</span> → 36 animals</li>
<li>
<span class="math inline">\(P(AG) = 0.48\)</span> → 48 animals</li>
<li>
<span class="math inline">\(P(GG) = 0.16\)</span> → 16 animals</li>
</ul>
<p>Observed heterozygosity (20) is much lower than expected (48), suggesting possible genotyping errors. A chi-square test would flag this SNP for removal.</p>
</section></section><section id="imputation" class="level3" data-number="12.5.2"><h3 data-number="12.5.2" class="anchored" data-anchor-id="imputation">
<span class="header-section-number">12.5.2</span> Imputation</h3>
<p><strong>Imputation</strong> is the process of predicting missing genotypes or “filling in” low-density genotypes to higher density using a reference panel of animals genotyped at high density.</p>
<section id="why-imputation" class="level4"><h4 class="anchored" data-anchor-id="why-imputation">Why Imputation?</h4>
<p>Imputation enables cost-effective genotyping strategies:</p>
<ol type="1">
<li>
<strong>Cost savings:</strong> Genotype most animals with cheap low-density chips; impute to high-density</li>
<li>
<strong>Combining datasets:</strong> Merge animals genotyped on different chips</li>
<li>
<strong>Whole-genome sequence imputation:</strong> Impute chip genotypes to full sequence using sequenced reference animals</li>
</ol>
<p><strong>Example:</strong> A swine breeding program genotypes 5,000 selection candidates per year:</p>
<ul>
<li>
<strong>Without imputation:</strong> Genotype all with 60K chip at $60/animal = $300,000/year</li>
<li>
<strong>With imputation:</strong> Genotype with 20K chip at $25/animal = $125,000/year; impute to 60K using reference panel</li>
</ul>
<p><strong>Savings:</strong> $175,000/year (58% reduction)</p>
</section><section id="how-imputation-works-conceptually" class="level4"><h4 class="anchored" data-anchor-id="how-imputation-works-conceptually">How Imputation Works (Conceptually)</h4>
<p>Imputation exploits <strong>linkage disequilibrium</strong> and <strong>pedigree relationships</strong>.</p>
<ol type="1">
<li>
<strong>Reference panel:</strong> Animals genotyped at high density (or sequenced)</li>
<li>
<strong>Target animals:</strong> Animals genotyped at low density (subset of SNPs)</li>
<li>
<strong>Shared haplotypes:</strong> Target animals share chromosome segments (haplotypes) with reference animals due to common ancestry</li>
<li>
<strong>Prediction:</strong> For each missing SNP in target animals, predict genotype based on reference haplotypes that match surrounding SNPs</li>
</ol>
<p><strong>Software:</strong> Commonly used imputation programs include FImpute, Beagle, Minimac4, and Eagle.</p>
</section><section id="accuracy-of-imputation" class="level4"><h4 class="anchored" data-anchor-id="accuracy-of-imputation">Accuracy of Imputation</h4>
<p>Imputation accuracy depends on:</p>
<ul>
<li>
<strong>Reference panel size:</strong> Larger reference = better accuracy</li>
<li>
<strong>Relationship to reference:</strong> Close relatives impute more accurately</li>
<li>
<strong>LD in population:</strong> High LD (recent common ancestors) = better accuracy</li>
<li>
<strong>SNP density:</strong> Denser low-density chip = better imputation</li>
<li>
<strong>MAF of SNP:</strong> Common alleles impute better than rare alleles</li>
</ul>
<p><strong>Typical accuracy (correlation between true and imputed genotypes):</strong></p>
<ul>
<li>Low-density (10K) → medium-density (50K): 0.90-0.95</li>
<li>Medium-density (50K) → high-density (770K): 0.95-0.98</li>
<li>High-density → sequence: 0.85-0.95 (depends on MAF and reference panel)</li>
</ul>
<p><strong>Example:</strong> Dairy cattle are imputed from GGP-LD (30K) to BovineHD (777K) using a reference panel of 5,000 sequenced bulls. Imputation accuracy for common SNPs (MAF &gt; 0.05) exceeds 0.98, meaning &lt;2% of imputed genotypes are incorrect. For rare variants (MAF &lt; 0.01), accuracy may drop to 0.70-0.80.</p>
</section><section id="economic-calculation-imputation-cost-benefit" class="level4"><h4 class="anchored" data-anchor-id="economic-calculation-imputation-cost-benefit">Economic Calculation: Imputation Cost-Benefit</h4>
<p>Let’s calculate the cost-effectiveness of imputation for a beef cattle seedstock operation:</p>
<p><strong>Scenario:</strong> - Evaluate 500 bull calves per year for genomic EPDs - Option A: Genotype all with 50K chip ($40/animal) - Option B: Genotype all with LD chip ($18/animal), impute to 50K</p>
<p><strong>Costs:</strong></p>
<ul>
<li>
<strong>Option A:</strong> $40 × 500 = $20,000/year</li>
<li>
<strong>Option B:</strong> $18 × 500 + $2,000 (reference panel maintenance) = $11,000/year</li>
</ul>
<p><strong>Accuracy loss:</strong> Imputed 50K genotypes have ~0.95 correlation with true genotypes. This causes a small reduction in genomic prediction accuracy (maybe 0.02-0.03 correlation units), but the cost savings far outweigh the minor accuracy loss.</p>
<p><strong>Decision:</strong> Most programs choose Option B (imputation).</p>
</section></section></section><section id="whole-genome-sequencing-wgs" class="level2" data-number="12.6"><h2 data-number="12.6" class="anchored" data-anchor-id="whole-genome-sequencing-wgs">
<span class="header-section-number">12.6</span> Whole Genome Sequencing (WGS)</h2>
<p>While SNP chips genotype selected locations, <strong>whole genome sequencing</strong> determines the DNA sequence at every base pair.</p>
<section id="what-is-whole-genome-sequencing" class="level3" data-number="12.6.1"><h3 data-number="12.6.1" class="anchored" data-anchor-id="what-is-whole-genome-sequencing">
<span class="header-section-number">12.6.1</span> What is Whole Genome Sequencing?</h3>
<p><strong>Whole genome sequencing (WGS)</strong> is the process of determining the complete DNA sequence of an organism’s genome—roughly 3 billion base pairs in cattle, 2.8 billion in pigs, 1 billion in chickens.</p>
<p>Modern sequencing technologies (Illumina short-read sequencing, PacBio long-read sequencing) can sequence entire genomes in days at decreasing cost. The result is a file containing every nucleotide in the genome, including all SNPs, insertions, deletions, and structural variants.</p>
</section><section id="wgs-vs.-snp-chips" class="level3" data-number="12.6.2"><h3 data-number="12.6.2" class="anchored" data-anchor-id="wgs-vs.-snp-chips">
<span class="header-section-number">12.6.2</span> WGS vs.&nbsp;SNP Chips</h3>
<p>How do SNP chips and WGS compare?</p>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 22%">
<col style="width: 56%">
</colgroup>
<thead><tr class="header">
<th>Feature</th>
<th>SNP Chip</th>
<th>Whole Genome Sequencing</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>Variants detected</strong></td>
<td>50,000-800,000 (fixed panel)</td>
<td>Millions (all variants)</td>
</tr>
<tr class="even">
<td><strong>Cost per animal (2025)</strong></td>
<td>$15-150</td>
<td>$300-2,000</td>
</tr>
<tr class="odd">
<td><strong>Sequencing depth</strong></td>
<td>Not applicable</td>
<td>10-30× (coverage per base)</td>
</tr>
<tr class="even">
<td><strong>Causal mutations</strong></td>
<td>Likely in LD with causals</td>
<td>Can identify directly</td>
</tr>
<tr class="odd">
<td><strong>Structural variants</strong></td>
<td>Not detected</td>
<td>Detected (insertions, deletions, CNVs)</td>
</tr>
<tr class="even">
<td><strong>Data size</strong></td>
<td>~5-50 MB per animal</td>
<td>30-100 GB per animal</td>
</tr>
<tr class="odd">
<td><strong>Processing time</strong></td>
<td>Hours</td>
<td>Days to weeks</td>
</tr>
<tr class="even">
<td><strong>Primary use</strong></td>
<td>Routine genomic selection</td>
<td>Research, reference panels, QTN discovery</td>
</tr>
</tbody>
</table>
<p><strong>Key differences:</strong></p>
<ol type="1">
<li>
<strong>Coverage:</strong> WGS captures all genetic variation; chips capture only pre-selected SNPs</li>
<li>
<strong>Cost:</strong> WGS is 10-100× more expensive per animal</li>
<li>
<strong>Causal variants:</strong> WGS can find the actual mutations causing trait variation; chips rely on LD</li>
<li>
<strong>Data management:</strong> WGS generates massive datasets requiring significant storage and computing</li>
</ol></section><section id="uses-of-whole-genome-sequencing" class="level3" data-number="12.6.3"><h3 data-number="12.6.3" class="anchored" data-anchor-id="uses-of-whole-genome-sequencing">
<span class="header-section-number">12.6.3</span> Uses of Whole Genome Sequencing</h3>
<p>WGS is not yet routine for all animals but has several important applications:</p>
<section id="identifying-causal-mutations-qtn" class="level4"><h4 class="anchored" data-anchor-id="identifying-causal-mutations-qtn">1. Identifying Causal Mutations (QTN)</h4>
<p>The “holy grail” of genomics is finding <strong>Quantitative Trait Nucleotides (QTN)</strong>—the specific mutations causing variation in traits. WGS enables this through:</p>
<ul>
<li>
<strong>Fine-mapping:</strong> Narrow GWAS signals to single genes or variants</li>
<li>
<strong>Candidate gene sequencing:</strong> Sequence genes in QTL regions to find causal mutations</li>
<li>
<strong>Functional validation:</strong> Test whether variants affect gene expression or protein function</li>
</ul>
<p><strong>Example: POLLED mutation in cattle</strong> Horns vs.&nbsp;polled (naturally hornless) cattle is controlled by a variant in the POLLED gene on chromosome 1. WGS identified the causal variant—a duplication and complex rearrangement. Now breeders can genotype this variant directly (via SNP chip or targeted test) to select for polled cattle, eliminating the need for dehorning.</p>
</section><section id="building-imputation-reference-panels" class="level4"><h4 class="anchored" data-anchor-id="building-imputation-reference-panels">2. Building Imputation Reference Panels</h4>
<p>Many breeding programs sequence key influential animals (elite sires, foundation dams) to create reference panels. Other animals are genotyped on chips and imputed to sequence level.</p>
<p><strong>Benefits:</strong></p>
<ul>
<li>Capture rare variants that aren’t on chips</li>
<li>Increase genomic prediction accuracy (slightly)</li>
<li>Enable QTN discovery in the population</li>
</ul>
<p><strong>Example: 1000 Bull Genomes Project</strong> An international consortium sequenced &gt;10,000 cattle (bulls and cows) from many breeds. This reference panel is used worldwide to impute chip genotypes to sequence, enabling discovery of breed-specific and rare variants.</p>
</section><section id="structural-variants-svs" class="level4"><h4 class="anchored" data-anchor-id="structural-variants-svs">3. Structural Variants (SVs)</h4>
<p>SNP chips detect single-base changes but miss larger variants:</p>
<ul>
<li>
<strong>Insertions/deletions (indels):</strong> Small (1-1000 bp) or large (&gt;1 kb)</li>
<li>
<strong>Copy number variants (CNVs):</strong> Duplications or deletions of large segments</li>
<li>
<strong>Inversions:</strong> Flipped chromosomal segments</li>
<li>
<strong>Translocations:</strong> Movement of segments between chromosomes</li>
</ul>
<p>Some SVs have large effects on traits. WGS is required to detect them.</p>
<p><strong>Example: KIT duplication in pigs</strong> A duplication in the KIT gene causes the “dominant white” coat color in pigs (used in Large White and Landrace breeds). This variant is a CNV not easily detected by SNP chips.</p>
</section><section id="research-applications" class="level4"><h4 class="anchored" data-anchor-id="research-applications">4. Research Applications</h4>
<p>WGS is essential for:</p>
<ul>
<li>Genome assembly and annotation (building reference genomes)</li>
<li>Evolutionary studies (comparing species, breeds)</li>
<li>Functional genomics (gene expression, regulation)</li>
<li>Rare disease gene discovery</li>
</ul></section></section><section id="wgs-in-practice-cost-effective-strategies" class="level3" data-number="12.6.4"><h3 data-number="12.6.4" class="anchored" data-anchor-id="wgs-in-practice-cost-effective-strategies">
<span class="header-section-number">12.6.4</span> WGS in Practice: Cost-Effective Strategies</h3>
<p>While WGS is expensive, strategic use makes it feasible:</p>
<p><strong>Key animal sequencing strategy:</strong></p>
<ul>
<li>Sequence top 1-5% of population (elite sires, influential dams)</li>
<li>Use these as reference panel</li>
<li>Genotype all selection candidates on chips ($30-50)</li>
<li>Impute chip genotypes to sequence level</li>
<li>Use imputed sequence for genomic prediction</li>
</ul>
<p><strong>Example: Salmon breeding</strong> A salmon breeding company sequences 200 elite fish (cost: ~$200,000). They genotype 20,000 selection candidates on custom 200K SNP chips (cost: $500,000). Impute to sequence. Total cost: $700,000 for 20,000 animals sequenced-equivalent = $35/animal (much cheaper than sequencing all).</p>
</section></section><section id="from-genotypes-to-genomic-predictions" class="level2" data-number="12.7"><h2 data-number="12.7" class="anchored" data-anchor-id="from-genotypes-to-genomic-predictions">
<span class="header-section-number">12.7</span> From Genotypes to Genomic Predictions</h2>
<p>We’ve discussed what SNPs are, how we measure them, and how we process the data. Now: how do genotypes predict breeding values?</p>
<p>The short answer: genotypes across the genome capture variation in <strong>true breeding values</strong> because SNPs are in <strong>linkage disequilibrium</strong> with the actual causal mutations affecting traits. By estimating effects of many SNPs simultaneously (using phenotypic and genotypic data from a training population), we can predict the breeding value of any genotyped animal—even newborns with no phenotype or progeny.</p>
<section id="genomic-relationship-matrix-preview" class="level3" data-number="12.7.1"><h3 data-number="12.7.1" class="anchored" data-anchor-id="genomic-relationship-matrix-preview">
<span class="header-section-number">12.7.1</span> Genomic Relationship Matrix (Preview)</h3>
<p>One key concept we’ll explore further in Chapter 13 is the <strong>genomic relationship matrix (G)</strong>. This matrix quantifies the genetic similarity between all pairs of animals based on their SNP genotypes.</p>
<p>Unlike pedigree-based relationships (which are expected values), genomic relationships are <strong>realized relationships</strong>—they capture the actual sharing of chromosome segments due to inheritance.</p>
<p><strong>Key idea:</strong> Two full siblings share 50% of their genes <em>on average</em> (pedigree relationship = 0.50), but the actual sharing varies due to <strong>Mendelian sampling</strong> (random segregation of chromosomes). One sibling might inherit more favorable alleles, the other fewer. Genomic relationships capture this realized variation.</p>
<p>We’ll calculate the G matrix and use it for genomic predictions in Chapter 13. For now, understand that genotypes provide far more information than pedigrees alone.</p>
</section></section><section id="applications-of-genomics-in-animal-breeding" class="level2" data-number="12.8"><h2 data-number="12.8" class="anchored" data-anchor-id="applications-of-genomics-in-animal-breeding">
<span class="header-section-number">12.8</span> Applications of Genomics in Animal Breeding</h2>
<p>Genomics has many applications beyond genomic selection (which we’ll cover in Chapter 13). Here are the most important uses in modern breeding programs:</p>
<section id="genomic-selection" class="level3" data-number="12.8.1"><h3 data-number="12.8.1" class="anchored" data-anchor-id="genomic-selection">
<span class="header-section-number">12.8.1</span> 1. Genomic Selection</h3>
<p><strong>Genomic selection</strong> is the primary application—using genome-wide SNP data to predict breeding values and make selection decisions. It has revolutionized animal breeding by increasing accuracy and reducing generation intervals.</p>
<p><strong>Key points:</strong></p>
<ul>
<li>Predict breeding values (GEBVs) at birth</li>
<li>Accuracy often 0.50-0.70 for young animals without own phenotypes</li>
<li>Much higher than parent average (~0.30-0.40)</li>
<li>Enabled dairy cattle to double genetic gain per year</li>
</ul>
<p>We’ll explore genomic selection methods in detail in Chapter 13.</p>
</section><section id="parentage-verification-and-pedigree-correction" class="level3" data-number="12.8.2"><h3 data-number="12.8.2" class="anchored" data-anchor-id="parentage-verification-and-pedigree-correction">
<span class="header-section-number">12.8.2</span> 2. Parentage Verification and Pedigree Correction</h3>
<p>Recorded pedigrees often contain errors—misidentified sires or dams, incorrect birth records, etc. Errors are especially common in:</p>
<ul>
<li>Multi-sire breeding (multiple bulls with a group of cows)</li>
<li>Natural mating (paternity uncertain)</li>
<li>Record-keeping errors</li>
</ul>
<p>SNP genotypes enable accurate parentage verification and correction.</p>
<p><strong>How it works:</strong> Each offspring inherits exactly one allele at each SNP from each parent. By comparing offspring and candidate parents’ genotypes, we can identify true parents (many SNPs match Mendelian inheritance) and exclude false parents (many SNPs violate Mendelian rules).</p>
<p><strong>Software:</strong> Parentage programs (e.g., COLONY, AlphaAssign, BreedAssign) calculate likelihood ratios for each candidate parent pair.</p>
<p><strong>Example: Beef cattle</strong> A commercial cow-calf operation uses multi-sire breeding (4 bulls with 200 cows). After calving, all calves and bulls are genotyped. Parentage analysis assigns each calf to its true sire with &gt;99% confidence. This enables accurate pedigree-based or genomic evaluation, improving selection accuracy.</p>
<p><strong>Impact:</strong> Pedigree errors reduce genetic progress. Correcting pedigrees with genomics increases accuracy by 0.05-0.10 correlation units—a substantial gain.</p>
</section><section id="genome-wide-association-studies-gwas" class="level3" data-number="12.8.3"><h3 data-number="12.8.3" class="anchored" data-anchor-id="genome-wide-association-studies-gwas">
<span class="header-section-number">12.8.3</span> 3. Genome-Wide Association Studies (GWAS)</h3>
<p><strong>Genome-Wide Association Studies (GWAS)</strong> scan the genome to identify SNPs (or chromosomal regions) associated with traits of interest.</p>
<p><strong>Procedure:</strong></p>
<ol type="1">
<li>Measure phenotypes for a trait (e.g., milk yield) in many animals</li>
<li>Genotype all animals on SNP chip</li>
<li>Test each SNP for association with the trait (regression or ANOVA)</li>
<li>Identify SNPs with significant associations (after correcting for multiple testing)</li>
<li>Investigate nearby genes as candidates for causal mutations</li>
</ol>
<p><strong>GWAS can:</strong></p>
<ul>
<li>Discover QTL (Quantitative Trait Loci) affecting traits</li>
<li>Identify candidate genes for further study</li>
<li>Prioritize causal variants for functional testing</li>
<li>Improve genomic predictions (if causal variants are included)</li>
</ul>
<p><strong>Example: Milk fat percentage in dairy cattle</strong> GWAS identified a strong signal on chromosome 14 associated with milk fat percentage. The causal gene was later confirmed to be DGAT1 (diacylglycerol acyltransferase 1), which encodes an enzyme in fat synthesis. A specific SNP in DGAT1 (K232A) explains ~50% of genetic variance in fat percentage.</p>
<p><strong>Limitations:</strong> GWAS requires large sample sizes (thousands of animals) and only detects common variants with moderate-to-large effects. Rare variants and small-effect loci are missed.</p>
</section><section id="genomic-management-of-inbreeding" class="level3" data-number="12.8.4"><h3 data-number="12.8.4" class="anchored" data-anchor-id="genomic-management-of-inbreeding">
<span class="header-section-number">12.8.4</span> 4. Genomic Management of Inbreeding</h3>
<p>Inbreeding reduces performance (inbreeding depression) and should be managed carefully. Traditional approaches use <strong>pedigree-based</strong> inbreeding coefficients, but these are expected values—they don’t capture actual inbreeding due to Mendelian sampling.</p>
<p><strong>Genomic inbreeding</strong> measures realized inbreeding directly from SNP genotypes. Several methods exist:</p>
<ul>
<li>
<strong>Runs of homozygosity (ROH):</strong> Long stretches of homozygous SNPs indicate recent inbreeding</li>
<li>
<strong>Genomic inbreeding coefficient (F_G):</strong> Deviation of observed homozygosity from expected</li>
<li>
<strong>Genomic relationship to base population:</strong> Diagonal elements of G matrix</li>
</ul>
<p><strong>Why genomic inbreeding matters:</strong> Two animals with the same pedigree inbreeding (e.g., <span class="math inline">\(F = 0.10\)</span>) can have different realized inbreeding. Genomic measures reveal which animals are truly inbred, enabling better mating decisions.</p>
<p><strong>Application: Optimum contribution selection (OCS)</strong> Modern mating programs use genomic relationships to minimize inbreeding while maximizing genetic gain. This balances selection intensity with genetic diversity.</p>
<p><strong>Example: Dutch Holstein cattle</strong> Genomic selection increased selection intensity, accelerating inbreeding rate. To counteract this, breeding organizations implemented genomic OCS, constraining inbreeding by limiting mating of close genomic relatives. Genetic diversity was stabilized while maintaining rapid genetic gain.</p>
</section><section id="identification-of-genetic-defects-and-disease-mutations" class="level3" data-number="12.8.5"><h3 data-number="12.8.5" class="anchored" data-anchor-id="identification-of-genetic-defects-and-disease-mutations">
<span class="header-section-number">12.8.5</span> 5. Identification of Genetic Defects and Disease Mutations</h3>
<p>Some inherited diseases are caused by single genes with large effects (recessive lethals, dominant disorders). Genomics enables discovery and management of these mutations.</p>
<p><strong>Process:</strong></p>
<ol type="1">
<li>Identify affected animals (e.g., calves with lethal defect)</li>
<li>Sequence affected and normal animals</li>
<li>Find causal mutation (often recessive)</li>
<li>Develop diagnostic test (SNP chip or targeted assay)</li>
<li>Test breeding animals; avoid matings producing affected offspring</li>
</ol>
<p><strong>Examples in cattle:</strong></p>
<ul>
<li>
<strong>CVM (Complex Vertebral Malformation):</strong> Recessive lethal in Holsteins. Carriers identified via SNP test; matings between carriers avoided.</li>
<li>
<strong>Cholesterol deficiency:</strong> Recessive lethal in Holsteins. Causative mutation in APOB gene identified via WGS.</li>
<li>
<strong>Tibial hemimelia:</strong> Recessive lethal in Herefords. Mutation in ULBP23 gene identified.</li>
</ul>
<p><strong>Examples in dogs:</strong></p>
<ul>
<li>
<strong>Progressive Retinal Atrophy (PRA):</strong> Causes blindness in many breeds. Multiple gene mutations identified (e.g., PRCD-PRA); DNA tests available.</li>
<li>
<strong>Degenerative Myelopathy (DM):</strong> Neurological disease in German Shepherds and others. Mutation in SOD1 gene; testing prevents affected puppies.</li>
<li>
<strong>von Willebrand Disease (vWD):</strong> Bleeding disorder in Dobermans and other breeds. Mutation in VWF gene; genotype before breeding.</li>
</ul>
<p><strong>Example in cats:</strong></p>
<ul>
<li>
<strong>Polycystic Kidney Disease (PKD):</strong> Inherited kidney disease in Persians and related breeds. Mutation in PKD1 gene identified; testing eliminates disease from breeding populations.</li>
</ul>
<p><strong>Impact:</strong> Genomic testing has virtually eliminated many lethal recessives from purebred livestock and companion animal populations. This improves animal welfare and reduces economic losses.</p>
</section><section id="crossbred-performance-and-breed-composition" class="level3" data-number="12.8.6"><h3 data-number="12.8.6" class="anchored" data-anchor-id="crossbred-performance-and-breed-composition">
<span class="header-section-number">12.8.6</span> 6. Crossbred Performance and Breed Composition</h3>
<p>In crossbreeding systems (common in swine, beef cattle, sheep), knowing an animal’s <strong>breed composition</strong> is valuable. Genomics can estimate breed proportions and predict crossbred performance.</p>
<p><strong>Breed composition from SNPs:</strong> Different breeds have distinct allele frequencies at many SNPs. By comparing an animal’s genotypes to reference populations (purebred animals from each breed), we can estimate the percentage of each breed in its ancestry.</p>
<p><strong>Software:</strong> ADMIXTURE, STRUCTURE</p>
<p><strong>Example: Beef cattle</strong> A commercial cow is genotyped. Analysis reveals she is 60% Angus, 30% Hereford, 10% Simmental. This information can guide mating decisions (e.g., use terminal sire to maximize heterosis) and explain performance (e.g., higher marbling from Angus ancestry).</p>
<p><strong>Crossbred genomic prediction:</strong> Recent methods extend genomic selection to crossbreds by modeling breed-specific SNP effects. This improves accuracy in commercial crossbred populations.</p>
</section></section><section id="r-demonstrations-working-with-genotype-data" class="level2" data-number="12.9"><h2 data-number="12.9" class="anchored" data-anchor-id="r-demonstrations-working-with-genotype-data">
<span class="header-section-number">12.9</span> R Demonstrations: Working with Genotype Data</h2>
<p>Let’s work through some practical examples using R to explore SNP genotype data, calculate allele frequencies, perform quality control, and preview genomic relationships.</p>
<section id="demo-1-simulating-and-exploring-snp-genotype-data" class="level3" data-number="12.9.1"><h3 data-number="12.9.1" class="anchored" data-anchor-id="demo-1-simulating-and-exploring-snp-genotype-data">
<span class="header-section-number">12.9.1</span> Demo 1: Simulating and Exploring SNP Genotype Data</h3>
<p>First, we’ll simulate a SNP genotype dataset for 100 animals and 1,000 SNPs. In practice, you’d load real data from a file (e.g., PLINK format, VCF), but simulation lets us understand the structure.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Simulate SNP genotypes for 100 animals, 1000 SNPs</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">n_animals</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">n_snps</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span></span>
<span><span class="co"># Generate genotypes (0, 1, 2) assuming Hardy-Weinberg proportions</span></span>
<span><span class="co"># Allele frequency p ~ Uniform(0.2, 0.8) for each SNP</span></span>
<span><span class="va">allele_freq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">n_snps</span>, min <span class="op">=</span> <span class="fl">0.20</span>, max <span class="op">=</span> <span class="fl">0.80</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Genotype matrix: rows = animals, columns = SNPs</span></span>
<span><span class="va">genotypes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, nrow <span class="op">=</span> <span class="va">n_animals</span>, ncol <span class="op">=</span> <span class="va">n_snps</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n_snps</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">p</span> <span class="op">&lt;-</span> <span class="va">allele_freq</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>  <span class="co"># Hardy-Weinberg genotype frequencies</span></span>
<span>  <span class="va">freq_0</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>  <span class="co"># P(AA)</span></span>
<span>  <span class="va">freq_1</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">p</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p</span><span class="op">)</span>  <span class="co"># P(AG)</span></span>
<span>  <span class="va">freq_2</span> <span class="op">&lt;-</span> <span class="va">p</span><span class="op">^</span><span class="fl">2</span>  <span class="co"># P(GG)</span></span>
<span></span>
<span>  <span class="va">genotypes</span><span class="op">[</span>, <span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, size <span class="op">=</span> <span class="va">n_animals</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                           prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">freq_0</span>, <span class="va">freq_1</span>, <span class="va">freq_2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Add some missing data (simulate incomplete genotyping)</span></span>
<span><span class="va">missing_idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n_animals</span> <span class="op">*</span> <span class="va">n_snps</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">0.01</span> <span class="op">*</span> <span class="va">n_animals</span> <span class="op">*</span> <span class="va">n_snps</span><span class="op">)</span></span>
<span><span class="va">genotypes</span><span class="op">[</span><span class="va">missing_idx</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span></span>
<span><span class="co"># Create a tibble for easier manipulation</span></span>
<span><span class="va">animal_ids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Animal_"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">n_animals</span><span class="op">)</span></span>
<span><span class="va">snp_ids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"SNP_"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">n_snps</span><span class="op">)</span></span>
<span></span>
<span><span class="va">geno_df</span> <span class="op">&lt;-</span> <span class="fu">as_tibble</span><span class="op">(</span><span class="va">genotypes</span>, .name_repair <span class="op">=</span> <span class="st">"minimal"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">geno_df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">snp_ids</span></span>
<span><span class="va">geno_df</span> <span class="op">&lt;-</span> <span class="va">geno_df</span> <span class="op">%&gt;%</span> <span class="fu">mutate</span><span class="op">(</span>Animal_ID <span class="op">=</span> <span class="va">animal_ids</span>, .before <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display first few animals and SNPs</span></span>
<span><span class="va">geno_df</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">11</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Animal_ID"],"name":[1],"type":["chr"],"align":["left"]},{"label":["SNP_1"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["SNP_2"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["SNP_3"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["SNP_4"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["SNP_5"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["SNP_6"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["SNP_7"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["SNP_8"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["SNP_9"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["SNP_10"],"name":[11],"type":["dbl"],"align":["right"]}],"data":[{"1":"Animal_1","2":"1","3":"2","4":"1","5":"1","6":"2","7":"1","8":"2","9":"0","10":"2","11":"0"},{"1":"Animal_2","2":"2","3":"1","4":"1","5":"0","6":"1","7":"0","8":"2","9":"0","10":"1","11":"2"},{"1":"Animal_3","2":"1","3":"1","4":"0","5":"2","6":"2","7":"1","8":"2","9":"1","10":"1","11":"0"},{"1":"Animal_4","2":"2","3":"2","4":"1","5":"2","6":"1","7":"0","8":"1","9":"0","10":"0","11":"2"},{"1":"Animal_5","2":"2","3":"2","4":"0","5":"2","6":"1","7":"1","8":"2","9":"0","10":"2","11":"1"},{"1":"Animal_6","2":"2","3":"1","4":"2","5":"1","6":"1","7":"2","8":"2","9":"1","10":"2","11":"0"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Each row is an animal, each column (except the first) is a SNP. Values are 0, 1, 2, or NA (missing).</p>
</section><section id="demo-2-calculate-and-visualize-allele-frequencies" class="level3" data-number="12.9.2"><h3 data-number="12.9.2" class="anchored" data-anchor-id="demo-2-calculate-and-visualize-allele-frequencies">
<span class="header-section-number">12.9.2</span> Demo 2: Calculate and Visualize Allele Frequencies</h3>
<p>Let’s calculate allele frequencies for all SNPs and visualize the distribution.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Calculate allele frequencies (frequency of "2" allele)</span></span>
<span><span class="co"># Allele freq p = (2 * n_2 + n_1) / (2 * n_total)</span></span>
<span><span class="va">calc_allele_freq</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">geno_vec</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">geno_vec</span> <span class="op">&lt;-</span> <span class="va">geno_vec</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">geno_vec</span><span class="op">)</span><span class="op">]</span>  <span class="co"># Remove missing</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">geno_vec</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">n_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">geno_vec</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="va">n_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">geno_vec</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">n_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">geno_vec</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">p</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">n_2</span> <span class="op">+</span> <span class="va">n_1</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">geno_vec</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Apply to all SNPs</span></span>
<span><span class="va">allele_freqs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">genotypes</span>, <span class="fl">2</span>, <span class="va">calc_allele_freq</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create data frame</span></span>
<span><span class="va">freq_df</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span></span>
<span>  SNP <span class="op">=</span> <span class="va">snp_ids</span>,</span>
<span>  Allele_Frequency <span class="op">=</span> <span class="va">allele_freqs</span>,</span>
<span>  MAF <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">allele_freqs</span> <span class="op">&lt;=</span> <span class="fl">0.5</span>, <span class="va">allele_freqs</span>, <span class="fl">1</span> <span class="op">-</span> <span class="va">allele_freqs</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualize allele frequency distribution</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">freq_df</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Allele_Frequency</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">30</span>, fill <span class="op">=</span> <span class="st">"steelblue"</span>, color <span class="op">=</span> <span class="st">"black"</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Distribution of Allele Frequencies Across SNPs"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Allele Frequency (p)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Number of SNPs"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="12-genomics-intro_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Summary statistics</span></span>
<span><span class="va">freq_df</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span></span>
<span>    Mean_AF <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Allele_Frequency</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    Min_AF <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">Allele_Frequency</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    Max_AF <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">Allele_Frequency</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    Mean_MAF <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">MAF</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Mean_AF"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Min_AF"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Max_AF"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Mean_MAF"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"0.49365","2":"0.145","3":"0.8434343","4":"0.3471803"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>The histogram shows most SNPs have intermediate allele frequencies (0.3-0.7), which is typical in commercial populations after selection for many generations.</p>
</section><section id="demo-3-quality-control-workflow" class="level3" data-number="12.9.3"><h3 data-number="12.9.3" class="anchored" data-anchor-id="demo-3-quality-control-workflow">
<span class="header-section-number">12.9.3</span> Demo 3: Quality Control Workflow</h3>
<p>Now let’s perform quality control by filtering SNPs and animals based on call rate and MAF.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Step 1: Calculate SNP call rate (proportion of animals with genotype)</span></span>
<span><span class="va">snp_call_rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">genotypes</span>, <span class="fl">2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Step 2: Calculate animal call rate (proportion of SNPs with genotype)</span></span>
<span><span class="va">animal_call_rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">genotypes</span>, <span class="fl">1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Summary</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"SNP call rate summary:\n"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>SNP call rate summary:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">snp_call_rate</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.94    0.98    0.99    0.99    1.00    1.00 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\nAnimal call rate summary:\n"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Animal call rate summary:</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">animal_call_rate</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.978   0.988   0.991   0.990   0.992   0.997 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Step 3: Filter SNPs by call rate (threshold: 95%)</span></span>
<span><span class="va">snp_pass_callrate</span> <span class="op">&lt;-</span> <span class="va">snp_call_rate</span> <span class="op">&gt;=</span> <span class="fl">0.95</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\nSNPs passing call rate filter (&gt;=95%):"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">snp_pass_callrate</span><span class="op">)</span>, <span class="st">"/"</span>, <span class="va">n_snps</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
SNPs passing call rate filter (&gt;=95%): 999 / 1000 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Step 4: Filter SNPs by MAF (threshold: 5%)</span></span>
<span><span class="va">snp_pass_maf</span> <span class="op">&lt;-</span> <span class="va">freq_df</span><span class="op">$</span><span class="va">MAF</span> <span class="op">&gt;=</span> <span class="fl">0.05</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"SNPs passing MAF filter (&gt;=0.05):"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">snp_pass_maf</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="st">"/"</span>, <span class="va">n_snps</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>SNPs passing MAF filter (&gt;=0.05): 1000 / 1000 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Combined filter</span></span>
<span><span class="va">snp_pass</span> <span class="op">&lt;-</span> <span class="va">snp_pass_callrate</span> <span class="op">&amp;</span> <span class="va">snp_pass_maf</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"SNPs passing all QC:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">snp_pass</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="st">"/"</span>, <span class="va">n_snps</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>SNPs passing all QC: 999 / 1000 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Step 5: Filter animals by call rate (threshold: 90%)</span></span>
<span><span class="va">animal_pass</span> <span class="op">&lt;-</span> <span class="va">animal_call_rate</span> <span class="op">&gt;=</span> <span class="fl">0.90</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\nAnimals passing call rate filter (&gt;=90%):"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">animal_pass</span><span class="op">)</span>, <span class="st">"/"</span>, <span class="va">n_animals</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Animals passing call rate filter (&gt;=90%): 100 / 100 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Apply filters</span></span>
<span><span class="va">genotypes_qc</span> <span class="op">&lt;-</span> <span class="va">genotypes</span><span class="op">[</span><span class="va">animal_pass</span>, <span class="va">snp_pass</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\nFinal dataset after QC: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">genotypes_qc</span><span class="op">)</span>, <span class="st">"animals x"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">genotypes_qc</span><span class="op">)</span>, <span class="st">"SNPs\n"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Final dataset after QC:  100 animals x 999 SNPs</code></pre>
</div>
</div>
<p>After QC, we’ve removed low-quality SNPs and animals, leaving a clean dataset for genomic analysis.</p>
<p><strong>Quality control summary:</strong></p>
<ul>
<li>
<strong>Before QC:</strong> 100 animals, 1,000 SNPs</li>
<li>
<strong>After QC:</strong> ~99 animals, ~980 SNPs (numbers vary due to random simulation)</li>
</ul>
<p>In real datasets, QC might remove 1-5% of SNPs and &lt;1% of animals.</p>
</section><section id="demo-4-calculate-genomic-relationship-matrix-preview" class="level3" data-number="12.9.4"><h3 data-number="12.9.4" class="anchored" data-anchor-id="demo-4-calculate-genomic-relationship-matrix-preview">
<span class="header-section-number">12.9.4</span> Demo 4: Calculate Genomic Relationship Matrix (Preview)</h3>
<p>The <strong>genomic relationship matrix (G)</strong> quantifies genetic similarity between animals based on SNP genotypes. We’ll calculate a simplified version here; Chapter 13 will explore this in detail.</p>
<p><strong>Formula (VanRaden, 2008):</strong></p>
<p><span class="math display">\[
\mathbf{G} = \frac{(\mathbf{Z} - \mathbf{P})(\mathbf{Z} - \mathbf{P})^\top}{2 \sum p_i (1 - p_i)}
\]</span></p>
<p>Where:</p>
<ul>
<li>
<span class="math inline">\(\mathbf{Z}\)</span> = genotype matrix (animals × SNPs), coded 0, 1, 2</li>
<li>
<span class="math inline">\(\mathbf{P}\)</span> = matrix of expected genotypes (<span class="math inline">\(2p_i\)</span> for SNP <span class="math inline">\(i\)</span>)</li>
<li>
<span class="math inline">\(p_i\)</span> = allele frequency at SNP <span class="math inline">\(i\)</span>
</li>
</ul>
<p>Diagonal elements of <span class="math inline">\(\mathbf{G}\)</span> represent an animal’s relationship to itself (close to 1). Off-diagonal elements represent relationships between pairs (0 = unrelated, 0.5 = parent-offspring or full siblings).</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Use QC-filtered genotypes</span></span>
<span><span class="va">Z</span> <span class="op">&lt;-</span> <span class="va">genotypes_qc</span></span>
<span></span>
<span><span class="co"># Calculate allele frequencies for QC-filtered SNPs</span></span>
<span><span class="va">p_vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">Z</span>, <span class="fl">2</span>, <span class="va">calc_allele_freq</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Center genotypes: Z - P</span></span>
<span><span class="va">P</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">p_vec</span>, each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">Z</span><span class="op">)</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">Z</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Z_centered</span> <span class="op">&lt;-</span> <span class="va">Z</span> <span class="op">-</span> <span class="va">P</span></span>
<span></span>
<span><span class="co"># Handle missing data: set to 0 (mean imputation)</span></span>
<span><span class="va">Z_centered</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">Z_centered</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="co"># Calculate G matrix</span></span>
<span><span class="va">denominator</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">p_vec</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p_vec</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">G</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">Z_centered</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">Z_centered</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="va">denominator</span></span>
<span></span>
<span><span class="co"># Add animal IDs</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">G</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">G</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">animal_ids</span><span class="op">[</span><span class="va">animal_pass</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Display diagonal elements (self-relationships, should be ~1)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Diagonal elements of G (self-relationships):\n"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Diagonal elements of G (self-relationships):</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">G</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.9027  0.9634  0.9891  0.9876  1.0109  1.0714 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Display off-diagonal elements (pairwise relationships)</span></span>
<span><span class="va">G_offdiag</span> <span class="op">&lt;-</span> <span class="va">G</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html">lower.tri</a></span><span class="op">(</span><span class="va">G</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\nOff-diagonal elements of G (pairwise relationships):\n"</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Off-diagonal elements of G (pairwise relationships):</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">G_offdiag</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
-0.130976 -0.030949 -0.009846 -0.009976  0.010977  0.090725 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Visualize distribution of genomic relationships</span></span>
<span><span class="fu">tibble</span><span class="op">(</span>Relationship <span class="op">=</span> <span class="va">G_offdiag</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Relationship</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">40</span>, fill <span class="op">=</span> <span class="st">"coral"</span>, color <span class="op">=</span> <span class="st">"black"</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Distribution of Genomic Relationships (off-diagonal elements)"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Genomic Relationship"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Frequency"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="12-genomics-intro_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p><strong>Interpretation:</strong></p>
<ul>
<li>
<strong>Diagonal elements</strong> (self-relationships) are close to 1.0, as expected</li>
<li>
<strong>Off-diagonal elements</strong> (relationships between animals) average near 0 in this simulated unrelated population</li>
<li>In real populations with pedigree structure, you’d see clusters: unrelated (~0), half-siblings (~0.25), full siblings or parent-offspring (~0.5)</li>
</ul>
<p><strong>Key insight:</strong> The G matrix captures realized genetic similarity. Animals with similar SNP genotypes have high G values, even if pedigree relationships are unknown. This is why genomics works in populations with incomplete or erroneous pedigrees.</p>
</section></section><section id="summary" class="level2" data-number="12.10"><h2 data-number="12.10" class="anchored" data-anchor-id="summary">
<span class="header-section-number">12.10</span> Summary</h2>
<p>This chapter introduced genomics and its transformative role in animal breeding. Let’s recap the key points:</p>
<p><strong>DNA markers (SNPs):</strong></p>
<ul>
<li>Single Nucleotide Polymorphisms (SNPs) are single-base differences in DNA</li>
<li>Genotypes coded as 0 (AA), 1 (AG), or 2 (GG)</li>
<li>Millions of SNPs exist across genomes; we genotype thousands to hundreds of thousands</li>
<li>SNPs are useful because they’re abundant, stable, and in linkage disequilibrium with causal mutations</li>
</ul>
<p><strong>SNP chips:</strong></p>
<ul>
<li>Microarrays that genotype 10,000 to 800,000 SNPs simultaneously</li>
<li>Species-specific chips for cattle, swine, poultry, horses, dogs, cats, sheep, aquaculture species</li>
<li>Costs have dropped dramatically ($15-$150 per animal, depending on density)</li>
<li>High-, medium-, and low-density options enable cost-effective imputation strategies</li>
</ul>
<p><strong>Quality control and imputation:</strong></p>
<ul>
<li>Genotype data must be quality-controlled (call rate, MAF, HWE)</li>
<li>Imputation predicts missing or low-density genotypes using high-density reference panels</li>
<li>Imputation enables cost savings (genotype most animals with cheap chips, impute to high density)</li>
<li>Accuracy of imputation typically &gt;95% for common SNPs</li>
</ul>
<p><strong>Whole genome sequencing:</strong></p>
<ul>
<li>Sequences every base pair (~3 billion in cattle)</li>
<li>More expensive than SNP chips ($500-2000 vs.&nbsp;$30-150)</li>
<li>Enables identification of causal mutations (QTN), structural variants, and rare alleles</li>
<li>Used strategically: sequence elite animals, impute others to sequence</li>
</ul>
<p><strong>Applications:</strong></p>
<ul>
<li>
<strong>Genomic selection</strong> (Chapter 13): Predict breeding values using genome-wide SNPs</li>
<li>
<strong>Parentage verification:</strong> Correct pedigree errors using SNP-based parentage</li>
<li>
<strong>GWAS:</strong> Discover QTL and candidate genes for traits</li>
<li>
<strong>Genomic inbreeding management:</strong> Measure realized inbreeding, optimize matings</li>
<li>
<strong>Genetic defect identification:</strong> Find and manage lethal recessives and disease mutations</li>
<li>
<strong>Crossbred performance:</strong> Estimate breed composition, predict crossbred merit</li>
</ul>
<p><strong>Impact:</strong></p>
<p>Genomics has revolutionized animal breeding. Genetic gain has doubled in dairy cattle, swine, and poultry breeding programs. Generation intervals have shortened. Selection accuracy has increased, especially for young animals and expensive-to-measure traits. Today, genomics is standard practice in commercial breeding worldwide.</p>
<p>In Chapter 13, we’ll dive into <strong>genomic selection</strong> methods—how we use SNP genotypes to predict breeding values and make selection decisions.</p>
</section><section id="practice-problems" class="level2" data-number="12.11"><h2 data-number="12.11" class="anchored" data-anchor-id="practice-problems">
<span class="header-section-number">12.11</span> Practice Problems</h2>
<p>Test your understanding with these problems:</p>
<p><strong>1. SNP Basics</strong></p>
<ol type="a">
<li><p>What does SNP stand for? Describe what a SNP is in one sentence.</p></li>
<li><p>A SNP has two alleles: C and T. An animal has genotype CT. How would this be coded numerically (0, 1, or 2)?</p></li>
<li><p>Why are SNPs useful for predicting breeding values even though most SNPs are not themselves causal mutations?</p></li>
</ol>
<p><strong>2. Allele Frequency Calculation</strong></p>
<p>You genotype 200 beef cattle at a SNP and observe:</p>
<ul>
<li>50 animals with genotype 0 (CC)</li>
<li>100 animals with genotype 1 (CT)</li>
<li>50 animals with genotype 2 (TT)</li>
</ul>
<ol type="a">
<li><p>Calculate the frequency of the C allele.</p></li>
<li><p>Calculate the frequency of the T allele.</p></li>
<li><p>What is the minor allele frequency (MAF)?</p></li>
<li><p>Would this SNP pass a MAF filter of ≥0.05? Why or why not?</p></li>
</ol>
<p><strong>3. Genotyping Strategy Cost-Benefit</strong></p>
<p>A swine breeding company evaluates 10,000 pigs per year. They have two genotyping options:</p>
<ul>
<li>
<strong>Option A:</strong> Genotype all pigs with a 60K SNP chip at $50 per animal</li>
<li>
<strong>Option B:</strong> Genotype all pigs with a 20K SNP chip at $20 per animal and impute to 60K (reference panel maintenance costs $10,000/year)</li>
</ul>
<ol type="a">
<li><p>Calculate the total annual cost for each option.</p></li>
<li><p>Which option is more cost-effective?</p></li>
<li><p>If imputation reduces genomic prediction accuracy by 0.02 correlation units, would you still choose the cheaper option? Explain your reasoning.</p></li>
</ol>
<p><strong>4. Imputation</strong></p>
<p>Explain in 2-3 sentences:</p>
<ol type="a">
<li><p>What is imputation in the context of genomic data?</p></li>
<li><p>Why is imputation economically valuable for breeding programs?</p></li>
<li><p>What factors influence imputation accuracy?</p></li>
</ol>
<p><strong>5. SNP Chips vs.&nbsp;Whole Genome Sequencing</strong></p>
<p>You are designing a genomics strategy for a dairy cattle breeding program.</p>
<ol type="a">
<li><p>Which animals would you choose to sequence (whole genome sequencing), and why?</p></li>
<li><p>Which animals would you genotype on SNP chips?</p></li>
<li><p>Justify your strategy in terms of cost, information, and breeding goals.</p></li>
</ol>
<p><strong>6. Quality Control</strong></p>
<p>You receive genotype data for 500 animals genotyped on a 50K SNP chip. Quality control reveals:</p>
<ul>
<li>5 animals with call rate &lt;85%</li>
<li>200 SNPs with call rate &lt;90%</li>
<li>1,500 SNPs with MAF &lt;0.01</li>
</ul>
<ol type="a">
<li><p>Which animals would you remove from the dataset? Why?</p></li>
<li><p>Which SNPs would you remove (assume call rate threshold = 95%, MAF threshold = 0.05)? Roughly how many SNPs remain?</p></li>
<li><p>Why is it important to perform quality control before genomic evaluation?</p></li>
</ol>
<p><strong>7. Application Scenario</strong></p>
<p>A beef cattle breeder wants to use genomics in their seedstock operation. Describe two applications of genomics (other than genomic selection) that would benefit this breeder. For each application, explain:</p>
<ol type="a">
<li><p>What it does</p></li>
<li><p>How it works (briefly)</p></li>
<li><p>What benefit it provides</p></li>
</ol></section><section id="further-reading" class="level2" data-number="12.12"><h2 data-number="12.12" class="anchored" data-anchor-id="further-reading">
<span class="header-section-number">12.12</span> Further Reading</h2>
<p><strong>Foundational Papers:</strong></p>
<ul>
<li><p><strong>Hayes, B. J., &amp; Goddard, M. E. (2010).</strong> Genome-wide association and genomic selection in animal breeding. <em>Genome</em>, 53(11), 876-883. → Excellent overview of how GWAS and genomic selection revolutionized breeding</p></li>
<li><p><strong>VanRaden, P. M. (2008).</strong> Efficient methods to compute genomic predictions. <em>Journal of Dairy Science</em>, 91(11), 4414-4423. → Describes calculation of the genomic relationship matrix (G)</p></li>
<li><p><strong>Meuwissen, T. H., Hayes, B. J., &amp; Goddard, M. E. (2001).</strong> Prediction of total genetic value using genome-wide dense marker maps. <em>Genetics</em>, 157(4), 1819-1829. → The original paper proposing genomic selection</p></li>
</ul>
<p><strong>Species-Specific Genomics:</strong></p>
<ul>
<li><p><strong>Dairy Cattle:</strong> VanRaden et al.&nbsp;(2009). Invited review: Reliability of genomic predictions for North American Holstein bulls. <em>Journal of Dairy Science</em>, 92(1), 16-24.</p></li>
<li><p><strong>Swine:</strong> Boichard et al.&nbsp;(2016). Genomic selection in domestic animals: Principles, applications and perspectives. <em>Comptes Rendus Biologies</em>, 339(7-8), 274-277.</p></li>
<li><p><strong>Poultry:</strong> Wolc et al.&nbsp;(2016). Response and inbreeding from a genomic selection experiment in layer chickens. <em>Genetics Selection Evolution</em>, 47(1), 59.</p></li>
<li><p><strong>Companion Animals:</strong> Karlsson &amp; Lindblad-Toh (2008). Leader of the pack: gene mapping in dogs and other model organisms. <em>Nature Reviews Genetics</em>, 9(9), 713-725.</p></li>
</ul>
<p><strong>Online Resources:</strong></p>
<ul>
<li>
<strong>Council on Dairy Cattle Breeding (CDCB):</strong> https://www.uscdcb.com/ → Genomic evaluations, reference populations</li>
<li>
<strong>USDA Animal Genomics and Improvement Laboratory:</strong> https://www.ars.usda.gov/animalgenomics/ → Research, tools</li>
<li>
<strong>1000 Bull Genomes Project:</strong> http://www.1000bullgenomes.com/ → Cattle whole genome sequences</li>
<li>
<strong>International Society for Animal Genetics (ISAG):</strong> https://www.isag.us/ → Conferences, working groups on genomics</li>
</ul>
<hr>
<p><strong>Next Chapter Preview:</strong> In Chapter 13, we’ll explore how genotype data is used in <strong>genomic selection</strong>—the methods for predicting breeding values (GEBVs), the accuracy of predictions, and the impact on genetic improvement programs.</p>


<!-- -->

</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
            // default icon
            link.classList.add("external");
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../chapters/11-crossbreeding.html" class="pagination-link" aria-label="Crossbreeding and Hybrid Vigor">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Crossbreeding and Hybrid Vigor</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../chapters/13-genomic-selection.html" class="pagination-link" aria-label="Genomic Selection">
        <span class="nav-page-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Genomic Selection</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb31" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Introduction to Genomics {#sec-genomics-intro}</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">div</span><span class="ot"> class</span><span class="op">=</span><span class="st">"learning-objectives"</span><span class="dt">&gt;</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="fu">### Learning Objectives {.unnumbered}</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>By the end of this chapter, you will be able to:</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Explain what a SNP is and why SNPs are useful genetic markers</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Describe SNP chips (arrays) and their use in livestock breeding</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Understand the basics of genotype quality control</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Distinguish SNP chips from whole genome sequencing</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Identify applications of genomics in animal breeding</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">div</span><span class="dt">&gt;</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Load required packages</span></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Set default theme for plots</span></span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>))</span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Set seed for reproducibility</span></span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a><span class="fu">## Introduction</span></span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a>In 2009, the dairy cattle breeding industry experienced a revolution. For decades, young bulls required expensive progeny testing—waiting 5-6 years to evaluate daughters' milk production before widespread use. This changed dramatically when the USDA and dairy breed associations implemented **genomic selection**. Suddenly, a small tissue sample from a newborn calf could predict its genetic merit with remarkable accuracy, without waiting for daughters or even the bull's own performance records.</span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true" tabindex="-1"></a>This breakthrough stemmed from sequencing animal genomes and developing technologies to measure thousands of DNA variants across the genome simultaneously. The impact was immediate and profound: genetic progress in dairy cattle essentially doubled overnight. Generation intervals dropped from 6-7 years to 2-3 years. Young bulls no longer needed progeny testing. The cost per genetic improvement plummeted.</span>
<span id="cb31-40"><a href="#cb31-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-41"><a href="#cb31-41" aria-hidden="true" tabindex="-1"></a>What happened in dairy cattle has since spread across livestock breeding—swine, poultry, beef cattle, sheep, horses, and even companion animals now routinely use genomic technologies. Commercial breeding companies have restructured their entire operations around genomic selection. The transformation is so complete that today, genomics is simply how modern animal breeding is done.</span>
<span id="cb31-42"><a href="#cb31-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-43"><a href="#cb31-43" aria-hidden="true" tabindex="-1"></a>This chapter introduces the genomic technologies that made this revolution possible. We'll explore what DNA markers (SNPs) are, how we measure them, how we ensure data quality, and what applications they enable beyond genomic selection. By the end, you'll understand the foundation on which modern breeding programs are built—and be prepared for Chapter 13, where we'll dive into genomic selection methods themselves.</span>
<span id="cb31-44"><a href="#cb31-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-45"><a href="#cb31-45" aria-hidden="true" tabindex="-1"></a><span class="fu">## What is Genomics in Breeding?</span></span>
<span id="cb31-46"><a href="#cb31-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-47"><a href="#cb31-47" aria-hidden="true" tabindex="-1"></a>**Genomics in animal breeding** refers to using genome-wide DNA information to improve genetic predictions and make better selection decisions. Instead of relying solely on pedigrees (who the parents are) and phenotypes (what the animal looks like or produces), we can now look directly at an animal's DNA to predict its genetic merit.</span>
<span id="cb31-48"><a href="#cb31-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-49"><a href="#cb31-49" aria-hidden="true" tabindex="-1"></a><span class="fu">### Three Key Advantages of Genomics</span></span>
<span id="cb31-50"><a href="#cb31-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-51"><a href="#cb31-51" aria-hidden="true" tabindex="-1"></a>Genomics provides three major improvements over traditional breeding methods:</span>
<span id="cb31-52"><a href="#cb31-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-53"><a href="#cb31-53" aria-hidden="true" tabindex="-1"></a>**1. Direct measurement of genotype**</span>
<span id="cb31-54"><a href="#cb31-54" aria-hidden="true" tabindex="-1"></a>With traditional methods, we infer an animal's genotype from its relatives' and own performance. Genomics lets us measure the genotype directly by sequencing DNA. This captures **Mendelian sampling**—the random shuffling of chromosomes during gamete formation that makes full siblings genetically different.</span>
<span id="cb31-55"><a href="#cb31-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-56"><a href="#cb31-56" aria-hidden="true" tabindex="-1"></a>**2. Early selection**</span>
<span id="cb31-57"><a href="#cb31-57" aria-hidden="true" tabindex="-1"></a>We can genotype animals at birth (or even as embryos), predict their breeding values immediately, and make selection decisions years before they would express the trait or produce offspring. This dramatically reduces generation intervals.</span>
<span id="cb31-58"><a href="#cb31-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-59"><a href="#cb31-59" aria-hidden="true" tabindex="-1"></a>**3. Selection on expensive or sex-limited traits**</span>
<span id="cb31-60"><a href="#cb31-60" aria-hidden="true" tabindex="-1"></a>Some traits are difficult or expensive to measure (e.g., feed efficiency requiring individual intake measurement, or carcass quality requiring slaughter). Others can only be measured in one sex (e.g., milk production in females). Genomics enables accurate selection on these traits using DNA samples and data from relatives.</span>
<span id="cb31-61"><a href="#cb31-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-62"><a href="#cb31-62" aria-hidden="true" tabindex="-1"></a><span class="fu">### Before and After Genomics</span></span>
<span id="cb31-63"><a href="#cb31-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-64"><a href="#cb31-64" aria-hidden="true" tabindex="-1"></a>Let's contrast traditional breeding with genomic breeding using dairy cattle as an example:</span>
<span id="cb31-65"><a href="#cb31-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-66"><a href="#cb31-66" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Aspect <span class="pp">|</span> Traditional Breeding (Pre-2009) <span class="pp">|</span> Genomic Breeding (Post-2009) <span class="pp">|</span></span>
<span id="cb31-67"><a href="#cb31-67" aria-hidden="true" tabindex="-1"></a><span class="pp">|--------|--------------------------------|------------------------------|</span></span>
<span id="cb31-68"><a href="#cb31-68" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Information source** <span class="pp">|</span> Pedigree + phenotypes from progeny <span class="pp">|</span> Pedigree + phenotypes + DNA markers <span class="pp">|</span></span>
<span id="cb31-69"><a href="#cb31-69" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Young bull evaluation** <span class="pp">|</span> Progeny test: 5-6 years, 100+ daughters <span class="pp">|</span> Genomic test: birth, no daughters needed <span class="pp">|</span></span>
<span id="cb31-70"><a href="#cb31-70" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Generation interval** <span class="pp">|</span> 6-7 years (waiting for progeny) <span class="pp">|</span> 2-3 years (select at birth) <span class="pp">|</span></span>
<span id="cb31-71"><a href="#cb31-71" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Accuracy for young bull** <span class="pp">|</span> ~0.30 (parent average) <span class="pp">|</span> ~0.65 (genomic prediction) <span class="pp">|</span></span>
<span id="cb31-72"><a href="#cb31-72" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Cost per evaluation** <span class="pp">|</span> $25,000-$50,000 (progeny testing) <span class="pp">|</span> $50-150 (genomic testing) <span class="pp">|</span></span>
<span id="cb31-73"><a href="#cb31-73" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Annual genetic gain** <span class="pp">|</span> ~1% per year <span class="pp">|</span> ~2% per year (doubled) <span class="pp">|</span></span>
<span id="cb31-74"><a href="#cb31-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-75"><a href="#cb31-75" aria-hidden="true" tabindex="-1"></a>The transformation has been similarly dramatic in other species, though the specifics vary. Swine breeding companies now genotype thousands of selection candidates annually. Broiler breeding programs use genomics to improve disease resistance and leg health. Even dog and cat breeders use genomic tools to screen for genetic diseases and verify parentage.</span>
<span id="cb31-76"><a href="#cb31-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-77"><a href="#cb31-77" aria-hidden="true" tabindex="-1"></a><span class="fu">### Timeline of Genomics in Livestock</span></span>
<span id="cb31-78"><a href="#cb31-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-79"><a href="#cb31-79" aria-hidden="true" tabindex="-1"></a>The genomic revolution in animal breeding unfolded rapidly:</span>
<span id="cb31-80"><a href="#cb31-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-81"><a href="#cb31-81" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**2001**: Human genome sequenced (reference for all mammalian genomics)</span>
<span id="cb31-82"><a href="#cb31-82" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**2004-2009**: Livestock genome assemblies completed:</span>
<span id="cb31-83"><a href="#cb31-83" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Chicken (2004)</span>
<span id="cb31-84"><a href="#cb31-84" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Cattle (2009)</span>
<span id="cb31-85"><a href="#cb31-85" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Pig (2009)</span>
<span id="cb31-86"><a href="#cb31-86" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Sheep (2010)</span>
<span id="cb31-87"><a href="#cb31-87" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Horse (2009)</span>
<span id="cb31-88"><a href="#cb31-88" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**2008-2010**: First genomic selection implementations</span>
<span id="cb31-89"><a href="#cb31-89" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Dairy cattle (2009, USA and Netherlands)</span>
<span id="cb31-90"><a href="#cb31-90" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Broiler chickens (~2010)</span>
<span id="cb31-91"><a href="#cb31-91" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**2010s**: Widespread adoption across species</span>
<span id="cb31-92"><a href="#cb31-92" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Swine breeding companies (2011-2014)</span>
<span id="cb31-93"><a href="#cb31-93" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Beef cattle breed associations (2012+)</span>
<span id="cb31-94"><a href="#cb31-94" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Salmon breeding (2012+)</span>
<span id="cb31-95"><a href="#cb31-95" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**2015-2020**: Single-step genomic BLUP becomes industry standard</span>
<span id="cb31-96"><a href="#cb31-96" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**2020+**: Whole genome sequencing reference panels, advanced methods</span>
<span id="cb31-97"><a href="#cb31-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-98"><a href="#cb31-98" aria-hidden="true" tabindex="-1"></a>Each species' adoption timeline depended on industry structure, generation interval, and economic incentives. Dairy cattle adopted quickly due to long generation intervals and expensive progeny testing. Poultry breeding companies integrated genomics into existing family-based selection schemes. The common thread: once adopted, genomics transformed every breeding program.</span>
<span id="cb31-99"><a href="#cb31-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-100"><a href="#cb31-100" aria-hidden="true" tabindex="-1"></a><span class="fu">## DNA Markers: Single Nucleotide Polymorphisms (SNPs)</span></span>
<span id="cb31-101"><a href="#cb31-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-102"><a href="#cb31-102" aria-hidden="true" tabindex="-1"></a>To use genomics, we need **genetic markers**—specific locations in the genome where individuals differ. The most common and useful type of marker is the SNP (pronounced "snip").</span>
<span id="cb31-103"><a href="#cb31-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-104"><a href="#cb31-104" aria-hidden="true" tabindex="-1"></a><span class="fu">### What is a SNP?</span></span>
<span id="cb31-105"><a href="#cb31-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-106"><a href="#cb31-106" aria-hidden="true" tabindex="-1"></a>A **Single Nucleotide Polymorphism (SNP)** is a location in the DNA sequence where a single nucleotide (base pair) differs between individuals in a population.</span>
<span id="cb31-107"><a href="#cb31-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-108"><a href="#cb31-108" aria-hidden="true" tabindex="-1"></a>DNA consists of four nucleotide bases: **A** (adenine), **T** (thymine), **G** (guanine), and **C** (cytosine). At most locations in the genome, all individuals have the same base. But at some locations—roughly 1 in every 1,000 bases—variation exists.</span>
<span id="cb31-109"><a href="#cb31-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-110"><a href="#cb31-110" aria-hidden="true" tabindex="-1"></a>**Example SNP:**</span>
<span id="cb31-111"><a href="#cb31-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-112"><a href="#cb31-112" aria-hidden="true" tabindex="-1"></a>Animal 1: ...ATCG**A**TTGCA...</span>
<span id="cb31-113"><a href="#cb31-113" aria-hidden="true" tabindex="-1"></a>Animal 2: ...ATCG**G**TTGCA...</span>
<span id="cb31-114"><a href="#cb31-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-115"><a href="#cb31-115" aria-hidden="true" tabindex="-1"></a>At this SNP position, Animal 1 has an **A** allele and Animal 2 has a **G** allele. This single base difference is a SNP. Mammals have billions of base pairs, so millions of SNPs exist across the genome—far more than we need for breeding applications.</span>
<span id="cb31-116"><a href="#cb31-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-117"><a href="#cb31-117" aria-hidden="true" tabindex="-1"></a>**Where do SNPs come from?**</span>
<span id="cb31-118"><a href="#cb31-118" aria-hidden="true" tabindex="-1"></a>SNPs arise from random mutations that occurred in ancestral populations and were passed down through generations. Most SNPs are selectively neutral (don't affect fitness), but some are located in or near genes and influence traits of interest. Even neutral SNPs are useful because they're **linked** to causal mutations through linkage disequilibrium (more on this shortly).</span>
<span id="cb31-119"><a href="#cb31-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-120"><a href="#cb31-120" aria-hidden="true" tabindex="-1"></a><span class="fu">### SNP Genotypes</span></span>
<span id="cb31-121"><a href="#cb31-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-122"><a href="#cb31-122" aria-hidden="true" tabindex="-1"></a>Each animal inherits one copy of each chromosome from its sire and one from its dam. Therefore, at each SNP location, an animal has **two alleles**—one from each parent.</span>
<span id="cb31-123"><a href="#cb31-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-124"><a href="#cb31-124" aria-hidden="true" tabindex="-1"></a>Let's say a SNP has two possible alleles: **A** and **G**. An individual can have one of three genotypes:</span>
<span id="cb31-125"><a href="#cb31-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-126"><a href="#cb31-126" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**AA** (homozygous for A)</span>
<span id="cb31-127"><a href="#cb31-127" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**AG** (heterozygous)</span>
<span id="cb31-128"><a href="#cb31-128" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**GG** (homozygous for G)</span>
<span id="cb31-129"><a href="#cb31-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-130"><a href="#cb31-130" aria-hidden="true" tabindex="-1"></a>In genomic datasets, we typically code SNP genotypes numerically:</span>
<span id="cb31-131"><a href="#cb31-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-132"><a href="#cb31-132" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**0** = homozygous for the first allele (AA)</span>
<span id="cb31-133"><a href="#cb31-133" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**1** = heterozygous (AG)</span>
<span id="cb31-134"><a href="#cb31-134" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**2** = homozygous for the second allele (GG)</span>
<span id="cb31-135"><a href="#cb31-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-136"><a href="#cb31-136" aria-hidden="true" tabindex="-1"></a>**Important:** The choice of which allele is "0" vs. "2" is arbitrary. We usually designate the allele that was more common when the SNP panel was designed as "0" (the reference allele) and the alternative allele as "2."</span>
<span id="cb31-137"><a href="#cb31-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-138"><a href="#cb31-138" aria-hidden="true" tabindex="-1"></a>**Example genotypes for 5 animals at 3 SNPs:**</span>
<span id="cb31-139"><a href="#cb31-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-140"><a href="#cb31-140" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Animal <span class="pp">|</span> SNP1 <span class="pp">|</span> SNP2 <span class="pp">|</span> SNP3 <span class="pp">|</span></span>
<span id="cb31-141"><a href="#cb31-141" aria-hidden="true" tabindex="-1"></a><span class="pp">|--------|------|------|------|</span></span>
<span id="cb31-142"><a href="#cb31-142" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 1      <span class="pp">|</span> 0    <span class="pp">|</span> 1    <span class="pp">|</span> 2    <span class="pp">|</span></span>
<span id="cb31-143"><a href="#cb31-143" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 2      <span class="pp">|</span> 1    <span class="pp">|</span> 0    <span class="pp">|</span> 1    <span class="pp">|</span></span>
<span id="cb31-144"><a href="#cb31-144" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 3      <span class="pp">|</span> 2    <span class="pp">|</span> 2    <span class="pp">|</span> 0    <span class="pp">|</span></span>
<span id="cb31-145"><a href="#cb31-145" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 4      <span class="pp">|</span> 0    <span class="pp">|</span> 1    <span class="pp">|</span> 1    <span class="pp">|</span></span>
<span id="cb31-146"><a href="#cb31-146" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> 5      <span class="pp">|</span> 1    <span class="pp">|</span> 2    <span class="pp">|</span> 0    <span class="pp">|</span></span>
<span id="cb31-147"><a href="#cb31-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-148"><a href="#cb31-148" aria-hidden="true" tabindex="-1"></a>Animal 1 is homozygous AA at SNP1 (genotype = 0), heterozygous at SNP2 (genotype = 1), and homozygous GG at SNP3 (genotype = 2).</span>
<span id="cb31-149"><a href="#cb31-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-150"><a href="#cb31-150" aria-hidden="true" tabindex="-1"></a><span class="fu">### Allele Frequency</span></span>
<span id="cb31-151"><a href="#cb31-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-152"><a href="#cb31-152" aria-hidden="true" tabindex="-1"></a>An important property of each SNP is its **allele frequency**—the proportion of chromosomes in the population carrying each allele.</span>
<span id="cb31-153"><a href="#cb31-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-154"><a href="#cb31-154" aria-hidden="true" tabindex="-1"></a>If we have genotype data for many animals, we can calculate the frequency of allele A as:</span>
<span id="cb31-155"><a href="#cb31-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-156"><a href="#cb31-156" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb31-157"><a href="#cb31-157" aria-hidden="true" tabindex="-1"></a>p = \frac{2 \times n_{AA} + n_{AG}}{2 \times n_{\text{total}}}</span>
<span id="cb31-158"><a href="#cb31-158" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb31-159"><a href="#cb31-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-160"><a href="#cb31-160" aria-hidden="true" tabindex="-1"></a>Where:</span>
<span id="cb31-161"><a href="#cb31-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-162"><a href="#cb31-162" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$n_{AA}$ = number of animals with genotype AA (coded as 0)</span>
<span id="cb31-163"><a href="#cb31-163" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$n_{AG}$ = number of animals with genotype AG (coded as 1)</span>
<span id="cb31-164"><a href="#cb31-164" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$n_{\text{total}}$ = total number of animals</span>
<span id="cb31-165"><a href="#cb31-165" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>We multiply by 2 because each animal has 2 alleles</span>
<span id="cb31-166"><a href="#cb31-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-167"><a href="#cb31-167" aria-hidden="true" tabindex="-1"></a>The frequency of allele G is simply $q = 1 - p$.</span>
<span id="cb31-168"><a href="#cb31-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-169"><a href="#cb31-169" aria-hidden="true" tabindex="-1"></a>**Example:**</span>
<span id="cb31-170"><a href="#cb31-170" aria-hidden="true" tabindex="-1"></a>Suppose we genotyped 100 cattle at a SNP and observed:</span>
<span id="cb31-171"><a href="#cb31-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-172"><a href="#cb31-172" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>25 animals with genotype 0 (AA)</span>
<span id="cb31-173"><a href="#cb31-173" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>50 animals with genotype 1 (AG)</span>
<span id="cb31-174"><a href="#cb31-174" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>25 animals with genotype 2 (GG)</span>
<span id="cb31-175"><a href="#cb31-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-176"><a href="#cb31-176" aria-hidden="true" tabindex="-1"></a>The frequency of allele A is:</span>
<span id="cb31-177"><a href="#cb31-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-178"><a href="#cb31-178" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb31-179"><a href="#cb31-179" aria-hidden="true" tabindex="-1"></a>p = \frac{2(25) + 50}{2(100)} = \frac{100}{200} = 0.50</span>
<span id="cb31-180"><a href="#cb31-180" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb31-181"><a href="#cb31-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-182"><a href="#cb31-182" aria-hidden="true" tabindex="-1"></a>So allele A has frequency 50% in this population, and allele G also has frequency 50%.</span>
<span id="cb31-183"><a href="#cb31-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-184"><a href="#cb31-184" aria-hidden="true" tabindex="-1"></a>**Minor Allele Frequency (MAF):**</span>
<span id="cb31-185"><a href="#cb31-185" aria-hidden="true" tabindex="-1"></a>The **minor allele frequency** is the frequency of the less common allele. If $p = 0.50$, MAF = 0.50. If $p = 0.90$, MAF = 0.10 (the G allele is minor). MAF is important for quality control (low-MAF SNPs provide less information and may be genotyping errors).</span>
<span id="cb31-186"><a href="#cb31-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-187"><a href="#cb31-187" aria-hidden="true" tabindex="-1"></a><span class="fu">### Why SNPs are Useful for Breeding</span></span>
<span id="cb31-188"><a href="#cb31-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-189"><a href="#cb31-189" aria-hidden="true" tabindex="-1"></a>SNPs are the workhorses of genomic selection for several reasons:</span>
<span id="cb31-190"><a href="#cb31-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-191"><a href="#cb31-191" aria-hidden="true" tabindex="-1"></a>**1. Abundant across the genome**</span>
<span id="cb31-192"><a href="#cb31-192" aria-hidden="true" tabindex="-1"></a>Millions of SNPs exist in livestock species. We can select thousands to hundreds of thousands that are evenly spaced across chromosomes, ensuring genome-wide coverage.</span>
<span id="cb31-193"><a href="#cb31-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-194"><a href="#cb31-194" aria-hidden="true" tabindex="-1"></a>**2. Biallelic (simple)**</span>
<span id="cb31-195"><a href="#cb31-195" aria-hidden="true" tabindex="-1"></a>Most SNPs have only two alleles (A/G, C/T, etc.), making them easy to genotype and analyze. Contrast with older markers like microsatellites, which often had many alleles and were more complex.</span>
<span id="cb31-196"><a href="#cb31-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-197"><a href="#cb31-197" aria-hidden="true" tabindex="-1"></a>**3. Stable within an individual**</span>
<span id="cb31-198"><a href="#cb31-198" aria-hidden="true" tabindex="-1"></a>Your genotype at a SNP doesn't change throughout your life. We can genotype an animal once (at birth) and use that information forever.</span>
<span id="cb31-199"><a href="#cb31-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-200"><a href="#cb31-200" aria-hidden="true" tabindex="-1"></a>**4. High-throughput genotyping**</span>
<span id="cb31-201"><a href="#cb31-201" aria-hidden="true" tabindex="-1"></a>Modern SNP chips can genotype 50,000 to 800,000 SNPs simultaneously from a single DNA sample, at low cost. This was impossible with older marker technologies.</span>
<span id="cb31-202"><a href="#cb31-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-203"><a href="#cb31-203" aria-hidden="true" tabindex="-1"></a>**5. Linkage disequilibrium (LD) with causal mutations**</span>
<span id="cb31-204"><a href="#cb31-204" aria-hidden="true" tabindex="-1"></a>Most SNPs we genotype are not themselves causing variation in traits. Instead, they are **linked** (physically close on the chromosome) to causal mutations. When SNPs and causal mutations are inherited together (in LD), we can use SNP genotypes to predict breeding values even if we never identify the causal mutations themselves.</span>
<span id="cb31-205"><a href="#cb31-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-206"><a href="#cb31-206" aria-hidden="true" tabindex="-1"></a>**Linkage disequilibrium** is the key concept making genomic selection work. LD means certain alleles at different loci are inherited together more often than expected by chance (because they're close together and recombination is rare between them). By genotyping SNPs across the genome, we effectively "tag" chromosomal segments and their associated genetic effects on traits.</span>
<span id="cb31-207"><a href="#cb31-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-208"><a href="#cb31-208" aria-hidden="true" tabindex="-1"></a>**Example: Coat color in horses**</span>
<span id="cb31-209"><a href="#cb31-209" aria-hidden="true" tabindex="-1"></a>The "agouti" gene determines whether a horse is bay (black body with brown points) or black (entirely black). A SNP in the agouti gene is in perfect LD with the causal mutation. By genotyping this SNP, we can predict coat color without sequencing the entire gene. Similarly, thousands of SNPs across the genome tag segments affecting milk production, growth rate, disease resistance, etc.</span>
<span id="cb31-210"><a href="#cb31-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-211"><a href="#cb31-211" aria-hidden="true" tabindex="-1"></a><span class="fu">## SNP Chips (Arrays)</span></span>
<span id="cb31-212"><a href="#cb31-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-213"><a href="#cb31-213" aria-hidden="true" tabindex="-1"></a>Now that we understand what SNPs are, how do we genotype thousands of them efficiently? The answer is **SNP chips** (also called SNP arrays or bead chips).</span>
<span id="cb31-214"><a href="#cb31-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-215"><a href="#cb31-215" aria-hidden="true" tabindex="-1"></a><span class="fu">### What is a SNP Chip?</span></span>
<span id="cb31-216"><a href="#cb31-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-217"><a href="#cb31-217" aria-hidden="true" tabindex="-1"></a>A **SNP chip** is a piece of glass or silicon (about the size of a thumbnail) onto which hundreds of thousands of DNA probes have been attached. Each probe corresponds to a specific SNP location in the genome. When DNA from an animal is applied to the chip, it binds to the probes, and a scanner detects which alleles are present at each SNP.</span>
<span id="cb31-218"><a href="#cb31-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-219"><a href="#cb31-219" aria-hidden="true" tabindex="-1"></a>**Key features:**</span>
<span id="cb31-220"><a href="#cb31-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-221"><a href="#cb31-221" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Pre-designed panel:** Each chip genotypes a fixed set of SNPs chosen during chip design</span>
<span id="cb31-222"><a href="#cb31-222" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**High-throughput:** One chip genotypes 50,000 to 800,000 SNPs from one DNA sample</span>
<span id="cb31-223"><a href="#cb31-223" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Low cost per SNP:** Though the chip itself costs $30-$150, the cost per SNP is often &lt; $0.001</span>
<span id="cb31-224"><a href="#cb31-224" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Species-specific:** Different chips exist for cattle, swine, poultry, horses, dogs, etc.</span>
<span id="cb31-225"><a href="#cb31-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-226"><a href="#cb31-226" aria-hidden="true" tabindex="-1"></a><span class="fu">### How SNP Chips Work (Simplified)</span></span>
<span id="cb31-227"><a href="#cb31-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-228"><a href="#cb31-228" aria-hidden="true" tabindex="-1"></a>The genotyping process involves several steps:</span>
<span id="cb31-229"><a href="#cb31-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-230"><a href="#cb31-230" aria-hidden="true" tabindex="-1"></a>**1. DNA Extraction**</span>
<span id="cb31-231"><a href="#cb31-231" aria-hidden="true" tabindex="-1"></a>DNA is extracted from a tissue sample—typically blood, hair follicles, ear tissue, or nasal swabs. The sample is processed in a lab to isolate high-quality DNA.</span>
<span id="cb31-232"><a href="#cb31-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-233"><a href="#cb31-233" aria-hidden="true" tabindex="-1"></a>**2. DNA Processing and Chip Hybridization**</span>
<span id="cb31-234"><a href="#cb31-234" aria-hidden="true" tabindex="-1"></a>The DNA is fragmented, amplified, and labeled with fluorescent markers. It's then applied to the chip, where it binds (hybridizes) to probes corresponding to each SNP location.</span>
<span id="cb31-235"><a href="#cb31-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-236"><a href="#cb31-236" aria-hidden="true" tabindex="-1"></a>**3. Scanning**</span>
<span id="cb31-237"><a href="#cb31-237" aria-hidden="true" tabindex="-1"></a>A laser scanner excites the fluorescent labels, and the emitted light indicates which alleles are present. Different alleles emit different fluorescence patterns (e.g., red for AA, yellow for AG, green for GG).</span>
<span id="cb31-238"><a href="#cb31-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-239"><a href="#cb31-239" aria-hidden="true" tabindex="-1"></a>**4. Genotype Calling**</span>
<span id="cb31-240"><a href="#cb31-240" aria-hidden="true" tabindex="-1"></a>Software analyzes the fluorescence intensities and "calls" genotypes (0, 1, or 2) for each SNP in each animal. Quality scores indicate confidence in each call.</span>
<span id="cb31-241"><a href="#cb31-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-242"><a href="#cb31-242" aria-hidden="true" tabindex="-1"></a>You don't need to understand the detailed chemistry—the important point is that SNP chips enable cost-effective, accurate, high-throughput genotyping.</span>
<span id="cb31-243"><a href="#cb31-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-244"><a href="#cb31-244" aria-hidden="true" tabindex="-1"></a><span class="fu">### Common SNP Chips by Species</span></span>
<span id="cb31-245"><a href="#cb31-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-246"><a href="#cb31-246" aria-hidden="true" tabindex="-1"></a>Different livestock and companion animal species have breed- and purpose-specific SNP chips. Here's a comprehensive table of widely used panels:</span>
<span id="cb31-247"><a href="#cb31-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-248"><a href="#cb31-248" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Species <span class="pp">|</span> SNP Chip Name <span class="pp">|</span> Number of SNPs <span class="pp">|</span> Typical Cost (USD) <span class="pp">|</span> Primary Uses <span class="pp">|</span></span>
<span id="cb31-249"><a href="#cb31-249" aria-hidden="true" tabindex="-1"></a><span class="pp">|---------|---------------|----------------|--------------------|--------------|</span></span>
<span id="cb31-250"><a href="#cb31-250" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Cattle (Dairy/Beef)** <span class="pp">|</span> BovineHD <span class="pp">|</span> 777,962 <span class="pp">|</span> $100-150 <span class="pp">|</span> Research, reference panels, high-density <span class="pp">|</span></span>
<span id="cb31-251"><a href="#cb31-251" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="pp">|</span> GGP Bovine 100K <span class="pp">|</span> 100,000 <span class="pp">|</span> $35-50 <span class="pp">|</span> Genomic selection, routine evaluation <span class="pp">|</span></span>
<span id="cb31-252"><a href="#cb31-252" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="pp">|</span> GGP Bovine 50K <span class="pp">|</span> 50,000 <span class="pp">|</span> $30-40 <span class="pp">|</span> Genomic selection, crossbred animals <span class="pp">|</span></span>
<span id="cb31-253"><a href="#cb31-253" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="pp">|</span> GGP Bovine LD (Low Density) <span class="pp">|</span> 30,000 <span class="pp">|</span> $15-25 <span class="pp">|</span> Females, terminal animals (imputed to HD) <span class="pp">|</span></span>
<span id="cb31-254"><a href="#cb31-254" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Swine** <span class="pp">|</span> PorcineSNP60 (Illumina) <span class="pp">|</span> 60,000 <span class="pp">|</span> $50-80 <span class="pp">|</span> Genomic selection, parentage <span class="pp">|</span></span>
<span id="cb31-255"><a href="#cb31-255" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="pp">|</span> GGP Porcine 50K <span class="pp">|</span> 50,000 <span class="pp">|</span> $40-60 <span class="pp">|</span> Commercial breeding programs <span class="pp">|</span></span>
<span id="cb31-256"><a href="#cb31-256" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="pp">|</span> GGP Porcine LD <span class="pp">|</span> 20,000 <span class="pp">|</span> $20-30 <span class="pp">|</span> Crossbred commercial pigs (imputed) <span class="pp">|</span></span>
<span id="cb31-257"><a href="#cb31-257" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Poultry** <span class="pp">|</span> Axiom Chicken HD (custom) <span class="pp">|</span> 600,000 <span class="pp">|</span> Proprietary <span class="pp">|</span> Broiler and layer breeding (company-specific) <span class="pp">|</span></span>
<span id="cb31-258"><a href="#cb31-258" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="pp">|</span> Affymetrix 600K <span class="pp">|</span> 600,000 <span class="pp">|</span> Proprietary <span class="pp">|</span> Research and breeding (custom content) <span class="pp">|</span></span>
<span id="cb31-259"><a href="#cb31-259" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Sheep** <span class="pp">|</span> OvineSNP50 <span class="pp">|</span> 50,000 <span class="pp">|</span> $50-80 <span class="pp">|</span> LAMBPLAN, genomic selection <span class="pp">|</span></span>
<span id="cb31-260"><a href="#cb31-260" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="pp">|</span> Ovine Infinium HD <span class="pp">|</span> 600,000 <span class="pp">|</span> $100-150 <span class="pp">|</span> Research, reference panels <span class="pp">|</span></span>
<span id="cb31-261"><a href="#cb31-261" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Goat** <span class="pp">|</span> GoatSNP50 <span class="pp">|</span> 50,000 <span class="pp">|</span> $60-90 <span class="pp">|</span> Genomic selection, research <span class="pp">|</span></span>
<span id="cb31-262"><a href="#cb31-262" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Horse** <span class="pp">|</span> EquineSNP70 <span class="pp">|</span> 70,000 <span class="pp">|</span> $70-100 <span class="pp">|</span> Racing, breeding, parentage, coat color <span class="pp">|</span></span>
<span id="cb31-263"><a href="#cb31-263" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="pp">|</span> Equine Axiom <span class="pp">|</span> 670,000 <span class="pp">|</span> $120-180 <span class="pp">|</span> Research, high-density applications <span class="pp">|</span></span>
<span id="cb31-264"><a href="#cb31-264" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Dog** <span class="pp">|</span> CanineHD (Illumina) <span class="pp">|</span> 173,662 <span class="pp">|</span> $100-200 <span class="pp">|</span> Breed identification, health screening, research <span class="pp">|</span></span>
<span id="cb31-265"><a href="#cb31-265" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="pp">|</span> Canine LD <span class="pp">|</span> 20,000 <span class="pp">|</span> $60-100 <span class="pp">|</span> Breed-specific health panels, parentage <span class="pp">|</span></span>
<span id="cb31-266"><a href="#cb31-266" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Cat** <span class="pp">|</span> Feline Infinium iSelect <span class="pp">|</span> 63,000 <span class="pp">|</span> $80-150 <span class="pp">|</span> Breed identification, health testing (PKD, HCM) <span class="pp">|</span></span>
<span id="cb31-267"><a href="#cb31-267" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Salmon** <span class="pp">|</span> Affymetrix Axiom (custom) <span class="pp">|</span> 200,000-500,000 <span class="pp">|</span> Proprietary <span class="pp">|</span> Disease resistance, growth, commercial breeding <span class="pp">|</span></span>
<span id="cb31-268"><a href="#cb31-268" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Trout** <span class="pp">|</span> Rainbow Trout Axiom <span class="pp">|</span> 57,000 <span class="pp">|</span> Proprietary <span class="pp">|</span> Aquaculture breeding programs <span class="pp">|</span></span>
<span id="cb31-269"><a href="#cb31-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-270"><a href="#cb31-270" aria-hidden="true" tabindex="-1"></a>**Notes:**</span>
<span id="cb31-271"><a href="#cb31-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-272"><a href="#cb31-272" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**GGP** = GeneSeek Genomic Profiler (Neogen), widely used in cattle and swine</span>
<span id="cb31-273"><a href="#cb31-273" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**LD, MD, HD** = Low Density, Medium Density, High Density</span>
<span id="cb31-274"><a href="#cb31-274" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Costs are approximate (2024-2025) and vary by volume, region, and service provider</span>
<span id="cb31-275"><a href="#cb31-275" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Poultry and some aquaculture arrays are proprietary to breeding companies</span>
<span id="cb31-276"><a href="#cb31-276" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Many species have multiple chip options (low vs. high density) for cost-effective imputation strategies</span>
<span id="cb31-277"><a href="#cb31-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-278"><a href="#cb31-278" aria-hidden="true" tabindex="-1"></a><span class="fu">### Density Trade-offs: When to Use Which Chip?</span></span>
<span id="cb31-279"><a href="#cb31-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-280"><a href="#cb31-280" aria-hidden="true" tabindex="-1"></a>Breeding programs often genotype animals with different density chips depending on their role:</span>
<span id="cb31-281"><a href="#cb31-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-282"><a href="#cb31-282" aria-hidden="true" tabindex="-1"></a>**High-density chips (500K-800K SNPs):**</span>
<span id="cb31-283"><a href="#cb31-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-284"><a href="#cb31-284" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Reference animals:** Influential sires, elite dams, animals in training populations</span>
<span id="cb31-285"><a href="#cb31-285" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Research:** Fine-mapping QTL, whole-genome sequencing imputation reference</span>
<span id="cb31-286"><a href="#cb31-286" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Long-term value:** Animals whose genotypes will be used repeatedly for relationship estimation</span>
<span id="cb31-287"><a href="#cb31-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-288"><a href="#cb31-288" aria-hidden="true" tabindex="-1"></a>**Medium-density chips (50K-100K SNPs):**</span>
<span id="cb31-289"><a href="#cb31-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-290"><a href="#cb31-290" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Selection candidates:** Animals being evaluated for breeding decisions</span>
<span id="cb31-291"><a href="#cb31-291" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Routine genomic evaluations:** Cost-effective, sufficient accuracy when imputed</span>
<span id="cb31-292"><a href="#cb31-292" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Good balance:** Adequate LD coverage for most populations</span>
<span id="cb31-293"><a href="#cb31-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-294"><a href="#cb31-294" aria-hidden="true" tabindex="-1"></a>**Low-density chips (10K-30K SNPs):**</span>
<span id="cb31-295"><a href="#cb31-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-296"><a href="#cb31-296" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Commercial females:** Replacement females not expected to be top-tier breeders</span>
<span id="cb31-297"><a href="#cb31-297" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Crossbred animals:** Terminal market animals if breed composition is of interest</span>
<span id="cb31-298"><a href="#cb31-298" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Cost savings:** Can be imputed to higher density with modest accuracy loss</span>
<span id="cb31-299"><a href="#cb31-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-300"><a href="#cb31-300" aria-hidden="true" tabindex="-1"></a>**Imputation strategy:**</span>
<span id="cb31-301"><a href="#cb31-301" aria-hidden="true" tabindex="-1"></a>Most programs genotype key animals (e.g., top 10%) with high-density chips, most selection candidates with medium-density, and commercial animals (if genotyped at all) with low-density. Missing genotypes are imputed using the high-density reference panel. This maximizes information while minimizing cost.</span>
<span id="cb31-302"><a href="#cb31-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-303"><a href="#cb31-303" aria-hidden="true" tabindex="-1"></a>**Example: Dairy cattle genomic strategy**</span>
<span id="cb31-304"><a href="#cb31-304" aria-hidden="true" tabindex="-1"></a>A typical dairy breeding program might:</span>
<span id="cb31-305"><a href="#cb31-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-306"><a href="#cb31-306" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Genotype elite bulls with BovineHD (777K) or sequence them → reference panel</span>
<span id="cb31-307"><a href="#cb31-307" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Genotype bull calves (selection candidates) with GGP 50K → impute to HD</span>
<span id="cb31-308"><a href="#cb31-308" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Genotype females with GGP-LD (30K) → impute to 50K or HD</span>
<span id="cb31-309"><a href="#cb31-309" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Total cost per bull calf: ~$35, vs. $25,000+ for progeny testing</span>
<span id="cb31-310"><a href="#cb31-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-311"><a href="#cb31-311" aria-hidden="true" tabindex="-1"></a><span class="fu">### Cost Trends: The Genomic Revolution Became Affordable</span></span>
<span id="cb31-312"><a href="#cb31-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-313"><a href="#cb31-313" aria-hidden="true" tabindex="-1"></a>One reason genomics spread so rapidly is that genotyping costs plummeted.</span>
<span id="cb31-314"><a href="#cb31-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-315"><a href="#cb31-315" aria-hidden="true" tabindex="-1"></a>**SNP chip cost trends (per animal):**</span>
<span id="cb31-316"><a href="#cb31-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-317"><a href="#cb31-317" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**2008:** BovineHD chip = $250</span>
<span id="cb31-318"><a href="#cb31-318" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**2010:** Bovine50K chip = $150</span>
<span id="cb31-319"><a href="#cb31-319" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**2015:** GGP 50K = $40</span>
<span id="cb31-320"><a href="#cb31-320" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**2020:** GGP 50K = $30, GGP-LD = $15</span>
<span id="cb31-321"><a href="#cb31-321" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**2025:** GGP 50K = $30-35, GGP-LD = $15-20</span>
<span id="cb31-322"><a href="#cb31-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-323"><a href="#cb31-323" aria-hidden="true" tabindex="-1"></a>This dramatic cost reduction—nearly 10-fold for routine genotyping—made genomics economically viable even for traits with modest economic value. Combined with imputation, programs can now genotype thousands of animals per year at costs far below traditional phenotyping and progeny testing.</span>
<span id="cb31-324"><a href="#cb31-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-325"><a href="#cb31-325" aria-hidden="true" tabindex="-1"></a>**Whole genome sequencing** (discussed next) is also declining in cost but remains more expensive (~$500-$2000/animal), so it's reserved for key reference animals.</span>
<span id="cb31-326"><a href="#cb31-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-327"><a href="#cb31-327" aria-hidden="true" tabindex="-1"></a><span class="fu">## Bioinformatics Basics: Quality Control and Imputation</span></span>
<span id="cb31-328"><a href="#cb31-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-329"><a href="#cb31-329" aria-hidden="true" tabindex="-1"></a>Once animals are genotyped, raw data must be processed and quality-controlled before use in genetic evaluations. **Bioinformatics** pipelines handle these steps.</span>
<span id="cb31-330"><a href="#cb31-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-331"><a href="#cb31-331" aria-hidden="true" tabindex="-1"></a><span class="fu">### Genotype Quality Control (QC)</span></span>
<span id="cb31-332"><a href="#cb31-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-333"><a href="#cb31-333" aria-hidden="true" tabindex="-1"></a>Not all genotypes are called correctly. Poor-quality DNA, technical errors, or rare variants can lead to incorrect genotype calls. Quality control filters remove unreliable SNPs and samples before analysis.</span>
<span id="cb31-334"><a href="#cb31-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-335"><a href="#cb31-335" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Call Rate</span></span>
<span id="cb31-336"><a href="#cb31-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-337"><a href="#cb31-337" aria-hidden="true" tabindex="-1"></a>**Call rate** measures the proportion of SNPs (or animals) successfully genotyped.</span>
<span id="cb31-338"><a href="#cb31-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-339"><a href="#cb31-339" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Animal call rate:** Percentage of SNPs with successful genotype calls for a given animal</span>
<span id="cb31-340"><a href="#cb31-340" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**SNP call rate:** Percentage of animals with successful genotype calls for a given SNP</span>
<span id="cb31-341"><a href="#cb31-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-342"><a href="#cb31-342" aria-hidden="true" tabindex="-1"></a>**Thresholds (typical):**</span>
<span id="cb31-343"><a href="#cb31-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-344"><a href="#cb31-344" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Animal call rate:** ≥ 90% (remove animals below this)</span>
<span id="cb31-345"><a href="#cb31-345" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**SNP call rate:** ≥ 95-98% (remove SNPs below this)</span>
<span id="cb31-346"><a href="#cb31-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-347"><a href="#cb31-347" aria-hidden="true" tabindex="-1"></a>**Why filter by call rate?**</span>
<span id="cb31-348"><a href="#cb31-348" aria-hidden="true" tabindex="-1"></a>Low call rates indicate poor DNA quality (for animals) or problematic SNP assays (for SNPs). Including them adds noise and can bias estimates.</span>
<span id="cb31-349"><a href="#cb31-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-350"><a href="#cb31-350" aria-hidden="true" tabindex="-1"></a>**Example:**</span>
<span id="cb31-351"><a href="#cb31-351" aria-hidden="true" tabindex="-1"></a>You genotype 1,000 pigs on a 60K SNP chip:</span>
<span id="cb31-352"><a href="#cb31-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-353"><a href="#cb31-353" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>One pig has genotypes called for only 48,000 SNPs (call rate = 80%). → Remove this animal.</span>
<span id="cb31-354"><a href="#cb31-354" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>One SNP is successfully called in only 850 animals (call rate = 85%). → Remove this SNP.</span>
<span id="cb31-355"><a href="#cb31-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-356"><a href="#cb31-356" aria-hidden="true" tabindex="-1"></a>After filtering, you have ~995 pigs and ~58,000 SNPs remaining.</span>
<span id="cb31-357"><a href="#cb31-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-358"><a href="#cb31-358" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Minor Allele Frequency (MAF)</span></span>
<span id="cb31-359"><a href="#cb31-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-360"><a href="#cb31-360" aria-hidden="true" tabindex="-1"></a>**Minor allele frequency (MAF)** is the frequency of the rarer allele at a SNP. Very low-MAF SNPs provide little information for genomic selection and are often genotyping errors or rare mutations.</span>
<span id="cb31-361"><a href="#cb31-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-362"><a href="#cb31-362" aria-hidden="true" tabindex="-1"></a>**Typical MAF thresholds:**</span>
<span id="cb31-363"><a href="#cb31-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-364"><a href="#cb31-364" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**MAF &lt; 0.01 or 0.05:** Remove SNP</span>
<span id="cb31-365"><a href="#cb31-365" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Rationale: Rare alleles contribute little to accuracy and increase computational burden</span>
<span id="cb31-366"><a href="#cb31-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-367"><a href="#cb31-367" aria-hidden="true" tabindex="-1"></a>**Why low-MAF SNPs are problematic:**</span>
<span id="cb31-368"><a href="#cb31-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-369"><a href="#cb31-369" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Low information content (most animals have the same genotype)</span>
<span id="cb31-370"><a href="#cb31-370" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Potentially genotyping errors (singletons or doubletons)</span>
<span id="cb31-371"><a href="#cb31-371" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Poor imputation accuracy (rare alleles hard to impute)</span>
<span id="cb31-372"><a href="#cb31-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-373"><a href="#cb31-373" aria-hidden="true" tabindex="-1"></a>**Example:**</span>
<span id="cb31-374"><a href="#cb31-374" aria-hidden="true" tabindex="-1"></a>A SNP in Holstein cattle has the following genotypes in 1,000 animals:</span>
<span id="cb31-375"><a href="#cb31-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-376"><a href="#cb31-376" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Genotype 0 (AA): 980 animals</span>
<span id="cb31-377"><a href="#cb31-377" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Genotype 1 (AG): 18 animals</span>
<span id="cb31-378"><a href="#cb31-378" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Genotype 2 (GG): 2 animals</span>
<span id="cb31-379"><a href="#cb31-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-380"><a href="#cb31-380" aria-hidden="true" tabindex="-1"></a>Allele frequency for G: $q = \frac{2(2) + 18}{2(1000)} = \frac{22}{2000} = 0.011$</span>
<span id="cb31-381"><a href="#cb31-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-382"><a href="#cb31-382" aria-hidden="true" tabindex="-1"></a>MAF = 0.011 (1.1%). This SNP would be removed if we use a MAF &gt; 0.05 threshold.</span>
<span id="cb31-383"><a href="#cb31-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-384"><a href="#cb31-384" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Hardy-Weinberg Equilibrium (HWE)</span></span>
<span id="cb31-385"><a href="#cb31-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-386"><a href="#cb31-386" aria-hidden="true" tabindex="-1"></a>**Hardy-Weinberg Equilibrium** is a principle from population genetics stating that, under random mating and no selection or mutation, genotype frequencies should follow:</span>
<span id="cb31-387"><a href="#cb31-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-388"><a href="#cb31-388" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb31-389"><a href="#cb31-389" aria-hidden="true" tabindex="-1"></a>P(AA) = p^2, \quad P(AG) = 2pq, \quad P(GG) = q^2</span>
<span id="cb31-390"><a href="#cb31-390" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb31-391"><a href="#cb31-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-392"><a href="#cb31-392" aria-hidden="true" tabindex="-1"></a>Where $p$ and $q$ are allele frequencies.</span>
<span id="cb31-393"><a href="#cb31-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-394"><a href="#cb31-394" aria-hidden="true" tabindex="-1"></a>**Why test for HWE?**</span>
<span id="cb31-395"><a href="#cb31-395" aria-hidden="true" tabindex="-1"></a>Large deviations from HWE can indicate:</span>
<span id="cb31-396"><a href="#cb31-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-397"><a href="#cb31-397" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Genotyping errors (e.g., heterozygotes miscalled as homozygotes)</span>
<span id="cb31-398"><a href="#cb31-398" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Population substructure (non-random mating)</span>
<span id="cb31-399"><a href="#cb31-399" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Selection at the locus</span>
<span id="cb31-400"><a href="#cb31-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-401"><a href="#cb31-401" aria-hidden="true" tabindex="-1"></a>**HWE filtering:**</span>
<span id="cb31-402"><a href="#cb31-402" aria-hidden="true" tabindex="-1"></a>SNPs with extreme HWE p-values (e.g., $p &lt; 10^{-6}$) are often removed. However, some deviation is expected in selected populations, so thresholds must be chosen carefully.</span>
<span id="cb31-403"><a href="#cb31-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-404"><a href="#cb31-404" aria-hidden="true" tabindex="-1"></a>**Example:**</span>
<span id="cb31-405"><a href="#cb31-405" aria-hidden="true" tabindex="-1"></a>Suppose we observe 100 animals with:</span>
<span id="cb31-406"><a href="#cb31-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-407"><a href="#cb31-407" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Genotype 0: 50 animals</span>
<span id="cb31-408"><a href="#cb31-408" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Genotype 1: 20 animals</span>
<span id="cb31-409"><a href="#cb31-409" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Genotype 2: 30 animals</span>
<span id="cb31-410"><a href="#cb31-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-411"><a href="#cb31-411" aria-hidden="true" tabindex="-1"></a>Expected under HWE (if $p = 0.60$):</span>
<span id="cb31-412"><a href="#cb31-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-413"><a href="#cb31-413" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$P(AA) = 0.36$ → 36 animals</span>
<span id="cb31-414"><a href="#cb31-414" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$P(AG) = 0.48$ → 48 animals</span>
<span id="cb31-415"><a href="#cb31-415" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$P(GG) = 0.16$ → 16 animals</span>
<span id="cb31-416"><a href="#cb31-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-417"><a href="#cb31-417" aria-hidden="true" tabindex="-1"></a>Observed heterozygosity (20) is much lower than expected (48), suggesting possible genotyping errors. A chi-square test would flag this SNP for removal.</span>
<span id="cb31-418"><a href="#cb31-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-419"><a href="#cb31-419" aria-hidden="true" tabindex="-1"></a><span class="fu">### Imputation</span></span>
<span id="cb31-420"><a href="#cb31-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-421"><a href="#cb31-421" aria-hidden="true" tabindex="-1"></a>**Imputation** is the process of predicting missing genotypes or "filling in" low-density genotypes to higher density using a reference panel of animals genotyped at high density.</span>
<span id="cb31-422"><a href="#cb31-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-423"><a href="#cb31-423" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Why Imputation?</span></span>
<span id="cb31-424"><a href="#cb31-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-425"><a href="#cb31-425" aria-hidden="true" tabindex="-1"></a>Imputation enables cost-effective genotyping strategies:</span>
<span id="cb31-426"><a href="#cb31-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-427"><a href="#cb31-427" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Cost savings:** Genotype most animals with cheap low-density chips; impute to high-density</span>
<span id="cb31-428"><a href="#cb31-428" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Combining datasets:** Merge animals genotyped on different chips</span>
<span id="cb31-429"><a href="#cb31-429" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Whole-genome sequence imputation:** Impute chip genotypes to full sequence using sequenced reference animals</span>
<span id="cb31-430"><a href="#cb31-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-431"><a href="#cb31-431" aria-hidden="true" tabindex="-1"></a>**Example:**</span>
<span id="cb31-432"><a href="#cb31-432" aria-hidden="true" tabindex="-1"></a>A swine breeding program genotypes 5,000 selection candidates per year:</span>
<span id="cb31-433"><a href="#cb31-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-434"><a href="#cb31-434" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Without imputation:** Genotype all with 60K chip at $60/animal = $300,000/year</span>
<span id="cb31-435"><a href="#cb31-435" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**With imputation:** Genotype with 20K chip at $25/animal = $125,000/year; impute to 60K using reference panel</span>
<span id="cb31-436"><a href="#cb31-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-437"><a href="#cb31-437" aria-hidden="true" tabindex="-1"></a>**Savings:** $175,000/year (58% reduction)</span>
<span id="cb31-438"><a href="#cb31-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-439"><a href="#cb31-439" aria-hidden="true" tabindex="-1"></a><span class="fu">#### How Imputation Works (Conceptually)</span></span>
<span id="cb31-440"><a href="#cb31-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-441"><a href="#cb31-441" aria-hidden="true" tabindex="-1"></a>Imputation exploits **linkage disequilibrium** and **pedigree relationships**.</span>
<span id="cb31-442"><a href="#cb31-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-443"><a href="#cb31-443" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Reference panel:** Animals genotyped at high density (or sequenced)</span>
<span id="cb31-444"><a href="#cb31-444" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Target animals:** Animals genotyped at low density (subset of SNPs)</span>
<span id="cb31-445"><a href="#cb31-445" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Shared haplotypes:** Target animals share chromosome segments (haplotypes) with reference animals due to common ancestry</span>
<span id="cb31-446"><a href="#cb31-446" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Prediction:** For each missing SNP in target animals, predict genotype based on reference haplotypes that match surrounding SNPs</span>
<span id="cb31-447"><a href="#cb31-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-448"><a href="#cb31-448" aria-hidden="true" tabindex="-1"></a>**Software:** Commonly used imputation programs include FImpute, Beagle, Minimac4, and Eagle.</span>
<span id="cb31-449"><a href="#cb31-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-450"><a href="#cb31-450" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Accuracy of Imputation</span></span>
<span id="cb31-451"><a href="#cb31-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-452"><a href="#cb31-452" aria-hidden="true" tabindex="-1"></a>Imputation accuracy depends on:</span>
<span id="cb31-453"><a href="#cb31-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-454"><a href="#cb31-454" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Reference panel size:** Larger reference = better accuracy</span>
<span id="cb31-455"><a href="#cb31-455" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Relationship to reference:** Close relatives impute more accurately</span>
<span id="cb31-456"><a href="#cb31-456" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**LD in population:** High LD (recent common ancestors) = better accuracy</span>
<span id="cb31-457"><a href="#cb31-457" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**SNP density:** Denser low-density chip = better imputation</span>
<span id="cb31-458"><a href="#cb31-458" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**MAF of SNP:** Common alleles impute better than rare alleles</span>
<span id="cb31-459"><a href="#cb31-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-460"><a href="#cb31-460" aria-hidden="true" tabindex="-1"></a>**Typical accuracy (correlation between true and imputed genotypes):**</span>
<span id="cb31-461"><a href="#cb31-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-462"><a href="#cb31-462" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Low-density (10K) → medium-density (50K): 0.90-0.95</span>
<span id="cb31-463"><a href="#cb31-463" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Medium-density (50K) → high-density (770K): 0.95-0.98</span>
<span id="cb31-464"><a href="#cb31-464" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>High-density → sequence: 0.85-0.95 (depends on MAF and reference panel)</span>
<span id="cb31-465"><a href="#cb31-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-466"><a href="#cb31-466" aria-hidden="true" tabindex="-1"></a>**Example:**</span>
<span id="cb31-467"><a href="#cb31-467" aria-hidden="true" tabindex="-1"></a>Dairy cattle are imputed from GGP-LD (30K) to BovineHD (777K) using a reference panel of 5,000 sequenced bulls. Imputation accuracy for common SNPs (MAF &gt; 0.05) exceeds 0.98, meaning &lt;2% of imputed genotypes are incorrect. For rare variants (MAF &lt; 0.01), accuracy may drop to 0.70-0.80.</span>
<span id="cb31-468"><a href="#cb31-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-469"><a href="#cb31-469" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Economic Calculation: Imputation Cost-Benefit</span></span>
<span id="cb31-470"><a href="#cb31-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-471"><a href="#cb31-471" aria-hidden="true" tabindex="-1"></a>Let's calculate the cost-effectiveness of imputation for a beef cattle seedstock operation:</span>
<span id="cb31-472"><a href="#cb31-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-473"><a href="#cb31-473" aria-hidden="true" tabindex="-1"></a>**Scenario:**</span>
<span id="cb31-474"><a href="#cb31-474" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Evaluate 500 bull calves per year for genomic EPDs</span>
<span id="cb31-475"><a href="#cb31-475" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Option A: Genotype all with 50K chip ($40/animal)</span>
<span id="cb31-476"><a href="#cb31-476" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Option B: Genotype all with LD chip ($18/animal), impute to 50K</span>
<span id="cb31-477"><a href="#cb31-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-478"><a href="#cb31-478" aria-hidden="true" tabindex="-1"></a>**Costs:**</span>
<span id="cb31-479"><a href="#cb31-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-480"><a href="#cb31-480" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Option A:** $40 × 500 = $20,000/year</span>
<span id="cb31-481"><a href="#cb31-481" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Option B:** $18 × 500 + $2,000 (reference panel maintenance) = $11,000/year</span>
<span id="cb31-482"><a href="#cb31-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-483"><a href="#cb31-483" aria-hidden="true" tabindex="-1"></a>**Accuracy loss:**</span>
<span id="cb31-484"><a href="#cb31-484" aria-hidden="true" tabindex="-1"></a>Imputed 50K genotypes have ~0.95 correlation with true genotypes. This causes a small reduction in genomic prediction accuracy (maybe 0.02-0.03 correlation units), but the cost savings far outweigh the minor accuracy loss.</span>
<span id="cb31-485"><a href="#cb31-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-486"><a href="#cb31-486" aria-hidden="true" tabindex="-1"></a>**Decision:** Most programs choose Option B (imputation).</span>
<span id="cb31-487"><a href="#cb31-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-488"><a href="#cb31-488" aria-hidden="true" tabindex="-1"></a><span class="fu">## Whole Genome Sequencing (WGS)</span></span>
<span id="cb31-489"><a href="#cb31-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-490"><a href="#cb31-490" aria-hidden="true" tabindex="-1"></a>While SNP chips genotype selected locations, **whole genome sequencing** determines the DNA sequence at every base pair.</span>
<span id="cb31-491"><a href="#cb31-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-492"><a href="#cb31-492" aria-hidden="true" tabindex="-1"></a><span class="fu">### What is Whole Genome Sequencing?</span></span>
<span id="cb31-493"><a href="#cb31-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-494"><a href="#cb31-494" aria-hidden="true" tabindex="-1"></a>**Whole genome sequencing (WGS)** is the process of determining the complete DNA sequence of an organism's genome—roughly 3 billion base pairs in cattle, 2.8 billion in pigs, 1 billion in chickens.</span>
<span id="cb31-495"><a href="#cb31-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-496"><a href="#cb31-496" aria-hidden="true" tabindex="-1"></a>Modern sequencing technologies (Illumina short-read sequencing, PacBio long-read sequencing) can sequence entire genomes in days at decreasing cost. The result is a file containing every nucleotide in the genome, including all SNPs, insertions, deletions, and structural variants.</span>
<span id="cb31-497"><a href="#cb31-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-498"><a href="#cb31-498" aria-hidden="true" tabindex="-1"></a><span class="fu">### WGS vs. SNP Chips</span></span>
<span id="cb31-499"><a href="#cb31-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-500"><a href="#cb31-500" aria-hidden="true" tabindex="-1"></a>How do SNP chips and WGS compare?</span>
<span id="cb31-501"><a href="#cb31-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-502"><a href="#cb31-502" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Feature <span class="pp">|</span> SNP Chip <span class="pp">|</span> Whole Genome Sequencing <span class="pp">|</span></span>
<span id="cb31-503"><a href="#cb31-503" aria-hidden="true" tabindex="-1"></a><span class="pp">|---------|----------|-------------------------|</span></span>
<span id="cb31-504"><a href="#cb31-504" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Variants detected** <span class="pp">|</span> 50,000-800,000 (fixed panel) <span class="pp">|</span> Millions (all variants) <span class="pp">|</span></span>
<span id="cb31-505"><a href="#cb31-505" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Cost per animal (2025)** <span class="pp">|</span> $15-150 <span class="pp">|</span> $300-2,000 <span class="pp">|</span></span>
<span id="cb31-506"><a href="#cb31-506" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Sequencing depth** <span class="pp">|</span> Not applicable <span class="pp">|</span> 10-30× (coverage per base) <span class="pp">|</span></span>
<span id="cb31-507"><a href="#cb31-507" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Causal mutations** <span class="pp">|</span> Likely in LD with causals <span class="pp">|</span> Can identify directly <span class="pp">|</span></span>
<span id="cb31-508"><a href="#cb31-508" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Structural variants** <span class="pp">|</span> Not detected <span class="pp">|</span> Detected (insertions, deletions, CNVs) <span class="pp">|</span></span>
<span id="cb31-509"><a href="#cb31-509" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Data size** <span class="pp">|</span> ~5-50 MB per animal <span class="pp">|</span> 30-100 GB per animal <span class="pp">|</span></span>
<span id="cb31-510"><a href="#cb31-510" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Processing time** <span class="pp">|</span> Hours <span class="pp">|</span> Days to weeks <span class="pp">|</span></span>
<span id="cb31-511"><a href="#cb31-511" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> **Primary use** <span class="pp">|</span> Routine genomic selection <span class="pp">|</span> Research, reference panels, QTN discovery <span class="pp">|</span></span>
<span id="cb31-512"><a href="#cb31-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-513"><a href="#cb31-513" aria-hidden="true" tabindex="-1"></a>**Key differences:**</span>
<span id="cb31-514"><a href="#cb31-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-515"><a href="#cb31-515" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Coverage:** WGS captures all genetic variation; chips capture only pre-selected SNPs</span>
<span id="cb31-516"><a href="#cb31-516" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Cost:** WGS is 10-100× more expensive per animal</span>
<span id="cb31-517"><a href="#cb31-517" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Causal variants:** WGS can find the actual mutations causing trait variation; chips rely on LD</span>
<span id="cb31-518"><a href="#cb31-518" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Data management:** WGS generates massive datasets requiring significant storage and computing</span>
<span id="cb31-519"><a href="#cb31-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-520"><a href="#cb31-520" aria-hidden="true" tabindex="-1"></a><span class="fu">### Uses of Whole Genome Sequencing</span></span>
<span id="cb31-521"><a href="#cb31-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-522"><a href="#cb31-522" aria-hidden="true" tabindex="-1"></a>WGS is not yet routine for all animals but has several important applications:</span>
<span id="cb31-523"><a href="#cb31-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-524"><a href="#cb31-524" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 1. Identifying Causal Mutations (QTN)</span></span>
<span id="cb31-525"><a href="#cb31-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-526"><a href="#cb31-526" aria-hidden="true" tabindex="-1"></a>The "holy grail" of genomics is finding **Quantitative Trait Nucleotides (QTN)**—the specific mutations causing variation in traits. WGS enables this through:</span>
<span id="cb31-527"><a href="#cb31-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-528"><a href="#cb31-528" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Fine-mapping:** Narrow GWAS signals to single genes or variants</span>
<span id="cb31-529"><a href="#cb31-529" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Candidate gene sequencing:** Sequence genes in QTL regions to find causal mutations</span>
<span id="cb31-530"><a href="#cb31-530" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Functional validation:** Test whether variants affect gene expression or protein function</span>
<span id="cb31-531"><a href="#cb31-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-532"><a href="#cb31-532" aria-hidden="true" tabindex="-1"></a>**Example: POLLED mutation in cattle**</span>
<span id="cb31-533"><a href="#cb31-533" aria-hidden="true" tabindex="-1"></a>Horns vs. polled (naturally hornless) cattle is controlled by a variant in the POLLED gene on chromosome 1. WGS identified the causal variant—a duplication and complex rearrangement. Now breeders can genotype this variant directly (via SNP chip or targeted test) to select for polled cattle, eliminating the need for dehorning.</span>
<span id="cb31-534"><a href="#cb31-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-535"><a href="#cb31-535" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 2. Building Imputation Reference Panels</span></span>
<span id="cb31-536"><a href="#cb31-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-537"><a href="#cb31-537" aria-hidden="true" tabindex="-1"></a>Many breeding programs sequence key influential animals (elite sires, foundation dams) to create reference panels. Other animals are genotyped on chips and imputed to sequence level.</span>
<span id="cb31-538"><a href="#cb31-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-539"><a href="#cb31-539" aria-hidden="true" tabindex="-1"></a>**Benefits:**</span>
<span id="cb31-540"><a href="#cb31-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-541"><a href="#cb31-541" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Capture rare variants that aren't on chips</span>
<span id="cb31-542"><a href="#cb31-542" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Increase genomic prediction accuracy (slightly)</span>
<span id="cb31-543"><a href="#cb31-543" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Enable QTN discovery in the population</span>
<span id="cb31-544"><a href="#cb31-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-545"><a href="#cb31-545" aria-hidden="true" tabindex="-1"></a>**Example: 1000 Bull Genomes Project**</span>
<span id="cb31-546"><a href="#cb31-546" aria-hidden="true" tabindex="-1"></a>An international consortium sequenced &gt;10,000 cattle (bulls and cows) from many breeds. This reference panel is used worldwide to impute chip genotypes to sequence, enabling discovery of breed-specific and rare variants.</span>
<span id="cb31-547"><a href="#cb31-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-548"><a href="#cb31-548" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 3. Structural Variants (SVs)</span></span>
<span id="cb31-549"><a href="#cb31-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-550"><a href="#cb31-550" aria-hidden="true" tabindex="-1"></a>SNP chips detect single-base changes but miss larger variants:</span>
<span id="cb31-551"><a href="#cb31-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-552"><a href="#cb31-552" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Insertions/deletions (indels):** Small (1-1000 bp) or large (&gt;1 kb)</span>
<span id="cb31-553"><a href="#cb31-553" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Copy number variants (CNVs):** Duplications or deletions of large segments</span>
<span id="cb31-554"><a href="#cb31-554" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Inversions:** Flipped chromosomal segments</span>
<span id="cb31-555"><a href="#cb31-555" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Translocations:** Movement of segments between chromosomes</span>
<span id="cb31-556"><a href="#cb31-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-557"><a href="#cb31-557" aria-hidden="true" tabindex="-1"></a>Some SVs have large effects on traits. WGS is required to detect them.</span>
<span id="cb31-558"><a href="#cb31-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-559"><a href="#cb31-559" aria-hidden="true" tabindex="-1"></a>**Example: KIT duplication in pigs**</span>
<span id="cb31-560"><a href="#cb31-560" aria-hidden="true" tabindex="-1"></a>A duplication in the KIT gene causes the "dominant white" coat color in pigs (used in Large White and Landrace breeds). This variant is a CNV not easily detected by SNP chips.</span>
<span id="cb31-561"><a href="#cb31-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-562"><a href="#cb31-562" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 4. Research Applications</span></span>
<span id="cb31-563"><a href="#cb31-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-564"><a href="#cb31-564" aria-hidden="true" tabindex="-1"></a>WGS is essential for:</span>
<span id="cb31-565"><a href="#cb31-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-566"><a href="#cb31-566" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Genome assembly and annotation (building reference genomes)</span>
<span id="cb31-567"><a href="#cb31-567" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Evolutionary studies (comparing species, breeds)</span>
<span id="cb31-568"><a href="#cb31-568" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Functional genomics (gene expression, regulation)</span>
<span id="cb31-569"><a href="#cb31-569" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Rare disease gene discovery</span>
<span id="cb31-570"><a href="#cb31-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-571"><a href="#cb31-571" aria-hidden="true" tabindex="-1"></a><span class="fu">### WGS in Practice: Cost-Effective Strategies</span></span>
<span id="cb31-572"><a href="#cb31-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-573"><a href="#cb31-573" aria-hidden="true" tabindex="-1"></a>While WGS is expensive, strategic use makes it feasible:</span>
<span id="cb31-574"><a href="#cb31-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-575"><a href="#cb31-575" aria-hidden="true" tabindex="-1"></a>**Key animal sequencing strategy:**</span>
<span id="cb31-576"><a href="#cb31-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-577"><a href="#cb31-577" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Sequence top 1-5% of population (elite sires, influential dams)</span>
<span id="cb31-578"><a href="#cb31-578" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Use these as reference panel</span>
<span id="cb31-579"><a href="#cb31-579" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Genotype all selection candidates on chips ($30-50)</span>
<span id="cb31-580"><a href="#cb31-580" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Impute chip genotypes to sequence level</span>
<span id="cb31-581"><a href="#cb31-581" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Use imputed sequence for genomic prediction</span>
<span id="cb31-582"><a href="#cb31-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-583"><a href="#cb31-583" aria-hidden="true" tabindex="-1"></a>**Example: Salmon breeding**</span>
<span id="cb31-584"><a href="#cb31-584" aria-hidden="true" tabindex="-1"></a>A salmon breeding company sequences 200 elite fish (cost: ~$200,000). They genotype 20,000 selection candidates on custom 200K SNP chips (cost: $500,000). Impute to sequence. Total cost: $700,000 for 20,000 animals sequenced-equivalent = $35/animal (much cheaper than sequencing all).</span>
<span id="cb31-585"><a href="#cb31-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-586"><a href="#cb31-586" aria-hidden="true" tabindex="-1"></a><span class="fu">## From Genotypes to Genomic Predictions</span></span>
<span id="cb31-587"><a href="#cb31-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-588"><a href="#cb31-588" aria-hidden="true" tabindex="-1"></a>We've discussed what SNPs are, how we measure them, and how we process the data. Now: how do genotypes predict breeding values?</span>
<span id="cb31-589"><a href="#cb31-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-590"><a href="#cb31-590" aria-hidden="true" tabindex="-1"></a>The short answer: genotypes across the genome capture variation in **true breeding values** because SNPs are in **linkage disequilibrium** with the actual causal mutations affecting traits. By estimating effects of many SNPs simultaneously (using phenotypic and genotypic data from a training population), we can predict the breeding value of any genotyped animal—even newborns with no phenotype or progeny.</span>
<span id="cb31-591"><a href="#cb31-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-592"><a href="#cb31-592" aria-hidden="true" tabindex="-1"></a><span class="fu">### Genomic Relationship Matrix (Preview)</span></span>
<span id="cb31-593"><a href="#cb31-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-594"><a href="#cb31-594" aria-hidden="true" tabindex="-1"></a>One key concept we'll explore further in Chapter 13 is the **genomic relationship matrix (G)**. This matrix quantifies the genetic similarity between all pairs of animals based on their SNP genotypes.</span>
<span id="cb31-595"><a href="#cb31-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-596"><a href="#cb31-596" aria-hidden="true" tabindex="-1"></a>Unlike pedigree-based relationships (which are expected values), genomic relationships are **realized relationships**—they capture the actual sharing of chromosome segments due to inheritance.</span>
<span id="cb31-597"><a href="#cb31-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-598"><a href="#cb31-598" aria-hidden="true" tabindex="-1"></a>**Key idea:**</span>
<span id="cb31-599"><a href="#cb31-599" aria-hidden="true" tabindex="-1"></a>Two full siblings share 50% of their genes *on average* (pedigree relationship = 0.50), but the actual sharing varies due to **Mendelian sampling** (random segregation of chromosomes). One sibling might inherit more favorable alleles, the other fewer. Genomic relationships capture this realized variation.</span>
<span id="cb31-600"><a href="#cb31-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-601"><a href="#cb31-601" aria-hidden="true" tabindex="-1"></a>We'll calculate the G matrix and use it for genomic predictions in Chapter 13. For now, understand that genotypes provide far more information than pedigrees alone.</span>
<span id="cb31-602"><a href="#cb31-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-603"><a href="#cb31-603" aria-hidden="true" tabindex="-1"></a><span class="fu">## Applications of Genomics in Animal Breeding</span></span>
<span id="cb31-604"><a href="#cb31-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-605"><a href="#cb31-605" aria-hidden="true" tabindex="-1"></a>Genomics has many applications beyond genomic selection (which we'll cover in Chapter 13). Here are the most important uses in modern breeding programs:</span>
<span id="cb31-606"><a href="#cb31-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-607"><a href="#cb31-607" aria-hidden="true" tabindex="-1"></a><span class="fu">### 1. Genomic Selection</span></span>
<span id="cb31-608"><a href="#cb31-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-609"><a href="#cb31-609" aria-hidden="true" tabindex="-1"></a>**Genomic selection** is the primary application—using genome-wide SNP data to predict breeding values and make selection decisions. It has revolutionized animal breeding by increasing accuracy and reducing generation intervals.</span>
<span id="cb31-610"><a href="#cb31-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-611"><a href="#cb31-611" aria-hidden="true" tabindex="-1"></a>**Key points:**</span>
<span id="cb31-612"><a href="#cb31-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-613"><a href="#cb31-613" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Predict breeding values (GEBVs) at birth</span>
<span id="cb31-614"><a href="#cb31-614" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Accuracy often 0.50-0.70 for young animals without own phenotypes</span>
<span id="cb31-615"><a href="#cb31-615" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Much higher than parent average (~0.30-0.40)</span>
<span id="cb31-616"><a href="#cb31-616" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Enabled dairy cattle to double genetic gain per year</span>
<span id="cb31-617"><a href="#cb31-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-618"><a href="#cb31-618" aria-hidden="true" tabindex="-1"></a>We'll explore genomic selection methods in detail in Chapter 13.</span>
<span id="cb31-619"><a href="#cb31-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-620"><a href="#cb31-620" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2. Parentage Verification and Pedigree Correction</span></span>
<span id="cb31-621"><a href="#cb31-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-622"><a href="#cb31-622" aria-hidden="true" tabindex="-1"></a>Recorded pedigrees often contain errors—misidentified sires or dams, incorrect birth records, etc. Errors are especially common in:</span>
<span id="cb31-623"><a href="#cb31-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-624"><a href="#cb31-624" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Multi-sire breeding (multiple bulls with a group of cows)</span>
<span id="cb31-625"><a href="#cb31-625" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Natural mating (paternity uncertain)</span>
<span id="cb31-626"><a href="#cb31-626" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Record-keeping errors</span>
<span id="cb31-627"><a href="#cb31-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-628"><a href="#cb31-628" aria-hidden="true" tabindex="-1"></a>SNP genotypes enable accurate parentage verification and correction.</span>
<span id="cb31-629"><a href="#cb31-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-630"><a href="#cb31-630" aria-hidden="true" tabindex="-1"></a>**How it works:**</span>
<span id="cb31-631"><a href="#cb31-631" aria-hidden="true" tabindex="-1"></a>Each offspring inherits exactly one allele at each SNP from each parent. By comparing offspring and candidate parents' genotypes, we can identify true parents (many SNPs match Mendelian inheritance) and exclude false parents (many SNPs violate Mendelian rules).</span>
<span id="cb31-632"><a href="#cb31-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-633"><a href="#cb31-633" aria-hidden="true" tabindex="-1"></a>**Software:** Parentage programs (e.g., COLONY, AlphaAssign, BreedAssign) calculate likelihood ratios for each candidate parent pair.</span>
<span id="cb31-634"><a href="#cb31-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-635"><a href="#cb31-635" aria-hidden="true" tabindex="-1"></a>**Example: Beef cattle**</span>
<span id="cb31-636"><a href="#cb31-636" aria-hidden="true" tabindex="-1"></a>A commercial cow-calf operation uses multi-sire breeding (4 bulls with 200 cows). After calving, all calves and bulls are genotyped. Parentage analysis assigns each calf to its true sire with &gt;99% confidence. This enables accurate pedigree-based or genomic evaluation, improving selection accuracy.</span>
<span id="cb31-637"><a href="#cb31-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-638"><a href="#cb31-638" aria-hidden="true" tabindex="-1"></a>**Impact:**</span>
<span id="cb31-639"><a href="#cb31-639" aria-hidden="true" tabindex="-1"></a>Pedigree errors reduce genetic progress. Correcting pedigrees with genomics increases accuracy by 0.05-0.10 correlation units—a substantial gain.</span>
<span id="cb31-640"><a href="#cb31-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-641"><a href="#cb31-641" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3. Genome-Wide Association Studies (GWAS)</span></span>
<span id="cb31-642"><a href="#cb31-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-643"><a href="#cb31-643" aria-hidden="true" tabindex="-1"></a>**Genome-Wide Association Studies (GWAS)** scan the genome to identify SNPs (or chromosomal regions) associated with traits of interest.</span>
<span id="cb31-644"><a href="#cb31-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-645"><a href="#cb31-645" aria-hidden="true" tabindex="-1"></a>**Procedure:**</span>
<span id="cb31-646"><a href="#cb31-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-647"><a href="#cb31-647" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Measure phenotypes for a trait (e.g., milk yield) in many animals</span>
<span id="cb31-648"><a href="#cb31-648" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Genotype all animals on SNP chip</span>
<span id="cb31-649"><a href="#cb31-649" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Test each SNP for association with the trait (regression or ANOVA)</span>
<span id="cb31-650"><a href="#cb31-650" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Identify SNPs with significant associations (after correcting for multiple testing)</span>
<span id="cb31-651"><a href="#cb31-651" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Investigate nearby genes as candidates for causal mutations</span>
<span id="cb31-652"><a href="#cb31-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-653"><a href="#cb31-653" aria-hidden="true" tabindex="-1"></a>**GWAS can:**</span>
<span id="cb31-654"><a href="#cb31-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-655"><a href="#cb31-655" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Discover QTL (Quantitative Trait Loci) affecting traits</span>
<span id="cb31-656"><a href="#cb31-656" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Identify candidate genes for further study</span>
<span id="cb31-657"><a href="#cb31-657" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Prioritize causal variants for functional testing</span>
<span id="cb31-658"><a href="#cb31-658" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Improve genomic predictions (if causal variants are included)</span>
<span id="cb31-659"><a href="#cb31-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-660"><a href="#cb31-660" aria-hidden="true" tabindex="-1"></a>**Example: Milk fat percentage in dairy cattle**</span>
<span id="cb31-661"><a href="#cb31-661" aria-hidden="true" tabindex="-1"></a>GWAS identified a strong signal on chromosome 14 associated with milk fat percentage. The causal gene was later confirmed to be DGAT1 (diacylglycerol acyltransferase 1), which encodes an enzyme in fat synthesis. A specific SNP in DGAT1 (K232A) explains ~50% of genetic variance in fat percentage.</span>
<span id="cb31-662"><a href="#cb31-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-663"><a href="#cb31-663" aria-hidden="true" tabindex="-1"></a>**Limitations:**</span>
<span id="cb31-664"><a href="#cb31-664" aria-hidden="true" tabindex="-1"></a>GWAS requires large sample sizes (thousands of animals) and only detects common variants with moderate-to-large effects. Rare variants and small-effect loci are missed.</span>
<span id="cb31-665"><a href="#cb31-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-666"><a href="#cb31-666" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4. Genomic Management of Inbreeding</span></span>
<span id="cb31-667"><a href="#cb31-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-668"><a href="#cb31-668" aria-hidden="true" tabindex="-1"></a>Inbreeding reduces performance (inbreeding depression) and should be managed carefully. Traditional approaches use **pedigree-based** inbreeding coefficients, but these are expected values—they don't capture actual inbreeding due to Mendelian sampling.</span>
<span id="cb31-669"><a href="#cb31-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-670"><a href="#cb31-670" aria-hidden="true" tabindex="-1"></a>**Genomic inbreeding** measures realized inbreeding directly from SNP genotypes. Several methods exist:</span>
<span id="cb31-671"><a href="#cb31-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-672"><a href="#cb31-672" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Runs of homozygosity (ROH):** Long stretches of homozygous SNPs indicate recent inbreeding</span>
<span id="cb31-673"><a href="#cb31-673" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Genomic inbreeding coefficient (F_G):** Deviation of observed homozygosity from expected</span>
<span id="cb31-674"><a href="#cb31-674" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Genomic relationship to base population:** Diagonal elements of G matrix</span>
<span id="cb31-675"><a href="#cb31-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-676"><a href="#cb31-676" aria-hidden="true" tabindex="-1"></a>**Why genomic inbreeding matters:**</span>
<span id="cb31-677"><a href="#cb31-677" aria-hidden="true" tabindex="-1"></a>Two animals with the same pedigree inbreeding (e.g., $F = 0.10$) can have different realized inbreeding. Genomic measures reveal which animals are truly inbred, enabling better mating decisions.</span>
<span id="cb31-678"><a href="#cb31-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-679"><a href="#cb31-679" aria-hidden="true" tabindex="-1"></a>**Application: Optimum contribution selection (OCS)**</span>
<span id="cb31-680"><a href="#cb31-680" aria-hidden="true" tabindex="-1"></a>Modern mating programs use genomic relationships to minimize inbreeding while maximizing genetic gain. This balances selection intensity with genetic diversity.</span>
<span id="cb31-681"><a href="#cb31-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-682"><a href="#cb31-682" aria-hidden="true" tabindex="-1"></a>**Example: Dutch Holstein cattle**</span>
<span id="cb31-683"><a href="#cb31-683" aria-hidden="true" tabindex="-1"></a>Genomic selection increased selection intensity, accelerating inbreeding rate. To counteract this, breeding organizations implemented genomic OCS, constraining inbreeding by limiting mating of close genomic relatives. Genetic diversity was stabilized while maintaining rapid genetic gain.</span>
<span id="cb31-684"><a href="#cb31-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-685"><a href="#cb31-685" aria-hidden="true" tabindex="-1"></a><span class="fu">### 5. Identification of Genetic Defects and Disease Mutations</span></span>
<span id="cb31-686"><a href="#cb31-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-687"><a href="#cb31-687" aria-hidden="true" tabindex="-1"></a>Some inherited diseases are caused by single genes with large effects (recessive lethals, dominant disorders). Genomics enables discovery and management of these mutations.</span>
<span id="cb31-688"><a href="#cb31-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-689"><a href="#cb31-689" aria-hidden="true" tabindex="-1"></a>**Process:**</span>
<span id="cb31-690"><a href="#cb31-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-691"><a href="#cb31-691" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Identify affected animals (e.g., calves with lethal defect)</span>
<span id="cb31-692"><a href="#cb31-692" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Sequence affected and normal animals</span>
<span id="cb31-693"><a href="#cb31-693" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Find causal mutation (often recessive)</span>
<span id="cb31-694"><a href="#cb31-694" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Develop diagnostic test (SNP chip or targeted assay)</span>
<span id="cb31-695"><a href="#cb31-695" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Test breeding animals; avoid matings producing affected offspring</span>
<span id="cb31-696"><a href="#cb31-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-697"><a href="#cb31-697" aria-hidden="true" tabindex="-1"></a>**Examples in cattle:**</span>
<span id="cb31-698"><a href="#cb31-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-699"><a href="#cb31-699" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**CVM (Complex Vertebral Malformation):** Recessive lethal in Holsteins. Carriers identified via SNP test; matings between carriers avoided.</span>
<span id="cb31-700"><a href="#cb31-700" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Cholesterol deficiency:** Recessive lethal in Holsteins. Causative mutation in APOB gene identified via WGS.</span>
<span id="cb31-701"><a href="#cb31-701" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Tibial hemimelia:** Recessive lethal in Herefords. Mutation in ULBP23 gene identified.</span>
<span id="cb31-702"><a href="#cb31-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-703"><a href="#cb31-703" aria-hidden="true" tabindex="-1"></a>**Examples in dogs:**</span>
<span id="cb31-704"><a href="#cb31-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-705"><a href="#cb31-705" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Progressive Retinal Atrophy (PRA):** Causes blindness in many breeds. Multiple gene mutations identified (e.g., PRCD-PRA); DNA tests available.</span>
<span id="cb31-706"><a href="#cb31-706" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Degenerative Myelopathy (DM):** Neurological disease in German Shepherds and others. Mutation in SOD1 gene; testing prevents affected puppies.</span>
<span id="cb31-707"><a href="#cb31-707" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**von Willebrand Disease (vWD):** Bleeding disorder in Dobermans and other breeds. Mutation in VWF gene; genotype before breeding.</span>
<span id="cb31-708"><a href="#cb31-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-709"><a href="#cb31-709" aria-hidden="true" tabindex="-1"></a>**Example in cats:**</span>
<span id="cb31-710"><a href="#cb31-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-711"><a href="#cb31-711" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Polycystic Kidney Disease (PKD):** Inherited kidney disease in Persians and related breeds. Mutation in PKD1 gene identified; testing eliminates disease from breeding populations.</span>
<span id="cb31-712"><a href="#cb31-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-713"><a href="#cb31-713" aria-hidden="true" tabindex="-1"></a>**Impact:**</span>
<span id="cb31-714"><a href="#cb31-714" aria-hidden="true" tabindex="-1"></a>Genomic testing has virtually eliminated many lethal recessives from purebred livestock and companion animal populations. This improves animal welfare and reduces economic losses.</span>
<span id="cb31-715"><a href="#cb31-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-716"><a href="#cb31-716" aria-hidden="true" tabindex="-1"></a><span class="fu">### 6. Crossbred Performance and Breed Composition</span></span>
<span id="cb31-717"><a href="#cb31-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-718"><a href="#cb31-718" aria-hidden="true" tabindex="-1"></a>In crossbreeding systems (common in swine, beef cattle, sheep), knowing an animal's **breed composition** is valuable. Genomics can estimate breed proportions and predict crossbred performance.</span>
<span id="cb31-719"><a href="#cb31-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-720"><a href="#cb31-720" aria-hidden="true" tabindex="-1"></a>**Breed composition from SNPs:**</span>
<span id="cb31-721"><a href="#cb31-721" aria-hidden="true" tabindex="-1"></a>Different breeds have distinct allele frequencies at many SNPs. By comparing an animal's genotypes to reference populations (purebred animals from each breed), we can estimate the percentage of each breed in its ancestry.</span>
<span id="cb31-722"><a href="#cb31-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-723"><a href="#cb31-723" aria-hidden="true" tabindex="-1"></a>**Software:** ADMIXTURE, STRUCTURE</span>
<span id="cb31-724"><a href="#cb31-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-725"><a href="#cb31-725" aria-hidden="true" tabindex="-1"></a>**Example: Beef cattle**</span>
<span id="cb31-726"><a href="#cb31-726" aria-hidden="true" tabindex="-1"></a>A commercial cow is genotyped. Analysis reveals she is 60% Angus, 30% Hereford, 10% Simmental. This information can guide mating decisions (e.g., use terminal sire to maximize heterosis) and explain performance (e.g., higher marbling from Angus ancestry).</span>
<span id="cb31-727"><a href="#cb31-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-728"><a href="#cb31-728" aria-hidden="true" tabindex="-1"></a>**Crossbred genomic prediction:**</span>
<span id="cb31-729"><a href="#cb31-729" aria-hidden="true" tabindex="-1"></a>Recent methods extend genomic selection to crossbreds by modeling breed-specific SNP effects. This improves accuracy in commercial crossbred populations.</span>
<span id="cb31-730"><a href="#cb31-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-731"><a href="#cb31-731" aria-hidden="true" tabindex="-1"></a><span class="fu">## R Demonstrations: Working with Genotype Data</span></span>
<span id="cb31-732"><a href="#cb31-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-733"><a href="#cb31-733" aria-hidden="true" tabindex="-1"></a>Let's work through some practical examples using R to explore SNP genotype data, calculate allele frequencies, perform quality control, and preview genomic relationships.</span>
<span id="cb31-734"><a href="#cb31-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-735"><a href="#cb31-735" aria-hidden="true" tabindex="-1"></a><span class="fu">### Demo 1: Simulating and Exploring SNP Genotype Data</span></span>
<span id="cb31-736"><a href="#cb31-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-737"><a href="#cb31-737" aria-hidden="true" tabindex="-1"></a>First, we'll simulate a SNP genotype dataset for 100 animals and 1,000 SNPs. In practice, you'd load real data from a file (e.g., PLINK format, VCF), but simulation lets us understand the structure.</span>
<span id="cb31-738"><a href="#cb31-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-741"><a href="#cb31-741" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb31-742"><a href="#cb31-742" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb31-743"><a href="#cb31-743" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb31-744"><a href="#cb31-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-745"><a href="#cb31-745" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate SNP genotypes for 100 animals, 1000 SNPs</span></span>
<span id="cb31-746"><a href="#cb31-746" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb31-747"><a href="#cb31-747" aria-hidden="true" tabindex="-1"></a>n_animals <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb31-748"><a href="#cb31-748" aria-hidden="true" tabindex="-1"></a>n_snps <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb31-749"><a href="#cb31-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-750"><a href="#cb31-750" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate genotypes (0, 1, 2) assuming Hardy-Weinberg proportions</span></span>
<span id="cb31-751"><a href="#cb31-751" aria-hidden="true" tabindex="-1"></a><span class="co"># Allele frequency p ~ Uniform(0.2, 0.8) for each SNP</span></span>
<span id="cb31-752"><a href="#cb31-752" aria-hidden="true" tabindex="-1"></a>allele_freq <span class="ot">&lt;-</span> <span class="fu">runif</span>(n_snps, <span class="at">min =</span> <span class="fl">0.20</span>, <span class="at">max =</span> <span class="fl">0.80</span>)</span>
<span id="cb31-753"><a href="#cb31-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-754"><a href="#cb31-754" aria-hidden="true" tabindex="-1"></a><span class="co"># Genotype matrix: rows = animals, columns = SNPs</span></span>
<span id="cb31-755"><a href="#cb31-755" aria-hidden="true" tabindex="-1"></a>genotypes <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> n_animals, <span class="at">ncol =</span> n_snps)</span>
<span id="cb31-756"><a href="#cb31-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-757"><a href="#cb31-757" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_snps) {</span>
<span id="cb31-758"><a href="#cb31-758" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> allele_freq[i]</span>
<span id="cb31-759"><a href="#cb31-759" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Hardy-Weinberg genotype frequencies</span></span>
<span id="cb31-760"><a href="#cb31-760" aria-hidden="true" tabindex="-1"></a>  freq_0 <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> p)<span class="sc">^</span><span class="dv">2</span>  <span class="co"># P(AA)</span></span>
<span id="cb31-761"><a href="#cb31-761" aria-hidden="true" tabindex="-1"></a>  freq_1 <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> p <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p)  <span class="co"># P(AG)</span></span>
<span id="cb31-762"><a href="#cb31-762" aria-hidden="true" tabindex="-1"></a>  freq_2 <span class="ot">&lt;-</span> p<span class="sc">^</span><span class="dv">2</span>  <span class="co"># P(GG)</span></span>
<span id="cb31-763"><a href="#cb31-763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-764"><a href="#cb31-764" aria-hidden="true" tabindex="-1"></a>  genotypes[, i] <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>), <span class="at">size =</span> n_animals, <span class="at">replace =</span> <span class="cn">TRUE</span>,</span>
<span id="cb31-765"><a href="#cb31-765" aria-hidden="true" tabindex="-1"></a>                           <span class="at">prob =</span> <span class="fu">c</span>(freq_0, freq_1, freq_2))</span>
<span id="cb31-766"><a href="#cb31-766" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb31-767"><a href="#cb31-767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-768"><a href="#cb31-768" aria-hidden="true" tabindex="-1"></a><span class="co"># Add some missing data (simulate incomplete genotyping)</span></span>
<span id="cb31-769"><a href="#cb31-769" aria-hidden="true" tabindex="-1"></a>missing_idx <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>(n_animals <span class="sc">*</span> n_snps), <span class="at">size =</span> <span class="fl">0.01</span> <span class="sc">*</span> n_animals <span class="sc">*</span> n_snps)</span>
<span id="cb31-770"><a href="#cb31-770" aria-hidden="true" tabindex="-1"></a>genotypes[missing_idx] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb31-771"><a href="#cb31-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-772"><a href="#cb31-772" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a tibble for easier manipulation</span></span>
<span id="cb31-773"><a href="#cb31-773" aria-hidden="true" tabindex="-1"></a>animal_ids <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Animal_"</span>, <span class="dv">1</span><span class="sc">:</span>n_animals)</span>
<span id="cb31-774"><a href="#cb31-774" aria-hidden="true" tabindex="-1"></a>snp_ids <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"SNP_"</span>, <span class="dv">1</span><span class="sc">:</span>n_snps)</span>
<span id="cb31-775"><a href="#cb31-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-776"><a href="#cb31-776" aria-hidden="true" tabindex="-1"></a>geno_df <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(genotypes, <span class="at">.name_repair =</span> <span class="st">"minimal"</span>)</span>
<span id="cb31-777"><a href="#cb31-777" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(geno_df) <span class="ot">&lt;-</span> snp_ids</span>
<span id="cb31-778"><a href="#cb31-778" aria-hidden="true" tabindex="-1"></a>geno_df <span class="ot">&lt;-</span> geno_df <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Animal_ID =</span> animal_ids, <span class="at">.before =</span> <span class="dv">1</span>)</span>
<span id="cb31-779"><a href="#cb31-779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-780"><a href="#cb31-780" aria-hidden="true" tabindex="-1"></a><span class="co"># Display first few animals and SNPs</span></span>
<span id="cb31-781"><a href="#cb31-781" aria-hidden="true" tabindex="-1"></a>geno_df <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>) <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span>
<span id="cb31-782"><a href="#cb31-782" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb31-783"><a href="#cb31-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-784"><a href="#cb31-784" aria-hidden="true" tabindex="-1"></a>Each row is an animal, each column (except the first) is a SNP. Values are 0, 1, 2, or NA (missing).</span>
<span id="cb31-785"><a href="#cb31-785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-786"><a href="#cb31-786" aria-hidden="true" tabindex="-1"></a><span class="fu">### Demo 2: Calculate and Visualize Allele Frequencies</span></span>
<span id="cb31-787"><a href="#cb31-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-788"><a href="#cb31-788" aria-hidden="true" tabindex="-1"></a>Let's calculate allele frequencies for all SNPs and visualize the distribution.</span>
<span id="cb31-789"><a href="#cb31-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-792"><a href="#cb31-792" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb31-793"><a href="#cb31-793" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb31-794"><a href="#cb31-794" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.width: 8</span></span>
<span id="cb31-795"><a href="#cb31-795" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.height: 5</span></span>
<span id="cb31-796"><a href="#cb31-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-797"><a href="#cb31-797" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele frequencies (frequency of "2" allele)</span></span>
<span id="cb31-798"><a href="#cb31-798" aria-hidden="true" tabindex="-1"></a><span class="co"># Allele freq p = (2 * n_2 + n_1) / (2 * n_total)</span></span>
<span id="cb31-799"><a href="#cb31-799" aria-hidden="true" tabindex="-1"></a>calc_allele_freq <span class="ot">&lt;-</span> <span class="cf">function</span>(geno_vec) {</span>
<span id="cb31-800"><a href="#cb31-800" aria-hidden="true" tabindex="-1"></a>  geno_vec <span class="ot">&lt;-</span> geno_vec[<span class="sc">!</span><span class="fu">is.na</span>(geno_vec)]  <span class="co"># Remove missing</span></span>
<span id="cb31-801"><a href="#cb31-801" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(geno_vec) <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">return</span>(<span class="cn">NA</span>)</span>
<span id="cb31-802"><a href="#cb31-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-803"><a href="#cb31-803" aria-hidden="true" tabindex="-1"></a>  n_0 <span class="ot">&lt;-</span> <span class="fu">sum</span>(geno_vec <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb31-804"><a href="#cb31-804" aria-hidden="true" tabindex="-1"></a>  n_1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(geno_vec <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb31-805"><a href="#cb31-805" aria-hidden="true" tabindex="-1"></a>  n_2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(geno_vec <span class="sc">==</span> <span class="dv">2</span>)</span>
<span id="cb31-806"><a href="#cb31-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-807"><a href="#cb31-807" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> (<span class="dv">2</span> <span class="sc">*</span> n_2 <span class="sc">+</span> n_1) <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> <span class="fu">length</span>(geno_vec))</span>
<span id="cb31-808"><a href="#cb31-808" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(p)</span>
<span id="cb31-809"><a href="#cb31-809" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb31-810"><a href="#cb31-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-811"><a href="#cb31-811" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply to all SNPs</span></span>
<span id="cb31-812"><a href="#cb31-812" aria-hidden="true" tabindex="-1"></a>allele_freqs <span class="ot">&lt;-</span> <span class="fu">apply</span>(genotypes, <span class="dv">2</span>, calc_allele_freq)</span>
<span id="cb31-813"><a href="#cb31-813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-814"><a href="#cb31-814" aria-hidden="true" tabindex="-1"></a><span class="co"># Create data frame</span></span>
<span id="cb31-815"><a href="#cb31-815" aria-hidden="true" tabindex="-1"></a>freq_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb31-816"><a href="#cb31-816" aria-hidden="true" tabindex="-1"></a>  <span class="at">SNP =</span> snp_ids,</span>
<span id="cb31-817"><a href="#cb31-817" aria-hidden="true" tabindex="-1"></a>  <span class="at">Allele_Frequency =</span> allele_freqs,</span>
<span id="cb31-818"><a href="#cb31-818" aria-hidden="true" tabindex="-1"></a>  <span class="at">MAF =</span> <span class="fu">ifelse</span>(allele_freqs <span class="sc">&lt;=</span> <span class="fl">0.5</span>, allele_freqs, <span class="dv">1</span> <span class="sc">-</span> allele_freqs)</span>
<span id="cb31-819"><a href="#cb31-819" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb31-820"><a href="#cb31-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-821"><a href="#cb31-821" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize allele frequency distribution</span></span>
<span id="cb31-822"><a href="#cb31-822" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(freq_df, <span class="fu">aes</span>(<span class="at">x =</span> Allele_Frequency)) <span class="sc">+</span></span>
<span id="cb31-823"><a href="#cb31-823" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb31-824"><a href="#cb31-824" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Allele Frequencies Across SNPs"</span>,</span>
<span id="cb31-825"><a href="#cb31-825" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Allele Frequency (p)"</span>,</span>
<span id="cb31-826"><a href="#cb31-826" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Number of SNPs"</span>) <span class="sc">+</span></span>
<span id="cb31-827"><a href="#cb31-827" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb31-828"><a href="#cb31-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-829"><a href="#cb31-829" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary statistics</span></span>
<span id="cb31-830"><a href="#cb31-830" aria-hidden="true" tabindex="-1"></a>freq_df <span class="sc">%&gt;%</span></span>
<span id="cb31-831"><a href="#cb31-831" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb31-832"><a href="#cb31-832" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mean_AF =</span> <span class="fu">mean</span>(Allele_Frequency, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb31-833"><a href="#cb31-833" aria-hidden="true" tabindex="-1"></a>    <span class="at">Min_AF =</span> <span class="fu">min</span>(Allele_Frequency, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb31-834"><a href="#cb31-834" aria-hidden="true" tabindex="-1"></a>    <span class="at">Max_AF =</span> <span class="fu">max</span>(Allele_Frequency, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb31-835"><a href="#cb31-835" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mean_MAF =</span> <span class="fu">mean</span>(MAF, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb31-836"><a href="#cb31-836" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb31-837"><a href="#cb31-837" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb31-838"><a href="#cb31-838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-839"><a href="#cb31-839" aria-hidden="true" tabindex="-1"></a>The histogram shows most SNPs have intermediate allele frequencies (0.3-0.7), which is typical in commercial populations after selection for many generations.</span>
<span id="cb31-840"><a href="#cb31-840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-841"><a href="#cb31-841" aria-hidden="true" tabindex="-1"></a><span class="fu">### Demo 3: Quality Control Workflow</span></span>
<span id="cb31-842"><a href="#cb31-842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-843"><a href="#cb31-843" aria-hidden="true" tabindex="-1"></a>Now let's perform quality control by filtering SNPs and animals based on call rate and MAF.</span>
<span id="cb31-844"><a href="#cb31-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-847"><a href="#cb31-847" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb31-848"><a href="#cb31-848" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb31-849"><a href="#cb31-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-850"><a href="#cb31-850" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Calculate SNP call rate (proportion of animals with genotype)</span></span>
<span id="cb31-851"><a href="#cb31-851" aria-hidden="true" tabindex="-1"></a>snp_call_rate <span class="ot">&lt;-</span> <span class="fu">apply</span>(genotypes, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(x)) <span class="sc">/</span> <span class="fu">length</span>(x))</span>
<span id="cb31-852"><a href="#cb31-852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-853"><a href="#cb31-853" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Calculate animal call rate (proportion of SNPs with genotype)</span></span>
<span id="cb31-854"><a href="#cb31-854" aria-hidden="true" tabindex="-1"></a>animal_call_rate <span class="ot">&lt;-</span> <span class="fu">apply</span>(genotypes, <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(x)) <span class="sc">/</span> <span class="fu">length</span>(x))</span>
<span id="cb31-855"><a href="#cb31-855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-856"><a href="#cb31-856" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary</span></span>
<span id="cb31-857"><a href="#cb31-857" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"SNP call rate summary:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb31-858"><a href="#cb31-858" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(snp_call_rate)</span>
<span id="cb31-859"><a href="#cb31-859" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Animal call rate summary:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb31-860"><a href="#cb31-860" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(animal_call_rate)</span>
<span id="cb31-861"><a href="#cb31-861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-862"><a href="#cb31-862" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Filter SNPs by call rate (threshold: 95%)</span></span>
<span id="cb31-863"><a href="#cb31-863" aria-hidden="true" tabindex="-1"></a>snp_pass_callrate <span class="ot">&lt;-</span> snp_call_rate <span class="sc">&gt;=</span> <span class="fl">0.95</span></span>
<span id="cb31-864"><a href="#cb31-864" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">SNPs passing call rate filter (&gt;=95%):"</span>, <span class="fu">sum</span>(snp_pass_callrate), <span class="st">"/"</span>, n_snps, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb31-865"><a href="#cb31-865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-866"><a href="#cb31-866" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Filter SNPs by MAF (threshold: 5%)</span></span>
<span id="cb31-867"><a href="#cb31-867" aria-hidden="true" tabindex="-1"></a>snp_pass_maf <span class="ot">&lt;-</span> freq_df<span class="sc">$</span>MAF <span class="sc">&gt;=</span> <span class="fl">0.05</span></span>
<span id="cb31-868"><a href="#cb31-868" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"SNPs passing MAF filter (&gt;=0.05):"</span>, <span class="fu">sum</span>(snp_pass_maf, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="st">"/"</span>, n_snps, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb31-869"><a href="#cb31-869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-870"><a href="#cb31-870" aria-hidden="true" tabindex="-1"></a><span class="co"># Combined filter</span></span>
<span id="cb31-871"><a href="#cb31-871" aria-hidden="true" tabindex="-1"></a>snp_pass <span class="ot">&lt;-</span> snp_pass_callrate <span class="sc">&amp;</span> snp_pass_maf</span>
<span id="cb31-872"><a href="#cb31-872" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"SNPs passing all QC:"</span>, <span class="fu">sum</span>(snp_pass, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="st">"/"</span>, n_snps, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb31-873"><a href="#cb31-873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-874"><a href="#cb31-874" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Filter animals by call rate (threshold: 90%)</span></span>
<span id="cb31-875"><a href="#cb31-875" aria-hidden="true" tabindex="-1"></a>animal_pass <span class="ot">&lt;-</span> animal_call_rate <span class="sc">&gt;=</span> <span class="fl">0.90</span></span>
<span id="cb31-876"><a href="#cb31-876" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Animals passing call rate filter (&gt;=90%):"</span>, <span class="fu">sum</span>(animal_pass), <span class="st">"/"</span>, n_animals, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb31-877"><a href="#cb31-877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-878"><a href="#cb31-878" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply filters</span></span>
<span id="cb31-879"><a href="#cb31-879" aria-hidden="true" tabindex="-1"></a>genotypes_qc <span class="ot">&lt;-</span> genotypes[animal_pass, snp_pass]</span>
<span id="cb31-880"><a href="#cb31-880" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Final dataset after QC: "</span>, <span class="fu">nrow</span>(genotypes_qc), <span class="st">"animals x"</span>, <span class="fu">ncol</span>(genotypes_qc), <span class="st">"SNPs</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb31-881"><a href="#cb31-881" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb31-882"><a href="#cb31-882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-883"><a href="#cb31-883" aria-hidden="true" tabindex="-1"></a>After QC, we've removed low-quality SNPs and animals, leaving a clean dataset for genomic analysis.</span>
<span id="cb31-884"><a href="#cb31-884" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-885"><a href="#cb31-885" aria-hidden="true" tabindex="-1"></a>**Quality control summary:**</span>
<span id="cb31-886"><a href="#cb31-886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-887"><a href="#cb31-887" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Before QC:** 100 animals, 1,000 SNPs</span>
<span id="cb31-888"><a href="#cb31-888" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**After QC:** ~99 animals, ~980 SNPs (numbers vary due to random simulation)</span>
<span id="cb31-889"><a href="#cb31-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-890"><a href="#cb31-890" aria-hidden="true" tabindex="-1"></a>In real datasets, QC might remove 1-5% of SNPs and &lt;1% of animals.</span>
<span id="cb31-891"><a href="#cb31-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-892"><a href="#cb31-892" aria-hidden="true" tabindex="-1"></a><span class="fu">### Demo 4: Calculate Genomic Relationship Matrix (Preview)</span></span>
<span id="cb31-893"><a href="#cb31-893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-894"><a href="#cb31-894" aria-hidden="true" tabindex="-1"></a>The **genomic relationship matrix (G)** quantifies genetic similarity between animals based on SNP genotypes. We'll calculate a simplified version here; Chapter 13 will explore this in detail.</span>
<span id="cb31-895"><a href="#cb31-895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-896"><a href="#cb31-896" aria-hidden="true" tabindex="-1"></a>**Formula (VanRaden, 2008):**</span>
<span id="cb31-897"><a href="#cb31-897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-898"><a href="#cb31-898" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb31-899"><a href="#cb31-899" aria-hidden="true" tabindex="-1"></a>\mathbf{G} = \frac{(\mathbf{Z} - \mathbf{P})(\mathbf{Z} - \mathbf{P})^\top}{2 \sum p_i (1 - p_i)}</span>
<span id="cb31-900"><a href="#cb31-900" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb31-901"><a href="#cb31-901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-902"><a href="#cb31-902" aria-hidden="true" tabindex="-1"></a>Where:</span>
<span id="cb31-903"><a href="#cb31-903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-904"><a href="#cb31-904" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\mathbf{Z}$ = genotype matrix (animals × SNPs), coded 0, 1, 2</span>
<span id="cb31-905"><a href="#cb31-905" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\mathbf{P}$ = matrix of expected genotypes ($2p_i$ for SNP $i$)</span>
<span id="cb31-906"><a href="#cb31-906" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$p_i$ = allele frequency at SNP $i$</span>
<span id="cb31-907"><a href="#cb31-907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-908"><a href="#cb31-908" aria-hidden="true" tabindex="-1"></a>Diagonal elements of $\mathbf{G}$ represent an animal's relationship to itself (close to 1). Off-diagonal elements represent relationships between pairs (0 = unrelated, 0.5 = parent-offspring or full siblings).</span>
<span id="cb31-909"><a href="#cb31-909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-912"><a href="#cb31-912" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb31-913"><a href="#cb31-913" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb31-914"><a href="#cb31-914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-915"><a href="#cb31-915" aria-hidden="true" tabindex="-1"></a><span class="co"># Use QC-filtered genotypes</span></span>
<span id="cb31-916"><a href="#cb31-916" aria-hidden="true" tabindex="-1"></a>Z <span class="ot">&lt;-</span> genotypes_qc</span>
<span id="cb31-917"><a href="#cb31-917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-918"><a href="#cb31-918" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate allele frequencies for QC-filtered SNPs</span></span>
<span id="cb31-919"><a href="#cb31-919" aria-hidden="true" tabindex="-1"></a>p_vec <span class="ot">&lt;-</span> <span class="fu">apply</span>(Z, <span class="dv">2</span>, calc_allele_freq)</span>
<span id="cb31-920"><a href="#cb31-920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-921"><a href="#cb31-921" aria-hidden="true" tabindex="-1"></a><span class="co"># Center genotypes: Z - P</span></span>
<span id="cb31-922"><a href="#cb31-922" aria-hidden="true" tabindex="-1"></a>P <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="dv">2</span> <span class="sc">*</span> p_vec, <span class="at">each =</span> <span class="fu">nrow</span>(Z)), <span class="at">nrow =</span> <span class="fu">nrow</span>(Z))</span>
<span id="cb31-923"><a href="#cb31-923" aria-hidden="true" tabindex="-1"></a>Z_centered <span class="ot">&lt;-</span> Z <span class="sc">-</span> P</span>
<span id="cb31-924"><a href="#cb31-924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-925"><a href="#cb31-925" aria-hidden="true" tabindex="-1"></a><span class="co"># Handle missing data: set to 0 (mean imputation)</span></span>
<span id="cb31-926"><a href="#cb31-926" aria-hidden="true" tabindex="-1"></a>Z_centered[<span class="fu">is.na</span>(Z_centered)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb31-927"><a href="#cb31-927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-928"><a href="#cb31-928" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate G matrix</span></span>
<span id="cb31-929"><a href="#cb31-929" aria-hidden="true" tabindex="-1"></a>denominator <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">sum</span>(p_vec <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p_vec), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb31-930"><a href="#cb31-930" aria-hidden="true" tabindex="-1"></a>G <span class="ot">&lt;-</span> (Z_centered <span class="sc">%*%</span> <span class="fu">t</span>(Z_centered)) <span class="sc">/</span> denominator</span>
<span id="cb31-931"><a href="#cb31-931" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-932"><a href="#cb31-932" aria-hidden="true" tabindex="-1"></a><span class="co"># Add animal IDs</span></span>
<span id="cb31-933"><a href="#cb31-933" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(G) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(G) <span class="ot">&lt;-</span> animal_ids[animal_pass]</span>
<span id="cb31-934"><a href="#cb31-934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-935"><a href="#cb31-935" aria-hidden="true" tabindex="-1"></a><span class="co"># Display diagonal elements (self-relationships, should be ~1)</span></span>
<span id="cb31-936"><a href="#cb31-936" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Diagonal elements of G (self-relationships):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb31-937"><a href="#cb31-937" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">diag</span>(G))</span>
<span id="cb31-938"><a href="#cb31-938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-939"><a href="#cb31-939" aria-hidden="true" tabindex="-1"></a><span class="co"># Display off-diagonal elements (pairwise relationships)</span></span>
<span id="cb31-940"><a href="#cb31-940" aria-hidden="true" tabindex="-1"></a>G_offdiag <span class="ot">&lt;-</span> G[<span class="fu">lower.tri</span>(G)]</span>
<span id="cb31-941"><a href="#cb31-941" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Off-diagonal elements of G (pairwise relationships):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb31-942"><a href="#cb31-942" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(G_offdiag)</span>
<span id="cb31-943"><a href="#cb31-943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-944"><a href="#cb31-944" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize distribution of genomic relationships</span></span>
<span id="cb31-945"><a href="#cb31-945" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">Relationship =</span> G_offdiag) <span class="sc">%&gt;%</span></span>
<span id="cb31-946"><a href="#cb31-946" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Relationship)) <span class="sc">+</span></span>
<span id="cb31-947"><a href="#cb31-947" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">40</span>, <span class="at">fill =</span> <span class="st">"coral"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb31-948"><a href="#cb31-948" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Genomic Relationships (off-diagonal elements)"</span>,</span>
<span id="cb31-949"><a href="#cb31-949" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Genomic Relationship"</span>,</span>
<span id="cb31-950"><a href="#cb31-950" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb31-951"><a href="#cb31-951" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb31-952"><a href="#cb31-952" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb31-953"><a href="#cb31-953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-954"><a href="#cb31-954" aria-hidden="true" tabindex="-1"></a>**Interpretation:**</span>
<span id="cb31-955"><a href="#cb31-955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-956"><a href="#cb31-956" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Diagonal elements** (self-relationships) are close to 1.0, as expected</span>
<span id="cb31-957"><a href="#cb31-957" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Off-diagonal elements** (relationships between animals) average near 0 in this simulated unrelated population</span>
<span id="cb31-958"><a href="#cb31-958" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>In real populations with pedigree structure, you'd see clusters: unrelated (~0), half-siblings (~0.25), full siblings or parent-offspring (~0.5)</span>
<span id="cb31-959"><a href="#cb31-959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-960"><a href="#cb31-960" aria-hidden="true" tabindex="-1"></a>**Key insight:** The G matrix captures realized genetic similarity. Animals with similar SNP genotypes have high G values, even if pedigree relationships are unknown. This is why genomics works in populations with incomplete or erroneous pedigrees.</span>
<span id="cb31-961"><a href="#cb31-961" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-962"><a href="#cb31-962" aria-hidden="true" tabindex="-1"></a><span class="fu">## Summary</span></span>
<span id="cb31-963"><a href="#cb31-963" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-964"><a href="#cb31-964" aria-hidden="true" tabindex="-1"></a>This chapter introduced genomics and its transformative role in animal breeding. Let's recap the key points:</span>
<span id="cb31-965"><a href="#cb31-965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-966"><a href="#cb31-966" aria-hidden="true" tabindex="-1"></a>**DNA markers (SNPs):**</span>
<span id="cb31-967"><a href="#cb31-967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-968"><a href="#cb31-968" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Single Nucleotide Polymorphisms (SNPs) are single-base differences in DNA</span>
<span id="cb31-969"><a href="#cb31-969" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Genotypes coded as 0 (AA), 1 (AG), or 2 (GG)</span>
<span id="cb31-970"><a href="#cb31-970" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Millions of SNPs exist across genomes; we genotype thousands to hundreds of thousands</span>
<span id="cb31-971"><a href="#cb31-971" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>SNPs are useful because they're abundant, stable, and in linkage disequilibrium with causal mutations</span>
<span id="cb31-972"><a href="#cb31-972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-973"><a href="#cb31-973" aria-hidden="true" tabindex="-1"></a>**SNP chips:**</span>
<span id="cb31-974"><a href="#cb31-974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-975"><a href="#cb31-975" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Microarrays that genotype 10,000 to 800,000 SNPs simultaneously</span>
<span id="cb31-976"><a href="#cb31-976" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Species-specific chips for cattle, swine, poultry, horses, dogs, cats, sheep, aquaculture species</span>
<span id="cb31-977"><a href="#cb31-977" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Costs have dropped dramatically ($15-$150 per animal, depending on density)</span>
<span id="cb31-978"><a href="#cb31-978" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>High-, medium-, and low-density options enable cost-effective imputation strategies</span>
<span id="cb31-979"><a href="#cb31-979" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-980"><a href="#cb31-980" aria-hidden="true" tabindex="-1"></a>**Quality control and imputation:**</span>
<span id="cb31-981"><a href="#cb31-981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-982"><a href="#cb31-982" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Genotype data must be quality-controlled (call rate, MAF, HWE)</span>
<span id="cb31-983"><a href="#cb31-983" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Imputation predicts missing or low-density genotypes using high-density reference panels</span>
<span id="cb31-984"><a href="#cb31-984" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Imputation enables cost savings (genotype most animals with cheap chips, impute to high density)</span>
<span id="cb31-985"><a href="#cb31-985" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Accuracy of imputation typically &gt;95% for common SNPs</span>
<span id="cb31-986"><a href="#cb31-986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-987"><a href="#cb31-987" aria-hidden="true" tabindex="-1"></a>**Whole genome sequencing:**</span>
<span id="cb31-988"><a href="#cb31-988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-989"><a href="#cb31-989" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Sequences every base pair (~3 billion in cattle)</span>
<span id="cb31-990"><a href="#cb31-990" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>More expensive than SNP chips ($500-2000 vs. $30-150)</span>
<span id="cb31-991"><a href="#cb31-991" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Enables identification of causal mutations (QTN), structural variants, and rare alleles</span>
<span id="cb31-992"><a href="#cb31-992" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Used strategically: sequence elite animals, impute others to sequence</span>
<span id="cb31-993"><a href="#cb31-993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-994"><a href="#cb31-994" aria-hidden="true" tabindex="-1"></a>**Applications:**</span>
<span id="cb31-995"><a href="#cb31-995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-996"><a href="#cb31-996" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Genomic selection** (Chapter 13): Predict breeding values using genome-wide SNPs</span>
<span id="cb31-997"><a href="#cb31-997" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Parentage verification:** Correct pedigree errors using SNP-based parentage</span>
<span id="cb31-998"><a href="#cb31-998" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**GWAS:** Discover QTL and candidate genes for traits</span>
<span id="cb31-999"><a href="#cb31-999" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Genomic inbreeding management:** Measure realized inbreeding, optimize matings</span>
<span id="cb31-1000"><a href="#cb31-1000" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Genetic defect identification:** Find and manage lethal recessives and disease mutations</span>
<span id="cb31-1001"><a href="#cb31-1001" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Crossbred performance:** Estimate breed composition, predict crossbred merit</span>
<span id="cb31-1002"><a href="#cb31-1002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-1003"><a href="#cb31-1003" aria-hidden="true" tabindex="-1"></a>**Impact:**</span>
<span id="cb31-1004"><a href="#cb31-1004" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-1005"><a href="#cb31-1005" aria-hidden="true" tabindex="-1"></a>Genomics has revolutionized animal breeding. Genetic gain has doubled in dairy cattle, swine, and poultry breeding programs. Generation intervals have shortened. Selection accuracy has increased, especially for young animals and expensive-to-measure traits. Today, genomics is standard practice in commercial breeding worldwide.</span>
<span id="cb31-1006"><a href="#cb31-1006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-1007"><a href="#cb31-1007" aria-hidden="true" tabindex="-1"></a>In Chapter 13, we'll dive into **genomic selection** methods—how we use SNP genotypes to predict breeding values and make selection decisions.</span>
<span id="cb31-1008"><a href="#cb31-1008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-1009"><a href="#cb31-1009" aria-hidden="true" tabindex="-1"></a><span class="fu">## Practice Problems</span></span>
<span id="cb31-1010"><a href="#cb31-1010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-1011"><a href="#cb31-1011" aria-hidden="true" tabindex="-1"></a>Test your understanding with these problems:</span>
<span id="cb31-1012"><a href="#cb31-1012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-1013"><a href="#cb31-1013" aria-hidden="true" tabindex="-1"></a>**1. SNP Basics**</span>
<span id="cb31-1014"><a href="#cb31-1014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-1015"><a href="#cb31-1015" aria-hidden="true" tabindex="-1"></a>a) What does SNP stand for? Describe what a SNP is in one sentence.</span>
<span id="cb31-1016"><a href="#cb31-1016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-1017"><a href="#cb31-1017" aria-hidden="true" tabindex="-1"></a>b) A SNP has two alleles: C and T. An animal has genotype CT. How would this be coded numerically (0, 1, or 2)?</span>
<span id="cb31-1018"><a href="#cb31-1018" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-1019"><a href="#cb31-1019" aria-hidden="true" tabindex="-1"></a>c) Why are SNPs useful for predicting breeding values even though most SNPs are not themselves causal mutations?</span>
<span id="cb31-1020"><a href="#cb31-1020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-1021"><a href="#cb31-1021" aria-hidden="true" tabindex="-1"></a>**2. Allele Frequency Calculation**</span>
<span id="cb31-1022"><a href="#cb31-1022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-1023"><a href="#cb31-1023" aria-hidden="true" tabindex="-1"></a>You genotype 200 beef cattle at a SNP and observe:</span>
<span id="cb31-1024"><a href="#cb31-1024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-1025"><a href="#cb31-1025" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>50 animals with genotype 0 (CC)</span>
<span id="cb31-1026"><a href="#cb31-1026" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>100 animals with genotype 1 (CT)</span>
<span id="cb31-1027"><a href="#cb31-1027" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>50 animals with genotype 2 (TT)</span>
<span id="cb31-1028"><a href="#cb31-1028" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-1029"><a href="#cb31-1029" aria-hidden="true" tabindex="-1"></a>a) Calculate the frequency of the C allele.</span>
<span id="cb31-1030"><a href="#cb31-1030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-1031"><a href="#cb31-1031" aria-hidden="true" tabindex="-1"></a>b) Calculate the frequency of the T allele.</span>
<span id="cb31-1032"><a href="#cb31-1032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-1033"><a href="#cb31-1033" aria-hidden="true" tabindex="-1"></a>c) What is the minor allele frequency (MAF)?</span>
<span id="cb31-1034"><a href="#cb31-1034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-1035"><a href="#cb31-1035" aria-hidden="true" tabindex="-1"></a>d) Would this SNP pass a MAF filter of ≥0.05? Why or why not?</span>
<span id="cb31-1036"><a href="#cb31-1036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-1037"><a href="#cb31-1037" aria-hidden="true" tabindex="-1"></a>**3. Genotyping Strategy Cost-Benefit**</span>
<span id="cb31-1038"><a href="#cb31-1038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-1039"><a href="#cb31-1039" aria-hidden="true" tabindex="-1"></a>A swine breeding company evaluates 10,000 pigs per year. They have two genotyping options:</span>
<span id="cb31-1040"><a href="#cb31-1040" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-1041"><a href="#cb31-1041" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Option A:** Genotype all pigs with a 60K SNP chip at $50 per animal</span>
<span id="cb31-1042"><a href="#cb31-1042" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Option B:** Genotype all pigs with a 20K SNP chip at $20 per animal and impute to 60K (reference panel maintenance costs $10,000/year)</span>
<span id="cb31-1043"><a href="#cb31-1043" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-1044"><a href="#cb31-1044" aria-hidden="true" tabindex="-1"></a>a) Calculate the total annual cost for each option.</span>
<span id="cb31-1045"><a href="#cb31-1045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-1046"><a href="#cb31-1046" aria-hidden="true" tabindex="-1"></a>b) Which option is more cost-effective?</span>
<span id="cb31-1047"><a href="#cb31-1047" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-1048"><a href="#cb31-1048" aria-hidden="true" tabindex="-1"></a>c) If imputation reduces genomic prediction accuracy by 0.02 correlation units, would you still choose the cheaper option? Explain your reasoning.</span>
<span id="cb31-1049"><a href="#cb31-1049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-1050"><a href="#cb31-1050" aria-hidden="true" tabindex="-1"></a>**4. Imputation**</span>
<span id="cb31-1051"><a href="#cb31-1051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-1052"><a href="#cb31-1052" aria-hidden="true" tabindex="-1"></a>Explain in 2-3 sentences:</span>
<span id="cb31-1053"><a href="#cb31-1053" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-1054"><a href="#cb31-1054" aria-hidden="true" tabindex="-1"></a>a) What is imputation in the context of genomic data?</span>
<span id="cb31-1055"><a href="#cb31-1055" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-1056"><a href="#cb31-1056" aria-hidden="true" tabindex="-1"></a>b) Why is imputation economically valuable for breeding programs?</span>
<span id="cb31-1057"><a href="#cb31-1057" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-1058"><a href="#cb31-1058" aria-hidden="true" tabindex="-1"></a>c) What factors influence imputation accuracy?</span>
<span id="cb31-1059"><a href="#cb31-1059" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-1060"><a href="#cb31-1060" aria-hidden="true" tabindex="-1"></a>**5. SNP Chips vs. Whole Genome Sequencing**</span>
<span id="cb31-1061"><a href="#cb31-1061" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-1062"><a href="#cb31-1062" aria-hidden="true" tabindex="-1"></a>You are designing a genomics strategy for a dairy cattle breeding program.</span>
<span id="cb31-1063"><a href="#cb31-1063" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-1064"><a href="#cb31-1064" aria-hidden="true" tabindex="-1"></a>a) Which animals would you choose to sequence (whole genome sequencing), and why?</span>
<span id="cb31-1065"><a href="#cb31-1065" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-1066"><a href="#cb31-1066" aria-hidden="true" tabindex="-1"></a>b) Which animals would you genotype on SNP chips?</span>
<span id="cb31-1067"><a href="#cb31-1067" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-1068"><a href="#cb31-1068" aria-hidden="true" tabindex="-1"></a>c) Justify your strategy in terms of cost, information, and breeding goals.</span>
<span id="cb31-1069"><a href="#cb31-1069" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-1070"><a href="#cb31-1070" aria-hidden="true" tabindex="-1"></a>**6. Quality Control**</span>
<span id="cb31-1071"><a href="#cb31-1071" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-1072"><a href="#cb31-1072" aria-hidden="true" tabindex="-1"></a>You receive genotype data for 500 animals genotyped on a 50K SNP chip. Quality control reveals:</span>
<span id="cb31-1073"><a href="#cb31-1073" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-1074"><a href="#cb31-1074" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>5 animals with call rate &lt;85%</span>
<span id="cb31-1075"><a href="#cb31-1075" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>200 SNPs with call rate &lt;90%</span>
<span id="cb31-1076"><a href="#cb31-1076" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>1,500 SNPs with MAF &lt;0.01</span>
<span id="cb31-1077"><a href="#cb31-1077" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-1078"><a href="#cb31-1078" aria-hidden="true" tabindex="-1"></a>a) Which animals would you remove from the dataset? Why?</span>
<span id="cb31-1079"><a href="#cb31-1079" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-1080"><a href="#cb31-1080" aria-hidden="true" tabindex="-1"></a>b) Which SNPs would you remove (assume call rate threshold = 95%, MAF threshold = 0.05)? Roughly how many SNPs remain?</span>
<span id="cb31-1081"><a href="#cb31-1081" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-1082"><a href="#cb31-1082" aria-hidden="true" tabindex="-1"></a>c) Why is it important to perform quality control before genomic evaluation?</span>
<span id="cb31-1083"><a href="#cb31-1083" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-1084"><a href="#cb31-1084" aria-hidden="true" tabindex="-1"></a>**7. Application Scenario**</span>
<span id="cb31-1085"><a href="#cb31-1085" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-1086"><a href="#cb31-1086" aria-hidden="true" tabindex="-1"></a>A beef cattle breeder wants to use genomics in their seedstock operation. Describe two applications of genomics (other than genomic selection) that would benefit this breeder. For each application, explain:</span>
<span id="cb31-1087"><a href="#cb31-1087" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-1088"><a href="#cb31-1088" aria-hidden="true" tabindex="-1"></a>a) What it does</span>
<span id="cb31-1089"><a href="#cb31-1089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-1090"><a href="#cb31-1090" aria-hidden="true" tabindex="-1"></a>b) How it works (briefly)</span>
<span id="cb31-1091"><a href="#cb31-1091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-1092"><a href="#cb31-1092" aria-hidden="true" tabindex="-1"></a>c) What benefit it provides</span>
<span id="cb31-1093"><a href="#cb31-1093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-1094"><a href="#cb31-1094" aria-hidden="true" tabindex="-1"></a><span class="fu">## Further Reading</span></span>
<span id="cb31-1095"><a href="#cb31-1095" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-1096"><a href="#cb31-1096" aria-hidden="true" tabindex="-1"></a>**Foundational Papers:**</span>
<span id="cb31-1097"><a href="#cb31-1097" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-1098"><a href="#cb31-1098" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Hayes, B. J., &amp; Goddard, M. E. (2010).** Genome-wide association and genomic selection in animal breeding. *Genome*, 53(11), 876-883.</span>
<span id="cb31-1099"><a href="#cb31-1099" aria-hidden="true" tabindex="-1"></a>  → Excellent overview of how GWAS and genomic selection revolutionized breeding</span>
<span id="cb31-1100"><a href="#cb31-1100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-1101"><a href="#cb31-1101" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**VanRaden, P. M. (2008).** Efficient methods to compute genomic predictions. *Journal of Dairy Science*, 91(11), 4414-4423.</span>
<span id="cb31-1102"><a href="#cb31-1102" aria-hidden="true" tabindex="-1"></a>  → Describes calculation of the genomic relationship matrix (G)</span>
<span id="cb31-1103"><a href="#cb31-1103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-1104"><a href="#cb31-1104" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Meuwissen, T. H., Hayes, B. J., &amp; Goddard, M. E. (2001).** Prediction of total genetic value using genome-wide dense marker maps. *Genetics*, 157(4), 1819-1829.</span>
<span id="cb31-1105"><a href="#cb31-1105" aria-hidden="true" tabindex="-1"></a>  → The original paper proposing genomic selection</span>
<span id="cb31-1106"><a href="#cb31-1106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-1107"><a href="#cb31-1107" aria-hidden="true" tabindex="-1"></a>**Species-Specific Genomics:**</span>
<span id="cb31-1108"><a href="#cb31-1108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-1109"><a href="#cb31-1109" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Dairy Cattle:** VanRaden et al. (2009). Invited review: Reliability of genomic predictions for North American Holstein bulls. *Journal of Dairy Science*, 92(1), 16-24.</span>
<span id="cb31-1110"><a href="#cb31-1110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-1111"><a href="#cb31-1111" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Swine:** Boichard et al. (2016). Genomic selection in domestic animals: Principles, applications and perspectives. *Comptes Rendus Biologies*, 339(7-8), 274-277.</span>
<span id="cb31-1112"><a href="#cb31-1112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-1113"><a href="#cb31-1113" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Poultry:** Wolc et al. (2016). Response and inbreeding from a genomic selection experiment in layer chickens. *Genetics Selection Evolution*, 47(1), 59.</span>
<span id="cb31-1114"><a href="#cb31-1114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-1115"><a href="#cb31-1115" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Companion Animals:** Karlsson &amp; Lindblad-Toh (2008). Leader of the pack: gene mapping in dogs and other model organisms. *Nature Reviews Genetics*, 9(9), 713-725.</span>
<span id="cb31-1116"><a href="#cb31-1116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-1117"><a href="#cb31-1117" aria-hidden="true" tabindex="-1"></a>**Online Resources:**</span>
<span id="cb31-1118"><a href="#cb31-1118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-1119"><a href="#cb31-1119" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Council on Dairy Cattle Breeding (CDCB):** https://www.uscdcb.com/ → Genomic evaluations, reference populations</span>
<span id="cb31-1120"><a href="#cb31-1120" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**USDA Animal Genomics and Improvement Laboratory:** https://www.ars.usda.gov/animalgenomics/ → Research, tools</span>
<span id="cb31-1121"><a href="#cb31-1121" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**1000 Bull Genomes Project:** http://www.1000bullgenomes.com/ → Cattle whole genome sequences</span>
<span id="cb31-1122"><a href="#cb31-1122" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**International Society for Animal Genetics (ISAG):** https://www.isag.us/ → Conferences, working groups on genomics</span>
<span id="cb31-1123"><a href="#cb31-1123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-1124"><a href="#cb31-1124" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb31-1125"><a href="#cb31-1125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-1126"><a href="#cb31-1126" aria-hidden="true" tabindex="-1"></a>**Next Chapter Preview:** In Chapter 13, we'll explore how genotype data is used in **genomic selection**—the methods for predicting breeding values (GEBVs), the accuracy of predictions, and the impact on genetic improvement programs.</span>
</code></pre></div><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></div>
</div></div></div></div></div>
</div> <!-- /content -->



<script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>